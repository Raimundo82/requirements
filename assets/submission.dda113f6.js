var We=Object.defineProperty;var ze=(st,A,Y)=>A in st?We(st,A,{enumerable:!0,configurable:!0,writable:!0,value:Y}):st[A]=Y;var Et=(st,A,Y)=>(ze(st,typeof A!="symbol"?A+"":A,Y),Y),ee=(st,A,Y)=>{if(!A.has(st))throw TypeError("Cannot "+Y)};var C=(st,A,Y)=>(ee(st,A,"read from private field"),Y?Y.call(st):A.get(st)),tt=(st,A,Y)=>{if(A.has(st))throw TypeError("Cannot add the same private member more than once");A instanceof WeakSet?A.add(st):A.set(st,Y)},lt=(st,A,Y,_)=>(ee(st,A,"write to private field"),_?_.call(st,Y):A.set(st,Y),Y),se=(st,A,Y,_)=>({set _(M){lt(st,A,M,Y)},get _(){return C(st,A,_)}}),it=(st,A,Y)=>(ee(st,A,"access private method"),Y);import{g as getElement,c as createNode,a as getState,_ as __vitePreload}from"./index.0c0a265e.js";import{g as getAugmentedNamespace,p as pdfBase64Data,a as pdfDownload,b as pdfOpen}from"./pdfGen.e108e65c.js";import require$$1 from"canvas";const submissionStyle=`.submission-btns{display:flex;flex-wrap:wrap;justify-content:center;gap:18px}.submission-btns>button{color:#fff;background-color:#182439;border-color:#182439;opacity:.8;width:150px}.submission-btns>button:hover{opacity:1;color:#fff;background-color:#182439;border-color:#182439}div#iframeContainer{padding:20px;display:flex;flex-wrap:wrap;justify-content:center}div#pdfCanvasContainer{background:#333;text-align:center;border:solid 3px;width:800px;height:450px;overflow:auto}
`,open="Abrir PDF",download="Descarregar PDF",constantsMap={open,download};function commonjsRequire(st){throw new Error('Could not dynamically require "'+st+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf_min={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(A,Y){module.exports=Y()})(globalThis,()=>(()=>{var __webpack_modules__=[,(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.VerbosityLevel=A.Util=A.UnknownErrorException=A.UnexpectedResponseException=A.UNSUPPORTED_FEATURES=A.TextRenderingMode=A.StreamType=A.RenderingIntentFlag=A.PermissionFlag=A.PasswordResponses=A.PasswordException=A.PageActionEventType=A.OPS=A.MissingPDFException=A.LINE_FACTOR=A.LINE_DESCENT_FACTOR=A.InvalidPDFException=A.ImageKind=A.IDENTITY_MATRIX=A.FormatError=A.FontType=A.FeatureTest=A.FONT_IDENTITY_MATRIX=A.DocumentActionEventType=A.CMapCompressionType=A.BaseException=A.AnnotationType=A.AnnotationStateModelType=A.AnnotationReviewState=A.AnnotationReplyType=A.AnnotationMode=A.AnnotationMarkedState=A.AnnotationFlag=A.AnnotationFieldFlag=A.AnnotationEditorType=A.AnnotationEditorPrefix=A.AnnotationEditorParamsType=A.AnnotationBorderStyleType=A.AnnotationActionEventType=A.AbortException=void 0,A.arrayByteLength=v,A.arraysToBytes=function(t){const e=t.length;if(e===1&&t[0]instanceof Uint8Array)return t[0];let r=0;for(let s=0;s<e;s++)r+=v(t[s]);let c=0;const h=new Uint8Array(r);for(let s=0;s<e;s++){let l=t[s];l instanceof Uint8Array||(l=typeof l=="string"?d(l):new Uint8Array(l));const p=l.byteLength;h.set(l,c),c+=p}return h},A.assert=function(t,e){t||K(e)},A.bytesToString=function(t){typeof t=="object"&&t!==null&&t.length!==void 0||K("Invalid argument for bytesToString");const e=t.length,r=8192;if(e<r)return String.fromCharCode.apply(null,t);const c=[];for(let h=0;h<e;h+=r){const s=Math.min(h+r,e),l=t.subarray(h,s);c.push(String.fromCharCode.apply(null,l))}return c.join("")},A.createPromiseCapability=function(){const t=Object.create(null);let e=!1;return Object.defineProperty(t,"settled",{get:()=>e}),t.promise=new Promise(function(r,c){t.resolve=function(h){e=!0,r(h)},t.reject=function(h){e=!0,c(h)}}),t},A.createValidAbsoluteUrl=function(t,e=null,r=null){if(!t)return null;try{if(r&&typeof t=="string"){if(r.addDefaultProtocol&&t.startsWith("www.")){const h=t.match(/\./g);h&&h.length>=2&&(t=`http://${t}`)}if(r.tryConvertEncoding)try{t=m(t)}catch{}}const c=e?new URL(t,e):new URL(t);if(function(s){if(!s)return!1;switch(s.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(c))return c}catch{}return null},A.escapeString=function(t){return t.replace(/([()\\\n\r])/g,e=>e===`
`?"\\n":e==="\r"?"\\r":`\\${e}`)},A.getModificationDate=function(t=new Date){return[t.getUTCFullYear().toString(),(t.getUTCMonth()+1).toString().padStart(2,"0"),t.getUTCDate().toString().padStart(2,"0"),t.getUTCHours().toString().padStart(2,"0"),t.getUTCMinutes().toString().padStart(2,"0"),t.getUTCSeconds().toString().padStart(2,"0")].join("")},A.getVerbosityLevel=function(){return M},A.info=function(t){M>=_.INFOS&&console.log(`Info: ${t}`)},A.isArrayBuffer=function(t){return typeof t=="object"&&t!==null&&t.byteLength!==void 0},A.isArrayEqual=function(t,e){if(t.length!==e.length)return!1;for(let r=0,c=t.length;r<c;r++)if(t[r]!==e[r])return!1;return!0},A.isAscii=function(t){return/^[\x00-\x7F]*$/.test(t)},A.objectFromMap=function(t){const e=Object.create(null);for(const[r,c]of t)e[r]=c;return e},A.objectSize=function(t){return Object.keys(t).length},A.setVerbosityLevel=function(t){Number.isInteger(t)&&(M=t)},A.shadow=N,A.string32=function(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)},A.stringToBytes=d,A.stringToPDFString=function(t){if(t[0]>="\xEF"){let r;if(t[0]==="\xFE"&&t[1]==="\xFF"?r="utf-16be":t[0]==="\xFF"&&t[1]==="\xFE"?r="utf-16le":t[0]==="\xEF"&&t[1]==="\xBB"&&t[2]==="\xBF"&&(r="utf-8"),r)try{const c=new TextDecoder(r,{fatal:!0}),h=d(t);return c.decode(h)}catch(c){q(`stringToPDFString: "${c}".`)}}const e=[];for(let r=0,c=t.length;r<c;r++){const h=W[t.charCodeAt(r)];e.push(h?String.fromCharCode(h):t.charAt(r))}return e.join("")},A.stringToUTF16BEString=function(t){const e=["\xFE\xFF"];for(let r=0,c=t.length;r<c;r++){const h=t.charCodeAt(r);e.push(String.fromCharCode(h>>8&255),String.fromCharCode(255&h))}return e.join("")},A.stringToUTF8String=m,A.unreachable=K,A.utf8StringToString=function(t){return unescape(encodeURIComponent(t))},A.warn=q,Y(2),A.IDENTITY_MATRIX=[1,0,0,1,0,0],A.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],A.LINE_FACTOR=1.35,A.LINE_DESCENT_FACTOR=.35,A.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},A.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},A.AnnotationEditorPrefix="pdfjs_internal_editor_",A.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,INK:15},A.AnnotationEditorParamsType={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13},A.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},A.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},A.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},A.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},A.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},A.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},A.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},A.AnnotationReplyType={GROUP:"Group",REPLY:"R"},A.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},A.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},A.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},A.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},A.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},A.PageActionEventType={O:"PageOpen",C:"PageClose"},A.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},A.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const _={ERRORS:0,WARNINGS:1,INFOS:5};A.VerbosityLevel=_,A.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},A.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},A.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"},A.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let M=_.WARNINGS;function q(i){M>=_.WARNINGS&&console.log(`Warning: ${i}`)}function K(i){throw new Error(i)}function N(i,t,e){return Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!1}),e}const u=function(){function t(e,r){this.constructor===t&&K("Cannot initialize BaseException."),this.message=e,this.name=r}return t.prototype=new Error,t.constructor=t,t}();A.BaseException=u,A.PasswordException=class extends u{constructor(t,e){super(t,"PasswordException"),this.code=e}},A.UnknownErrorException=class extends u{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}},A.InvalidPDFException=class extends u{constructor(t){super(t,"InvalidPDFException")}},A.MissingPDFException=class extends u{constructor(t){super(t,"MissingPDFException")}},A.UnexpectedResponseException=class extends u{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}},A.FormatError=class extends u{constructor(t){super(t,"FormatError")}},A.AbortException=class extends u{constructor(t){super(t,"AbortException")}};function d(i){typeof i!="string"&&K("Invalid argument for stringToBytes");const t=i.length,e=new Uint8Array(t);for(let r=0;r<t;++r)e[r]=255&i.charCodeAt(r);return e}function v(i){if(i.length!==void 0)return i.length;if(i.byteLength!==void 0)return i.byteLength;K("Invalid argument for arrayByteLength")}A.FeatureTest=class{static get isLittleEndian(){return N(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,new Uint32Array(e.buffer,0,1)[0]===1}())}static get isEvalSupported(){return N(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return N(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}};const y=[...Array(256).keys()].map(i=>i.toString(16).padStart(2,"0"));class E{static makeHexColor(t,e,r){return`#${y[t]}${y[e]}${y[r]}`}static scaleMinMax(t,e){let r;t[0]?(t[0]<0&&(r=e[0],e[0]=e[1],e[1]=r),e[0]*=t[0],e[1]*=t[0],t[3]<0&&(r=e[2],e[2]=e[3],e[3]=r),e[2]*=t[3],e[3]*=t[3]):(r=e[0],e[0]=e[2],e[2]=r,r=e[1],e[1]=e[3],e[3]=r,t[1]<0&&(r=e[2],e[2]=e[3],e[3]=r),e[2]*=t[1],e[3]*=t[1],t[2]<0&&(r=e[0],e[0]=e[1],e[1]=r),e[0]*=t[2],e[1]*=t[2]),e[0]+=t[4],e[1]+=t[4],e[2]+=t[5],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]}static applyInverseTransform(t,e){const r=e[0]*e[3]-e[1]*e[2];return[(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/r,(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/r]}static getAxialAlignedBoundingBox(t,e){const r=E.applyTransform(t,e),c=E.applyTransform(t.slice(2,4),e),h=E.applyTransform([t[0],t[3]],e),s=E.applyTransform([t[2],t[1]],e);return[Math.min(r[0],c[0],h[0],s[0]),Math.min(r[1],c[1],h[1],s[1]),Math.max(r[0],c[0],h[0],s[0]),Math.max(r[1],c[1],h[1],s[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static apply3dTransform(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2],t[3]*e[0]+t[4]*e[1]+t[5]*e[2],t[6]*e[0]+t[7]*e[1]+t[8]*e[2]]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],r=t[0]*e[0]+t[1]*e[2],c=t[0]*e[1]+t[1]*e[3],h=t[2]*e[0]+t[3]*e[2],s=t[2]*e[1]+t[3]*e[3],l=(r+s)/2,p=Math.sqrt((r+s)**2-4*(r*s-h*c))/2,x=l+p||1,w=l-p||1;return[Math.sqrt(x),Math.sqrt(w)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const r=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),c=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(r>c)return null;const h=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),s=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return h>s?null:[r,h,c,s]}static bezierBoundingBox(t,e,r,c,h,s,l,p){const x=[],w=[[],[]];let F,P,U,J,V,I,n,a;for(let D=0;D<2;++D)if(D===0?(P=6*t-12*r+6*h,F=-3*t+9*r-9*h+3*l,U=3*r-3*t):(P=6*e-12*c+6*s,F=-3*e+9*c-9*s+3*p,U=3*c-3*e),Math.abs(F)<1e-12){if(Math.abs(P)<1e-12)continue;J=-U/P,0<J&&J<1&&x.push(J)}else n=P*P-4*U*F,a=Math.sqrt(n),n<0||(V=(-P+a)/(2*F),0<V&&V<1&&x.push(V),I=(-P-a)/(2*F),0<I&&I<1&&x.push(I));let g,S=x.length;const T=S;for(;S--;)J=x[S],g=1-J,w[0][S]=g*g*g*t+3*g*g*J*r+3*g*J*J*h+J*J*J*l,w[1][S]=g*g*g*e+3*g*g*J*c+3*g*J*J*s+J*J*J*p;return w[0][T]=t,w[1][T]=e,w[0][T+1]=l,w[1][T+1]=p,w[0].length=w[1].length=T+2,[Math.min(...w[0]),Math.min(...w[1]),Math.max(...w[0]),Math.max(...w[1])]}}A.Util=E;const W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function m(i){return decodeURIComponent(escape(i))}},(st,A,Y)=>{Y(3)},(st,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.isNodeJS=void 0;const Y=!(typeof process!="object"||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&process.type!=="browser");A.isNodeJS=Y},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.StatTimer=A.RenderingCancelledException=A.PixelsPerInch=A.PageViewport=A.PDFDateString=A.DOMStandardFontDataFactory=A.DOMSVGFactory=A.DOMCanvasFactory=A.DOMCMapReaderFactory=void 0,A.binarySearchFirstItem=function(c,h,s=0){let l=s,p=c.length-1;if(p<0||!h(c[p]))return c.length;if(h(c[l]))return l;for(;l<p;){const x=l+p>>1,w=c[x];h(w)?p=x:l=x+1}return l},A.deprecated=function(c){console.log("Deprecated API usage: "+c)},A.getColorValues=function(c){const h=document.createElement("span");h.style.visibility="hidden",document.body.append(h);for(const s of c.keys()){h.style.color=s;const l=window.getComputedStyle(h).color;c.set(s,t(l))}h.remove()},A.getFilenameFromUrl=function(c){const h=c.indexOf("#"),s=c.indexOf("?"),l=Math.min(h>0?h:c.length,s>0?s:c.length);return c.substring(c.lastIndexOf("/",l)+1,l)},A.getPdfFilenameFromUrl=function(c,h="document.pdf"){if(typeof c!="string")return h;if(W(c))return(0,M.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),h;const s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,l=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(c);let p=s.exec(l[1])||s.exec(l[2])||s.exec(l[3]);if(p&&(p=p[0],p.includes("%")))try{p=s.exec(decodeURIComponent(p))[0]}catch{}return p||h},A.getRGB=t,A.getXfaPageViewport=function(c,{scale:h=1,rotation:s=0}){const{width:l,height:p}=c.attributes.style,x=[0,0,parseInt(l),parseInt(p)];return new y({viewBox:x,scale:h,rotation:s})},A.isDataScheme=W,A.isPdfFile=function(c){return typeof c=="string"&&/\.pdf$/i.test(c)},A.isValidFetchUrl=m,A.loadScript=function(c,h=!1){return new Promise((s,l)=>{const p=document.createElement("script");p.src=c,p.onload=function(x){h&&p.remove(),s(x)},p.onerror=function(){l(new Error(`Cannot load script at: ${p.src}`))},(document.head||document.documentElement).append(p)})};var _=Y(5),M=Y(1);const e=class{};let q=e;Et(q,"CSS",96),Et(q,"PDF",72),Et(q,"PDF_TO_CSS_UNITS",e.CSS/e.PDF),A.PixelsPerInch=q;class K extends _.BaseCanvasFactory{constructor({ownerDocument:c=globalThis.document}={}){super(),this._document=c}_createCanvas(c,h){const s=this._document.createElement("canvas");return s.width=c,s.height=h,s}}A.DOMCanvasFactory=K;async function N(r,c=!1){if(m(r,document.baseURI)){const h=await fetch(r);if(!h.ok)throw new Error(h.statusText);return c?new Uint8Array(await h.arrayBuffer()):(0,M.stringToBytes)(await h.text())}return new Promise((h,s)=>{const l=new XMLHttpRequest;l.open("GET",r,!0),c&&(l.responseType="arraybuffer"),l.onreadystatechange=()=>{if(l.readyState===XMLHttpRequest.DONE){if(l.status===200||l.status===0){let p;if(c&&l.response?p=new Uint8Array(l.response):!c&&l.responseText&&(p=(0,M.stringToBytes)(l.responseText)),p){h(p);return}}s(new Error(l.statusText))}},l.send(null)})}class u extends _.BaseCMapReaderFactory{_fetchData(c,h){return N(c,this.isCompressed).then(s=>({cMapData:s,compressionType:h}))}}A.DOMCMapReaderFactory=u;class d extends _.BaseStandardFontDataFactory{_fetchData(c){return N(c,!0)}}A.DOMStandardFontDataFactory=d;class v extends _.BaseSVGFactory{_createSVG(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}}A.DOMSVGFactory=v;class y{constructor({viewBox:c,scale:h,rotation:s,offsetX:l=0,offsetY:p=0,dontFlip:x=!1}){this.viewBox=c,this.scale=h,this.rotation=s,this.offsetX=l,this.offsetY=p;const w=(c[2]+c[0])/2,F=(c[3]+c[1])/2;let P,U,J,V,I,n,a,g;switch((s%=360)<0&&(s+=360),s){case 180:P=-1,U=0,J=0,V=1;break;case 90:P=0,U=1,J=1,V=0;break;case 270:P=0,U=-1,J=-1,V=0;break;case 0:P=1,U=0,J=0,V=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}x&&(J=-J,V=-V),P===0?(I=Math.abs(F-c[1])*h+l,n=Math.abs(w-c[0])*h+p,a=Math.abs(c[3]-c[1])*h,g=Math.abs(c[2]-c[0])*h):(I=Math.abs(w-c[0])*h+l,n=Math.abs(F-c[1])*h+p,a=Math.abs(c[2]-c[0])*h,g=Math.abs(c[3]-c[1])*h),this.transform=[P*h,U*h,J*h,V*h,I-P*h*w-J*h*F,n-U*h*w-V*h*F],this.width=a,this.height=g}clone({scale:c=this.scale,rotation:h=this.rotation,offsetX:s=this.offsetX,offsetY:l=this.offsetY,dontFlip:p=!1}={}){return new y({viewBox:this.viewBox.slice(),scale:c,rotation:h,offsetX:s,offsetY:l,dontFlip:p})}convertToViewportPoint(c,h){return M.Util.applyTransform([c,h],this.transform)}convertToViewportRectangle(c){const h=M.Util.applyTransform([c[0],c[1]],this.transform),s=M.Util.applyTransform([c[2],c[3]],this.transform);return[h[0],h[1],s[0],s[1]]}convertToPdfPoint(c,h){return M.Util.applyInverseTransform([c,h],this.transform)}}A.PageViewport=y;class E extends M.BaseException{constructor(c,h){super(c,"RenderingCancelledException"),this.type=h}}A.RenderingCancelledException=E;function W(r){const c=r.length;let h=0;for(;h<c&&r[h].trim()==="";)h++;return r.substring(h,h+5).toLowerCase()==="data:"}A.StatTimer=class{constructor(){this.started=Object.create(null),this.times=[]}time(c){c in this.started&&(0,M.warn)(`Timer is already running for ${c}`),this.started[c]=Date.now()}timeEnd(c){c in this.started||(0,M.warn)(`Timer has not been started for ${c}`),this.times.push({name:c,start:this.started[c],end:Date.now()}),delete this.started[c]}toString(){const c=[];let h=0;for(const s of this.times){const l=s.name;l.length>h&&(h=l.length)}for(const s of this.times){const l=s.end-s.start;c.push(`${s.name.padEnd(h)} ${l}ms
`)}return c.join("")}};function m(r,c){try{const{protocol:h}=c?new URL(r,c):new URL(r);return h==="http:"||h==="https:"}catch{return!1}}let i;A.PDFDateString=class{static toDateObject(c){if(!c||typeof c!="string")return null;i||(i=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const h=i.exec(c);if(!h)return null;const s=parseInt(h[1],10);let l=parseInt(h[2],10);l=l>=1&&l<=12?l-1:0;let p=parseInt(h[3],10);p=p>=1&&p<=31?p:1;let x=parseInt(h[4],10);x=x>=0&&x<=23?x:0;let w=parseInt(h[5],10);w=w>=0&&w<=59?w:0;let F=parseInt(h[6],10);F=F>=0&&F<=59?F:0;const P=h[7]||"Z";let U=parseInt(h[8],10);U=U>=0&&U<=23?U:0;let J=parseInt(h[9],10)||0;return J=J>=0&&J<=59?J:0,P==="-"?(x+=U,w+=J):P==="+"&&(x-=U,w-=J),new Date(Date.UTC(s,l,p,x,w,F))}};function t(r){if(r.startsWith("#")){const c=parseInt(r.slice(1),16);return[(16711680&c)>>16,(65280&c)>>8,255&c]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(c=>parseInt(c)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(c=>parseInt(c)).slice(0,3):((0,M.warn)(`Not a valid color format: "${r}"`),[0,0,0])}},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.BaseStandardFontDataFactory=A.BaseSVGFactory=A.BaseCanvasFactory=A.BaseCMapReaderFactory=void 0;var _=Y(1);class M{constructor(){this.constructor===M&&(0,_.unreachable)("Cannot initialize BaseCanvasFactory.")}create(d,v){if(d<=0||v<=0)throw new Error("Invalid canvas size");const y=this._createCanvas(d,v);return{canvas:y,context:y.getContext("2d")}}reset(d,v,y){if(!d.canvas)throw new Error("Canvas is not specified");if(v<=0||y<=0)throw new Error("Invalid canvas size");d.canvas.width=v,d.canvas.height=y}destroy(d){if(!d.canvas)throw new Error("Canvas is not specified");d.canvas.width=0,d.canvas.height=0,d.canvas=null,d.context=null}_createCanvas(d,v){(0,_.unreachable)("Abstract method `_createCanvas` called.")}}A.BaseCanvasFactory=M;class q{constructor({baseUrl:d=null,isCompressed:v=!1}){this.constructor===q&&(0,_.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=d,this.isCompressed=v}async fetch({name:d}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!d)throw new Error("CMap name must be specified.");const v=this.baseUrl+d+(this.isCompressed?".bcmap":""),y=this.isCompressed?_.CMapCompressionType.BINARY:_.CMapCompressionType.NONE;return this._fetchData(v,y).catch(E=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${v}`)})}_fetchData(d,v){(0,_.unreachable)("Abstract method `_fetchData` called.")}}A.BaseCMapReaderFactory=q;class K{constructor({baseUrl:d=null}){this.constructor===K&&(0,_.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=d}async fetch({filename:d}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!d)throw new Error("Font filename must be specified.");const v=`${this.baseUrl}${d}`;return this._fetchData(v).catch(y=>{throw new Error(`Unable to load font data at: ${v}`)})}_fetchData(d){(0,_.unreachable)("Abstract method `_fetchData` called.")}}A.BaseStandardFontDataFactory=K;class N{constructor(){this.constructor===N&&(0,_.unreachable)("Cannot initialize BaseSVGFactory.")}create(d,v,y=!1){if(d<=0||v<=0)throw new Error("Invalid SVG dimensions");const E=this._createSVG("svg:svg");return E.setAttribute("version","1.1"),y||(E.setAttribute("width",`${d}px`),E.setAttribute("height",`${v}px`)),E.setAttribute("preserveAspectRatio","none"),E.setAttribute("viewBox",`0 0 ${d} ${v}`),E}createElement(d){if(typeof d!="string")throw new Error("Invalid SVG element type");return this._createSVG(d)}_createSVG(d){(0,_.unreachable)("Abstract method `_createSVG` called.")}}A.BaseSVGFactory=N},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var st,Y,_,M,q,K,N,u,d,ie,y,E;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(7),_display_utils=__w_pdfjs_require__(4),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory,createPDFNetworkStream;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:m,NodeCMapReaderFactory:i,NodeStandardFontDataFactory:t}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=m,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=i,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=t}function setPDFNetworkStreamFactory(m){createPDFNetworkStream=m}function getDocument(m){const i=new PDFDocumentLoadingTask;let t;if(typeof m=="string"||m instanceof URL)t={url:m};else if((0,_util.isArrayBuffer)(m))t={data:m};else if(m instanceof PDFDataRangeTransport)t={range:m};else{if(typeof m!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!m.url&&!m.data&&!m.range)throw new Error("Invalid parameter object: need either .data, .range or .url");t=m}const e=Object.create(null);let r=null,c=null;for(const s in t){const l=t[s];switch(s){case"url":if(typeof window<"u")try{e[s]=new URL(l,window.location).href;continue}catch(p){(0,_util.warn)(`Cannot create valid URL: "${p}".`)}else if(typeof l=="string"||l instanceof URL){e[s]=l.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":r=l;continue;case"worker":c=l;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&l instanceof Buffer)e[s]=new Uint8Array(l);else{if(l instanceof Uint8Array)break;if(typeof l=="string")e[s]=(0,_util.stringToBytes)(l);else if(typeof l!="object"||l===null||isNaN(l.length)){if(!(0,_util.isArrayBuffer)(l))throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.");e[s]=new Uint8Array(l)}else e[s]=new Uint8Array(l)}continue}e[s]=l}if(e.CMapReaderFactory=e.CMapReaderFactory||DefaultCMapReaderFactory,e.StandardFontDataFactory=e.StandardFontDataFactory||DefaultStandardFontDataFactory,e.ignoreErrors=e.stopAtErrors!==!0,e.fontExtraProperties=e.fontExtraProperties===!0,e.pdfBug=e.pdfBug===!0,e.enableXfa=e.enableXfa===!0,(!Number.isInteger(e.rangeChunkSize)||e.rangeChunkSize<1)&&(e.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof e.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(e.docBaseUrl))&&(e.docBaseUrl=null),(!Number.isInteger(e.maxImageSize)||e.maxImageSize<-1)&&(e.maxImageSize=-1),typeof e.cMapUrl!="string"&&(e.cMapUrl=null),typeof e.standardFontDataUrl!="string"&&(e.standardFontDataUrl=null),typeof e.useWorkerFetch!="boolean"&&(e.useWorkerFetch=e.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&e.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof e.isEvalSupported!="boolean"&&(e.isEvalSupported=!0),typeof e.disableFontFace!="boolean"&&(e.disableFontFace=_is_node.isNodeJS),typeof e.useSystemFonts!="boolean"&&(e.useSystemFonts=!_is_node.isNodeJS&&!e.disableFontFace),typeof e.ownerDocument=="object"&&e.ownerDocument!==null||(e.ownerDocument=globalThis.document),typeof e.disableRange!="boolean"&&(e.disableRange=!1),typeof e.disableStream!="boolean"&&(e.disableStream=!1),typeof e.disableAutoFetch!="boolean"&&(e.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(e.verbosity),!c){const s={verbosity:e.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};c=s.port?PDFWorker.fromPort(s):new PDFWorker(s),i._worker=c}const h=i.docId;return c.promise.then(function(){if(i.destroyed)throw new Error("Loading aborted");const s=_fetchDocument(c,e,r,h),l=new Promise(function(p){let x;r?x=new _transport_stream.PDFDataTransportStream({length:e.length,initialData:e.initialData,progressiveDone:e.progressiveDone,contentDispositionFilename:e.contentDispositionFilename,disableRange:e.disableRange,disableStream:e.disableStream},r):e.data||(x=createPDFNetworkStream({url:e.url,length:e.length,httpHeaders:e.httpHeaders,withCredentials:e.withCredentials,rangeChunkSize:e.rangeChunkSize,disableRange:e.disableRange,disableStream:e.disableStream})),p(x)});return Promise.all([s,l]).then(function([p,x]){if(i.destroyed)throw new Error("Loading aborted");const w=new _message_handler.MessageHandler(h,p,c.port),F=new WorkerTransport(w,i,x,e);i._transport=F,w.send("Ready",null)})}).catch(i._capability.reject),i}async function _fetchDocument(m,i,t,e){if(m.destroyed)throw new Error("Worker was destroyed");t&&(i.length=t.length,i.initialData=t.initialData,i.progressiveDone=t.progressiveDone,i.contentDispositionFilename=t.contentDispositionFilename);const r=await m.messageHandler.sendWithPromise("GetDocRequest",{docId:e,apiVersion:"2.15.349",source:{data:i.data,url:i.url,password:i.password,disableAutoFetch:i.disableAutoFetch,rangeChunkSize:i.rangeChunkSize,length:i.length},maxImageSize:i.maxImageSize,disableFontFace:i.disableFontFace,docBaseUrl:i.docBaseUrl,ignoreErrors:i.ignoreErrors,isEvalSupported:i.isEvalSupported,fontExtraProperties:i.fontExtraProperties,enableXfa:i.enableXfa,useSystemFonts:i.useSystemFonts,cMapUrl:i.useWorkerFetch?i.cMapUrl:null,standardFontDataUrl:i.useWorkerFetch?i.standardFontDataUrl:null});if(i.data&&(i.data=null),m.destroyed)throw new Error("Worker was destroyed");return r}const A=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+se(A,st)._++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var i;this.destroyed=!0,await((i=this._transport)==null?void 0:i.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=A;st=new WeakMap,tt(PDFDocumentLoadingTask,st,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(i,t,e=!1,r=null){this.length=i,this.initialData=t,this.progressiveDone=e,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(i){this._rangeListeners.push(i)}addProgressListener(i){this._progressListeners.push(i)}addProgressiveReadListener(i){this._progressiveReadListeners.push(i)}addProgressiveDoneListener(i){this._progressiveDoneListeners.push(i)}onDataRange(i,t){for(const e of this._rangeListeners)e(i,t)}onDataProgress(i,t){this._readyCapability.promise.then(()=>{for(const e of this._progressListeners)e(i,t)})}onDataProgressiveRead(i){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(i)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const i of this._progressiveDoneListeners)i()})}transportReady(){this._readyCapability.resolve()}requestDataRange(i,t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(i,t){this._pdfInfo=i,this._transport=t,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(i){return this._transport.getPage(i)}getPageIndex(i){return this._transport.getPageIndex(i)}getDestinations(){return this._transport.getDestinations()}getDestination(i){return this._transport.getDestination(i)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(i=!1){return this._transport.startCleanup(i||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(i,t,e,r,c=!1){this._pageIndex=i,this._pageInfo=t,this._ownerDocument=r,this._transport=e,this._stats=c?new _display_utils.StatTimer:null,this._pdfBug=c,this.commonObjs=e.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:i,rotation:t=this.rotate,offsetX:e=0,offsetY:r=0,dontFlip:c=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:i,rotation:t,offsetX:e,offsetY:r,dontFlip:c})}getAnnotations({intent:i="display"}={}){const t=this._transport.getRenderingIntent(i);let e=this._annotationPromises.get(t.cacheKey);return e||(e=this._transport.getAnnotations(this._pageIndex,t.renderingIntent),this._annotationPromises.set(t.cacheKey,e),e=e.then(r=>{for(const c of r)c.titleObj!==void 0&&Object.defineProperty(c,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),c.titleObj.str}}),c.contentsObj!==void 0&&Object.defineProperty(c,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),c.contentsObj.str}});return r})),e}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var i;return((i=this._transport._htmlForXfa)==null?void 0:i.children[this._pageIndex])||null}render({canvasContext:i,viewport:t,intent:e="display",annotationMode:r=_util.AnnotationMode.ENABLE,transform:c=null,imageLayer:h=null,canvasFactory:s=null,background:l=null,optionalContentConfigPromise:p=null,annotationCanvasMap:x=null,pageColors:w=null,printAnnotationStorage:F=null}){var g,S;((g=arguments[0])==null?void 0:g.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&r===_util.AnnotationMode.ENABLE&&(r=_util.AnnotationMode.ENABLE_FORMS)),((S=arguments[0])==null?void 0:S.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&r===_util.AnnotationMode.ENABLE&&(r=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const P=this._transport.getRenderingIntent(e,r,F);this.pendingCleanup=!1,p||(p=this._transport.getOptionalContentConfig());let U=this._intentStates.get(P.cacheKey);U||(U=Object.create(null),this._intentStates.set(P.cacheKey,U)),U.streamReaderCancelTimeout&&(clearTimeout(U.streamReaderCancelTimeout),U.streamReaderCancelTimeout=null);const J=s||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),V=!!(P.renderingIntent&_util.RenderingIntentFlag.PRINT);U.displayReadyCapability||(U.displayReadyCapability=(0,_util.createPromiseCapability)(),U.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(P));const I=T=>{U.renderTasks.delete(n),(this.cleanupAfterRender||V)&&(this.pendingCleanup=!0),this._tryCleanup(),T?(n.capability.reject(T),this._abortOperatorList({intentState:U,reason:T instanceof Error?T:new Error(T)})):n.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},n=new InternalRenderTask({callback:I,params:{canvasContext:i,viewport:t,transform:c,imageLayer:h,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:x,operatorList:U.operatorList,pageIndex:this._pageIndex,canvasFactory:J,useRequestAnimationFrame:!V,pdfBug:this._pdfBug,pageColors:w});(U.renderTasks||(U.renderTasks=new Set)).add(n);const a=n.task;return Promise.all([U.displayReadyCapability.promise,p]).then(([T,D])=>{this.pendingCleanup?I():(this._stats&&this._stats.time("Rendering"),n.initializeGraphics({transparency:T,optionalContentConfig:D}),n.operatorListChanged())}).catch(I),a}getOperatorList({intent:i="display",annotationMode:t=_util.AnnotationMode.ENABLE,printAnnotationStorage:e=null}={}){const r=this._transport.getRenderingIntent(i,t,e,!0);let c,h=this._intentStates.get(r.cacheKey);return h||(h=Object.create(null),this._intentStates.set(r.cacheKey,h)),h.opListReadCapability||(c=Object.create(null),c.operatorListChanged=function(){h.operatorList.lastChunk&&(h.opListReadCapability.resolve(h.operatorList),h.renderTasks.delete(c))},h.opListReadCapability=(0,_util.createPromiseCapability)(),(h.renderTasks||(h.renderTasks=new Set)).add(c),h.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(r)),h.opListReadCapability.promise}streamTextContent({disableCombineTextItems:i=!1,includeMarkedContent:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:i!==!0,includeMarkedContent:t===!0},{highWaterMark:100,size:e=>e.items.length})}getTextContent(i={}){if(this._transport._htmlForXfa)return this.getXfa().then(e=>_xfa_text.XfaText.textContent(e));const t=this.streamTextContent(i);return new Promise(function(e,r){const c=t.getReader(),h={items:[],styles:Object.create(null)};(function s(){c.read().then(function({value:l,done:p}){p?e(h):(Object.assign(h.styles,l.styles),h.items.push(...l.items),s())},r)})()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const i=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const e of t.renderTasks)i.push(e.completed),e.cancel();this.objs.clear();for(const t of this._bitmaps)t.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(i)}cleanup(i=!1){return this.pendingCleanup=!0,this._tryCleanup(i)}_tryCleanup(i=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,i&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const t of this._bitmaps)t.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(i,t){const e=this._intentStates.get(t);e&&(this._stats&&this._stats.timeEnd("Page Request"),e.displayReadyCapability&&e.displayReadyCapability.resolve(i))}_renderPageChunk(i,t){for(let e=0,r=i.length;e<r;e++)t.operatorList.fnArray.push(i.fnArray[e]),t.operatorList.argsArray.push(i.argsArray[e]);t.operatorList.lastChunk=i.lastChunk,t.operatorList.separateAnnots=i.separateAnnots;for(const e of t.renderTasks)e.operatorListChanged();i.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:i,cacheKey:t,annotationStorageMap:e}){const r=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:i,cacheKey:t,annotationStorage:e}).getReader(),c=this._intentStates.get(t);c.streamReader=r;const h=()=>{r.read().then(({value:s,done:l})=>{l?c.streamReader=null:this._transport.destroyed||(this._renderPageChunk(s,c),h())},s=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const l of c.renderTasks)l.operatorListChanged();this._tryCleanup()}if(c.displayReadyCapability)c.displayReadyCapability.reject(s);else{if(!c.opListReadCapability)throw s;c.opListReadCapability.reject(s)}}})};h()}_abortOperatorList({intentState:i,reason:t,force:e=!1}){if(i.streamReader){if(!e){if(i.renderTasks.size>0)return;if(t instanceof _display_utils.RenderingCancelledException){i.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:i,reason:t,force:!0}),i.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(i.streamReader.cancel(new _util.AbortException(t.message)).catch(()=>{}),i.streamReader=null,!this._transport.destroyed){for(const[r,c]of this._intentStates)if(c===i){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(i,t){const e={data:structuredClone(i,t)};this._deferred.then(()=>{for(const r of this._listeners)r.call(this,e)})}addEventListener(i,t){this._listeners.push(t)}removeEventListener(i,t){const e=this._listeners.indexOf(t);this._listeners.splice(e,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const m=(Y=document==null?void 0:document.currentScript)==null?void 0:Y.src;m&&(PDFWorkerUtil.fallbackWorkerSrc=m.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(m,i){let t;try{if(t=new URL(m),!t.origin||t.origin==="null")return!1}catch{return!1}const e=new URL(i,t);return t.origin===e.origin},PDFWorkerUtil.createCDNWrapper=function(m){const i=`importScripts("${m}");`;return URL.createObjectURL(new Blob([i]))};const _PDFWorker=class{constructor({name:m=null,port:i=null,verbosity:t=(0,_util.getVerbosityLevel)()}={}){if(i&&C(_PDFWorker,_).has(i))throw new Error("Cannot use more than one PDFWorker per port.");this.name=m,this.destroyed=!1,this.verbosity=t,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,i?(C(_PDFWorker,_).set(i,this),this._initializeFromPort(i)):this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(m){this._port=m,this._messageHandler=new _message_handler.MessageHandler("main","worker",m),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(typeof Worker<"u"&&!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let m=_PDFWorker.workerSrc;try{PDFWorkerUtil.isSameOrigin(window.location.href,m)||(m=PDFWorkerUtil.createCDNWrapper(new URL(m,window.location).href));const i=new Worker(m),t=new _message_handler.MessageHandler("main","worker",i),e=()=>{i.removeEventListener("error",r),t.destroy(),i.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=()=>{this._webWorker||e()};i.addEventListener("error",r),t.on("test",h=>{i.removeEventListener("error",r),this.destroyed?e():h?(this._messageHandler=t,this._port=i,this._webWorker=i,this._readyCapability.resolve(),t.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),t.destroy(),i.terminate())}),t.on("ready",h=>{if(i.removeEventListener("error",r),this.destroyed)e();else try{c()}catch{this._setupFakeWorker()}});const c=()=>{const h=new Uint8Array;t.send("test",h,[h.buffer])};c();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(m=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const i=new LoopbackPort;this._port=i;const t="fake"+PDFWorkerUtil.fakeWorkerId++,e=new _message_handler.MessageHandler(t+"_worker",t,i);m.setup(e,i);const r=new _message_handler.MessageHandler(t,t+"_worker",i);this._messageHandler=r,this._readyCapability.resolve(),r.send("configure",{verbosity:this.verbosity})}).catch(m=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${m.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),C(_PDFWorker,_).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(m){if(!(m!=null&&m.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return C(this,_).has(m.port)?C(this,_).get(m.port):new _PDFWorker(m)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var m;try{return((m=globalThis.pdfjsWorker)==null?void 0:m.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;_=new WeakMap,tt(PDFWorker,_,new WeakMap),exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(i,t,e,r){tt(this,M,null);tt(this,q,new Map);tt(this,K,new Map);tt(this,N,null);this.messageHandler=i,this.loadingTask=t,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:t.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this._params=r,r.useWorkerFetch||(this.CMapReaderFactory=new r.CMapReaderFactory({baseUrl:r.cMapUrl,isCompressed:r.cMapPacked}),this.StandardFontDataFactory=new r.StandardFontDataFactory({baseUrl:r.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=e,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return C(this,M)}getRenderingIntent(i,t=_util.AnnotationMode.ENABLE,e=null,r=!1){let c=_util.RenderingIntentFlag.DISPLAY,h=null;switch(i){case"any":c=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":c=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${i}`)}switch(t){case _util.AnnotationMode.DISABLE:c+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:c+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:c+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,h=(c&_util.RenderingIntentFlag.PRINT&&e instanceof _annotation_storage.PrintAnnotationStorage?e:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${t}`)}return r&&(c+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:c,cacheKey:`${c}_${_annotation_storage.AnnotationStorage.getHash(h)}`,annotationStorageMap:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const i=[];for(const e of C(this,q).values())i.push(e._destroy());C(this,q).clear(),C(this,K).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return i.push(t),Promise.all(i).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),lt(this,N,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:i,loadingTask:t}=this;i.on("GetReader",(e,r)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=c=>{this._lastProgress={loaded:c.loaded,total:c.total}},r.onPull=()=>{this._fullReader.read().then(function({value:c,done:h}){h?r.close():((0,_util.assert)((0,_util.isArrayBuffer)(c),"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(c),1,[c]))}).catch(c=>{r.error(c)})},r.onCancel=c=>{this._fullReader.cancel(c),r.ready.catch(h=>{if(!this.destroyed)throw h})}}),i.on("ReaderHeadersReady",e=>{const r=(0,_util.createPromiseCapability)(),c=this._fullReader;return c.headersReady.then(()=>{var h;(!c.isStreamingSupported||!c.isRangeSupported)&&(this._lastProgress&&((h=t.onProgress)==null||h.call(t,this._lastProgress)),c.onProgress=s=>{var l;(l=t.onProgress)==null||l.call(t,{loaded:s.loaded,total:s.total})}),r.resolve({isStreamingSupported:c.isStreamingSupported,isRangeSupported:c.isRangeSupported,contentLength:c.contentLength})},r.reject),r.promise}),i.on("GetRangeReader",(e,r)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const c=this._networkStream.getRangeReader(e.begin,e.end);c?(r.onPull=()=>{c.read().then(function({value:h,done:s}){s?r.close():((0,_util.assert)((0,_util.isArrayBuffer)(h),"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(h),1,[h]))}).catch(h=>{r.error(h)})},r.onCancel=h=>{c.cancel(h),r.ready.catch(s=>{if(!this.destroyed)throw s})}):r.close()}),i.on("GetDoc",({pdfInfo:e})=>{this._numPages=e.numPages,this._htmlForXfa=e.htmlForXfa,delete e.htmlForXfa,t._capability.resolve(new PDFDocumentProxy(e,this))}),i.on("DocException",function(e){let r;switch(e.name){case"PasswordException":r=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":r=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":r=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":r=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":r=new _util.UnknownErrorException(e.message,e.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}t._capability.reject(r)}),i.on("PasswordRequest",e=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),t.onPassword){const r=c=>{c instanceof Error?this._passwordCapability.reject(c):this._passwordCapability.resolve({password:c})};try{t.onPassword(r,e.code)}catch(c){this._passwordCapability.reject(c)}}else this._passwordCapability.reject(new _util.PasswordException(e.message,e.code));return this._passwordCapability.promise}),i.on("DataLoaded",e=>{var r;(r=t.onProgress)==null||r.call(t,{loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),i.on("StartRenderPage",e=>{this.destroyed||C(this,q).get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),i.on("commonobj",([e,r,c])=>{var h;if(!this.destroyed&&!this.commonObjs.has(e))switch(r){case"Font":const s=this._params;if("error"in c){const x=c.error;(0,_util.warn)(`Error during font loading: ${x}`),this.commonObjs.resolve(e,x);break}let l=null;s.pdfBug&&((h=globalThis.FontInspector)==null?void 0:h.enabled)&&(l={registerFont(x,w){globalThis.FontInspector.fontAdded(x,w)}});const p=new _font_loader.FontFaceObject(c,{isEvalSupported:s.isEvalSupported,disableFontFace:s.disableFontFace,ignoreErrors:s.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:l});this.fontLoader.bind(p).catch(x=>i.sendWithPromise("FontFallback",{id:e})).finally(()=>{!s.fontExtraProperties&&p.data&&(p.data=null),this.commonObjs.resolve(e,p)});break;case"FontPath":case"Image":this.commonObjs.resolve(e,c);break;default:throw new Error(`Got unknown common object type ${r}`)}}),i.on("obj",([e,r,c,h])=>{var l;if(this.destroyed)return;const s=C(this,q).get(r);if(!s.objs.has(e))switch(c){case"Image":s.objs.resolve(e,h);const p=8e6;if(h){let x;if(h.bitmap){const{bitmap:w,width:F,height:P}=h;x=F*P*4,s._bitmaps.add(w)}else x=((l=h.data)==null?void 0:l.length)||0;x>p&&(s.cleanupAfterRender=!0)}break;case"Pattern":s.objs.resolve(e,h);break;default:throw new Error(`Got unknown object type ${c}`)}}),i.on("DocProgress",e=>{var r;this.destroyed||((r=t.onProgress)==null||r.call(t,{loaded:e.loaded,total:e.total}))}),i.on("DocStats",e=>{this.destroyed||lt(this,M,Object.freeze({streamTypes:Object.freeze(e.streamTypes),fontTypes:Object.freeze(e.fontTypes)}))}),i.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),i.on("FetchBuiltInCMap",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(e):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),i.on("FetchStandardFontData",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(e):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:i}){var t,e;this.destroyed||((e=(t=this.loadingTask).onUnsupportedFeature)==null||e.call(t,i))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(i){if(!Number.isInteger(i)||i<=0||i>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=i-1,e=C(this,K).get(t);if(e)return e;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(c=>{if(this.destroyed)throw new Error("Transport destroyed");const h=new PDFPageProxy(t,c,this,this._params.ownerDocument,this._params.pdfBug);return C(this,q).set(t,h),h});return C(this,K).set(t,r),r}getPageIndex(i){return typeof i!="object"||i===null||!Number.isInteger(i.num)||i.num<0||!Number.isInteger(i.gen)||i.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:i.num,gen:i.gen})}getAnnotations(i,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:i,intent:t})}saveDocument(){var i,t;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:(t=(i=this._fullReader)==null?void 0:i.filename)!=null?t:null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(i){return typeof i!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:i})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(i){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:i})}getStructTree(i){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:i})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(i=>new _optional_content_config.OptionalContentConfig(i))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return C(this,N)||lt(this,N,this.messageHandler.sendWithPromise("GetMetadata",null).then(i=>{var t,e,r,c;return{info:i[0],metadata:i[1]?new _metadata.Metadata(i[1]):null,contentDispositionFilename:(e=(t=this._fullReader)==null?void 0:t.filename)!=null?e:null,contentLength:(c=(r=this._fullReader)==null?void 0:r.contentLength)!=null?c:null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(i=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const t of C(this,q).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),i||this.fontLoader.clear(),lt(this,N,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const i=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:i.disableAutoFetch,enableXfa:i.enableXfa})}}M=new WeakMap,q=new WeakMap,K=new WeakMap,N=new WeakMap;class PDFObjects{constructor(){tt(this,d);tt(this,u,Object.create(null))}get(i,t=null){if(t){const r=it(this,d,ie).call(this,i);return r.capability.promise.then(()=>t(r.data)),null}const e=C(this,u)[i];if(!(e!=null&&e.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${i}.`);return e.data}has(i){var t;return((t=C(this,u)[i])==null?void 0:t.capability.settled)||!1}resolve(i,t=null){const e=it(this,d,ie).call(this,i);e.data=t,e.capability.resolve()}clear(){lt(this,u,Object.create(null))}}u=new WeakMap,d=new WeakSet,ie=function(i){return C(this,u)[i]||(C(this,u)[i]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(i){tt(this,y,null);lt(this,y,i),this.onContinue=null}get promise(){return C(this,y).capability.promise}cancel(){C(this,y).cancel()}get separateAnnots(){const{separateAnnots:i}=C(this,y).operatorList;if(!i)return!1;const{annotationCanvasMap:t}=C(this,y);return i.form||i.canvas&&(t==null?void 0:t.size)>0}}y=new WeakMap,exports.RenderTask=RenderTask;const W=class{constructor({callback:i,params:t,objs:e,commonObjs:r,annotationCanvasMap:c,operatorList:h,pageIndex:s,canvasFactory:l,useRequestAnimationFrame:p=!1,pdfBug:x=!1,pageColors:w=null}){this.callback=i,this.params=t,this.objs=e,this.commonObjs=r,this.annotationCanvasMap=c,this.operatorListIdx=null,this.operatorList=h,this._pageIndex=s,this.canvasFactory=l,this._pdfBug=x,this.pageColors=w,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:i=!1,optionalContentConfig:t}){var l;if(this.cancelled)return;if(this._canvas){if(C(W,E).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");C(W,E).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)==null?void 0:l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:e,viewport:r,transform:c,imageLayer:h,background:s}=this.params;this.gfx=new _canvas.CanvasGraphics(e,this.commonObjs,this.objs,this.canvasFactory,h,t,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:c,viewport:r,transparency:i,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(i=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&C(W,E).delete(this._canvas),this.callback(i||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&C(W,E).delete(this._canvas),this.callback())))}};let InternalRenderTask=W;E=new WeakMap,tt(InternalRenderTask,E,new WeakSet);const version="2.15.349";exports.version=version;const build="b8aa9c622";exports.build=build},(st,A,Y)=>{var u,Se,v;Object.defineProperty(A,"__esModule",{value:!0}),A.PrintAnnotationStorage=A.AnnotationStorage=void 0;var _=Y(1),M=Y(8),q=Y(10);class K{constructor(){tt(this,u);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(E,W){const m=this._storage.get(E);return m===void 0?W:Object.assign(W,m)}getRawValue(E){return this._storage.get(E)}removeKey(E){this._storage.delete(E),this._storage.size===0&&this.resetModified()}setValue(E,W){const m=this._storage.get(E);let i=!1;if(m!==void 0)for(const[t,e]of Object.entries(W))m[t]!==e&&(i=!0,m[t]=e);else i=!0,this._storage.set(E,W);i&&it(this,u,Se).call(this)}has(E){return this._storage.has(E)}getAll(){return this._storage.size>0?(0,_.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new N(this)}get serializable(){if(this._storage.size===0)return null;const E=new Map;for(const[W,m]of this._storage){const i=m instanceof M.AnnotationEditor?m.serialize():m;i&&E.set(W,i)}return E}static getHash(E){if(!E)return"";const W=new q.MurmurHash3_64;for(const[m,i]of E)W.update(`${m}:${JSON.stringify(i)}`);return W.hexdigest()}}u=new WeakSet,Se=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},A.AnnotationStorage=K;class N extends K{constructor(W){super();tt(this,v,null);lt(this,v,structuredClone(W.serializable))}get print(){(0,_.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return C(this,v)}}v=new WeakMap,A.PrintAnnotationStorage=N},(st,A,Y)=>{var K,N,u,d,v,y;Object.defineProperty(A,"__esModule",{value:!0}),A.AnnotationEditor=void 0;var _=Y(9),M=Y(1);const E=class{constructor(m){tt(this,K,this.focusin.bind(this));tt(this,N,this.focusout.bind(this));tt(this,u,!1);tt(this,d,!1);tt(this,v,!1);tt(this,y,E._zIndex++);this.constructor===E&&(0,M.unreachable)("Cannot initialize AnnotationEditor."),this.parent=m.parent,this.id=m.id,this.width=this.height=null,this.pageIndex=m.parent.pageIndex,this.name=m.name,this.div=null;const[i,t]=this.parent.viewportBaseDimensions;this.x=m.x/i,this.y=m.y/t,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,M.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=C(this,y)}focusin(m){C(this,u)?lt(this,u,!1):this.parent.setSelected(this)}focusout(m){var i;!this.isAttachedToDOM||(i=m.relatedTarget)!=null&&i.closest(`#${this.id}`)||(m.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(m){const i=this.parent.div.getBoundingClientRect();this.startX=m.clientX-i.x,this.startY=m.clientY-i.y,m.dataTransfer.setData("text/plain",this.id),m.dataTransfer.effectAllowed="move"}setAt(m,i,t,e){const[r,c]=this.parent.viewportBaseDimensions;[t,e]=this.screenToPageTranslation(t,e),this.x=(m+t)/r,this.y=(i+e)/c,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}translate(m,i){const[t,e]=this.parent.viewportBaseDimensions;[m,i]=this.screenToPageTranslation(m,i),this.x+=m/t,this.y+=i/e,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}screenToPageTranslation(m,i){const{rotation:t}=this.parent.viewport;switch(t){case 90:return[i,-m];case 180:return[-m,-i];case 270:return[-i,m];default:return[m,i]}}setDims(m,i){const[t,e]=this.parent.viewportBaseDimensions;this.div.style.width=100*m/t+"%",this.div.style.height=100*i/e+"%"}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",C(this,K)),this.div.addEventListener("focusout",C(this,N));const[m,i]=this.getInitialTranslation();return this.translate(m,i),(0,_.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(m){const i=_.KeyboardManager.platform.isMac;m.button!==0||m.ctrlKey&&i?m.preventDefault():(m.ctrlKey&&!i||m.shiftKey||m.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this),lt(this,u,!0))}getRect(m,i){const[t,e]=this.parent.viewportBaseDimensions,[r,c]=this.parent.pageDimensions,h=r*m/t,s=c*i/e,l=this.x*r,p=this.y*c,x=this.width*r,w=this.height*c;switch(this.rotation){case 0:return[l+h,c-p-s-w,l+h+x,c-p-s];case 90:return[l+s,c-p+h,l+s+w,c-p+h+x];case 180:return[l-h-x,c-p+s,l-h,c-p+s+w];case 270:return[l-s-w,c-p-h-x,l-s,c-p-h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(m,i){const[t,e,r,c]=m,h=r-t,s=c-e;switch(this.rotation){case 0:return[t,i-c,h,s];case 90:return[t,i-e,s,h];case 180:return[r,i-e,h,s];case 270:return[r,i-c,s,h];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){lt(this,v,!0)}disableEditMode(){lt(this,v,!1)}isInEditMode(){return C(this,v)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var m;(m=this.div)==null||m.addEventListener("focusin",C(this,K))}serialize(){(0,M.unreachable)("An editor must be serializable")}static deserialize(m,i){const t=new this.prototype.constructor({parent:i,id:i.getNextId()});t.rotation=m.rotation;const[e,r]=i.pageDimensions,[c,h,s,l]=t.getRectInCurrentCoords(m.rect,r);return t.x=c/e,t.y=h/r,t.width=s/e,t.height=l/r,t}remove(){this.div.removeEventListener("focusin",C(this,K)),this.div.removeEventListener("focusout",C(this,N)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var m;(m=this.div)==null||m.classList.add("selectedEditor")}unselect(){var m;(m=this.div)==null||m.classList.remove("selectedEditor")}updateParams(m,i){}disableEditing(){}enableEditing(){}getIdForTextLayer(){return this.id}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return C(this,d)}set isEditing(m){lt(this,d,m),m?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let q=E;K=new WeakMap,N=new WeakMap,u=new WeakMap,d=new WeakMap,v=new WeakMap,y=new WeakMap,Et(q,"_colorManager",new _.ColorManager),Et(q,"_zIndex",1),A.AnnotationEditor=q},(st,A,Y)=>{var y,E,W,m,i,t,xe,c,s,l,p,x,w,F,P,U,J,V,I,n,a,g,S,T,D,R,L,Ce,B,ne,o,kt,f,qt,O,Te,X,Ee,Z,re,H,Wt,ct,Yt;Object.defineProperty(A,"__esModule",{value:!0}),A.KeyboardManager=A.CommandManager=A.ColorManager=A.AnnotationEditorUIManager=void 0,A.bindEvents=function(z,ht,pt){for(const vt of pt)ht.addEventListener(vt,z[vt].bind(z))},A.opacityToHex=function(z){return Math.round(Math.min(255,Math.max(1,255*z))).toString(16).padStart(2,"0")};var _=Y(1),M=Y(4);class q{constructor(){tt(this,y,0)}getId(){return`${_.AnnotationEditorPrefix}${se(this,y)._++}`}}y=new WeakMap;class K{constructor(z=128){tt(this,E,[]);tt(this,W,!1);tt(this,m,void 0);tt(this,i,-1);lt(this,m,z)}add({cmd:z,undo:ht,mustExec:pt,type:vt=NaN,overwriteIfSameType:bt=!1,keepUndo:Nt=!1}){if(pt&&z(),C(this,W))return;const Pt={cmd:z,undo:ht,type:vt};if(C(this,i)===-1){C(this,E).length>0&&(C(this,E).length=0),lt(this,i,0),C(this,E).push(Pt);return}if(bt&&C(this,E)[C(this,i)].type===vt){Nt&&(Pt.undo=C(this,E)[C(this,i)].undo),C(this,E)[C(this,i)]=Pt;return}const zt=C(this,i)+1;zt===C(this,m)?C(this,E).splice(0,1):(lt(this,i,zt),zt<C(this,E).length&&C(this,E).splice(zt)),C(this,E).push(Pt)}undo(){C(this,i)!==-1&&(lt(this,W,!0),C(this,E)[C(this,i)].undo(),lt(this,W,!1),lt(this,i,C(this,i)-1))}redo(){C(this,i)<C(this,E).length-1&&(lt(this,i,C(this,i)+1),lt(this,W,!0),C(this,E)[C(this,i)].cmd(),lt(this,W,!1))}hasSomethingToUndo(){return C(this,i)!==-1}hasSomethingToRedo(){return C(this,i)<C(this,E).length-1}destroy(){lt(this,E,null)}}E=new WeakMap,W=new WeakMap,m=new WeakMap,i=new WeakMap,A.CommandManager=K;const r=class{constructor(z){tt(this,t);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const ht=r.platform.isMac;for(const[pt,vt]of z)for(const bt of pt){const Nt=bt.startsWith("mac+");ht&&Nt?(this.callbacks.set(bt.slice(4),vt),this.allKeys.add(bt.split("+").at(-1))):!ht&&!Nt&&(this.callbacks.set(bt,vt),this.allKeys.add(bt.split("+").at(-1)))}}static get platform(){const z=typeof navigator<"u"?navigator.platform:"";return(0,_.shadow)(this,"platform",{isWin:z.includes("Win"),isMac:z.includes("Mac")})}exec(z,ht){if(!this.allKeys.has(ht.key))return;const pt=this.callbacks.get(it(this,t,xe).call(this,ht));pt&&(pt.bind(z)(),ht.stopPropagation(),ht.preventDefault())}};let N=r;t=new WeakSet,xe=function(z){z.altKey&&this.buffer.push("alt"),z.ctrlKey&&this.buffer.push("ctrl"),z.metaKey&&this.buffer.push("meta"),z.shiftKey&&this.buffer.push("shift"),this.buffer.push(z.key);const ht=this.buffer.join("+");return this.buffer.length=0,ht},A.KeyboardManager=N;class u{constructor(){tt(this,c,null)}copy(z){z&&(Array.isArray(z)?lt(this,c,z.map(ht=>ht.serialize())):lt(this,c,[z.serialize()]),lt(this,c,C(this,c).filter(ht=>!!ht)),C(this,c).length===0&&lt(this,c,null))}paste(){return C(this,c)}isEmpty(){return C(this,c)===null}destroy(){lt(this,c,null)}}c=new WeakMap;const h=class{get _colors(){const z=new Map([["CanvasText",null],["Canvas",null]]);return(0,M.getColorValues)(z),(0,_.shadow)(this,"_colors",z)}convert(z){const ht=(0,M.getRGB)(z);if(!window.matchMedia("(forced-colors: active)").matches)return ht;for(const[pt,vt]of this._colors)if(vt.every((bt,Nt)=>bt===ht[Nt]))return h._colorsMapping.get(pt);return ht}getHexCode(z){const ht=this._colors.get(z);return ht?_.Util.makeHexColor(...ht):z}};let d=h;Et(d,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),A.ColorManager=d;const dt=class{constructor(z,ht){tt(this,L);tt(this,B);tt(this,o);tt(this,f);tt(this,O);tt(this,X);tt(this,Z);tt(this,H);tt(this,ct);tt(this,s,null);tt(this,l,new Map);tt(this,p,new Map);tt(this,x,new u);tt(this,w,new K);tt(this,F,0);tt(this,P,null);tt(this,U,null);tt(this,J,new q);tt(this,V,!1);tt(this,I,_.AnnotationEditorType.NONE);tt(this,n,new Set);tt(this,a,this.keydown.bind(this));tt(this,g,this.onEditingAction.bind(this));tt(this,S,this.onPageChanging.bind(this));tt(this,T,this.onTextLayerRendered.bind(this));tt(this,D,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});tt(this,R,null);lt(this,R,z),lt(this,U,ht),C(this,U)._on("editingaction",C(this,g)),C(this,U)._on("pagechanging",C(this,S)),C(this,U)._on("textlayerrendered",C(this,T))}destroy(){it(this,B,ne).call(this),C(this,U)._off("editingaction",C(this,g)),C(this,U)._off("pagechanging",C(this,S)),C(this,U)._off("textlayerrendered",C(this,T));for(const z of C(this,p).values())z.destroy();C(this,p).clear(),C(this,l).clear(),lt(this,s,null),C(this,n).clear(),C(this,x).destroy(),C(this,w).destroy()}onPageChanging({pageNumber:z}){lt(this,F,z-1)}onTextLayerRendered({pageNumber:z}){var pt;const ht=z-1;(pt=C(this,p).get(ht))==null||pt.onTextLayerRendered()}focusMainContainer(){C(this,R).focus()}keydown(z){var ht;(ht=this.getActive())!=null&&ht.shouldGetKeyboardEvents()||dt._keyboardManager.exec(this,z)}onEditingAction(z){["undo","redo","cut","copy","paste","delete","selectAll"].includes(z.name)&&this[z.name]()}setEditingState(z){z?(it(this,L,Ce).call(this),it(this,o,kt).call(this,{isEditing:C(this,I)!==_.AnnotationEditorType.NONE,isEmpty:it(this,H,Wt).call(this),hasSomethingToUndo:C(this,w).hasSomethingToUndo(),hasSomethingToRedo:C(this,w).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:C(this,x).isEmpty()})):(it(this,B,ne).call(this),it(this,o,kt).call(this,{isEditing:!1}))}registerEditorTypes(z){lt(this,P,z);for(const ht of C(this,P))it(this,f,qt).call(this,ht.defaultPropertiesToUpdate)}getId(){return C(this,J).getId()}addLayer(z){C(this,p).set(z.pageIndex,z),C(this,V)?z.enable():z.disable()}removeLayer(z){C(this,p).delete(z.pageIndex)}updateMode(z){if(lt(this,I,z),z===_.AnnotationEditorType.NONE)this.setEditingState(!1),it(this,X,Ee).call(this);else{this.setEditingState(!0),it(this,O,Te).call(this);for(const ht of C(this,p).values())ht.updateMode(z)}}updateToolbar(z){z!==C(this,I)&&C(this,U).dispatch("switchannotationeditormode",{source:this,mode:z})}updateParams(z,ht){for(const pt of C(this,n))pt.updateParams(z,ht);for(const pt of C(this,P))pt.updateDefaultParams(z,ht)}getEditors(z){const ht=[];for(const pt of C(this,l).values())pt.pageIndex===z&&ht.push(pt);return ht}getEditor(z){return C(this,l).get(z)}addEditor(z){C(this,l).set(z.id,z)}removeEditor(z){C(this,l).delete(z.id),this.unselect(z)}setActiveEditor(z){C(this,s)!==z&&(lt(this,s,z),z&&it(this,f,qt).call(this,z.propertiesToUpdate))}toggleSelected(z){C(this,n).has(z)?(C(this,n).delete(z),z.unselect(),it(this,o,kt).call(this,{hasSelectedEditor:this.hasSelection})):(C(this,n).add(z),z.select(),it(this,f,qt).call(this,z.propertiesToUpdate),it(this,o,kt).call(this,{hasSelectedEditor:!0}))}setSelected(z){for(const ht of C(this,n))ht!==z&&ht.unselect();C(this,n).clear(),C(this,n).add(z),z.select(),it(this,f,qt).call(this,z.propertiesToUpdate),it(this,o,kt).call(this,{hasSelectedEditor:!0})}isSelected(z){return C(this,n).has(z)}unselect(z){z.unselect(),C(this,n).delete(z),it(this,o,kt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return C(this,n).size!==0}undo(){C(this,w).undo(),it(this,o,kt).call(this,{hasSomethingToUndo:C(this,w).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:it(this,H,Wt).call(this)})}redo(){C(this,w).redo(),it(this,o,kt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:C(this,w).hasSomethingToRedo(),isEmpty:it(this,H,Wt).call(this)})}addCommands(z){C(this,w).add(z),it(this,o,kt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:it(this,H,Wt).call(this)})}delete(){if(C(this,s)&&C(this,s).commitOrRemove(),!this.hasSelection)return;const z=[...C(this,n)];this.addCommands({cmd:()=>{for(const ht of z)ht.remove()},undo:()=>{for(const ht of z)it(this,Z,re).call(this,ht)},mustExec:!0})}copy(){if(C(this,s)&&C(this,s).commitOrRemove(),this.hasSelection){const z=[];for(const ht of C(this,n))ht.isEmpty()||z.push(ht);if(z.length===0)return;C(this,x).copy(z),it(this,o,kt).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(C(this,x).isEmpty())return;this.unselectAll();const z=C(this,p).get(C(this,F)),ht=C(this,x).paste().map(pt=>z.deserialize(pt));this.addCommands({cmd:()=>{for(const pt of ht)it(this,Z,re).call(this,pt);it(this,ct,Yt).call(this,ht)},undo:()=>{for(const pt of ht)pt.remove()},mustExec:!0})}selectAll(){for(const z of C(this,n))z.commit();it(this,ct,Yt).call(this,C(this,l).values())}unselectAll(){if(C(this,s))C(this,s).commitOrRemove();else if(it(this,ct,Yt).size!==0){for(const z of C(this,n))z.unselect();C(this,n).clear(),it(this,o,kt).call(this,{hasSelectedEditor:!1})}}isActive(z){return C(this,s)===z}getActive(){return C(this,s)}getMode(){return C(this,I)}};let v=dt;s=new WeakMap,l=new WeakMap,p=new WeakMap,x=new WeakMap,w=new WeakMap,F=new WeakMap,P=new WeakMap,U=new WeakMap,J=new WeakMap,V=new WeakMap,I=new WeakMap,n=new WeakMap,a=new WeakMap,g=new WeakMap,S=new WeakMap,T=new WeakMap,D=new WeakMap,R=new WeakMap,L=new WeakSet,Ce=function(){C(this,R).addEventListener("keydown",C(this,a))},B=new WeakSet,ne=function(){C(this,R).removeEventListener("keydown",C(this,a))},o=new WeakSet,kt=function(z){Object.entries(z).some(([ht,pt])=>C(this,D)[ht]!==pt)&&C(this,U).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(C(this,D),z)})},f=new WeakSet,qt=function(z){C(this,U).dispatch("annotationeditorparamschanged",{source:this,details:z})},O=new WeakSet,Te=function(){if(!C(this,V)){lt(this,V,!0);for(const z of C(this,p).values())z.enable()}},X=new WeakSet,Ee=function(){if(this.unselectAll(),C(this,V)){lt(this,V,!1);for(const z of C(this,p).values())z.disable()}},Z=new WeakSet,re=function(z){const ht=C(this,p).get(z.pageIndex);ht?ht.addOrRebuild(z):this.addEditor(z)},H=new WeakSet,Wt=function(){if(C(this,l).size===0)return!0;if(C(this,l).size===1)for(const z of C(this,l).values())return z.isEmpty();return!1},ct=new WeakSet,Yt=function(z){C(this,n).clear();for(const ht of z)ht.isEmpty()||(C(this,n).add(ht),ht.select());it(this,o,kt).call(this,{hasSelectedEditor:!0})},Et(v,"_keyboardManager",new N([[["ctrl+a","mac+meta+a"],dt.prototype.selectAll],[["ctrl+c","mac+meta+c"],dt.prototype.copy],[["ctrl+v","mac+meta+v"],dt.prototype.paste],[["ctrl+x","mac+meta+x"],dt.prototype.cut],[["ctrl+z","mac+meta+z"],dt.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],dt.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],dt.prototype.delete],[["Escape","mac+Escape"],dt.prototype.unselectAll]])),A.AnnotationEditorUIManager=v},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.MurmurHash3_64=void 0;var _=Y(1);const M=3285377520,q=4294901760,K=65535;A.MurmurHash3_64=class{constructor(u){this.h1=u?4294967295&u:M,this.h2=u?4294967295&u:M}update(u){let d,v;if(typeof u=="string"){d=new Uint8Array(2*u.length),v=0;for(let l=0,p=u.length;l<p;l++){const x=u.charCodeAt(l);x<=255?d[v++]=x:(d[v++]=x>>>8,d[v++]=255&x)}}else{if(!(0,_.isArrayBuffer)(u))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");d=u.slice(),v=d.byteLength}const y=v>>2,E=v-4*y,W=new Uint32Array(d.buffer,0,y);let m=0,i=0,t=this.h1,e=this.h2;const r=3432918353,c=461845907,h=11601,s=13715;for(let l=0;l<y;l++)1&l?(m=W[l],m=m*r&q|m*h&K,m=m<<15|m>>>17,m=m*c&q|m*s&K,t^=m,t=t<<13|t>>>19,t=5*t+3864292196):(i=W[l],i=i*r&q|i*h&K,i=i<<15|i>>>17,i=i*c&q|i*s&K,e^=i,e=e<<13|e>>>19,e=5*e+3864292196);switch(m=0,E){case 3:m^=d[4*y+2]<<16;case 2:m^=d[4*y+1]<<8;case 1:m^=d[4*y],m=m*r&q|m*h&K,m=m<<15|m>>>17,m=m*c&q|m*s&K,1&y?t^=m:e^=m}this.h1=t,this.h2=e}hexdigest(){let u=this.h1,d=this.h2;u^=d>>>1,u=3981806797*u&q|36045*u&K,d=4283543511*d&q|(2950163797*(d<<16|u>>>16)&q)>>>16,u^=d>>>1,u=444984403*u&q|60499*u&K,d=3301882366*d&q|(3120437893*(d<<16|u>>>16)&q)>>>16,u^=d>>>1;const v=(u>>>0).toString(16),y=(d>>>0).toString(16);return v.padStart(8,"0")+y.padStart(8,"0")}}},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.FontLoader=A.FontFaceObject=void 0;var _=Y(1);class M{constructor({docId:N,onUnsupportedFeature:u,ownerDocument:d=globalThis.document,styleElement:v=null}){this.constructor===M&&(0,_.unreachable)("Cannot initialize BaseFontLoader."),this.docId=N,this._onUnsupportedFeature=u,this._document=d,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(N){this.nativeFontFaces.push(N),this._document.fonts.add(N)}insertRule(N){let u=this.styleElement;u||(u=this.styleElement=this._document.createElement("style"),u.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(u));const d=u.sheet;d.insertRule(N,d.cssRules.length)}clear(){for(const N of this.nativeFontFaces)this._document.fonts.delete(N);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(N){if(N.attached||N.missingFile)return;if(N.attached=!0,this.isFontLoadingAPISupported){const d=N.createNativeFontFace();if(d){this.addNativeFontFace(d);try{await d.loaded}catch(v){throw this._onUnsupportedFeature({featureId:_.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,_.warn)(`Failed to load font '${d.family}': '${v}'.`),N.disableFontFace=!0,v}}return}const u=N.createFontFaceRule();if(u){if(this.insertRule(u),this.isSyncFontLoadingSupported)return;await new Promise(d=>{const v=this._queueLoadingCallback(d);this._prepareFontLoadEvent([u],[N],v)})}}_queueLoadingCallback(N){(0,_.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var u;const N=!!((u=this._document)!=null&&u.fonts);return(0,_.shadow)(this,"isFontLoadingAPISupported",N)}get isSyncFontLoadingSupported(){(0,_.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,_.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(N,u,d){(0,_.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let q;A.FontLoader=q,A.FontLoader=q=class extends M{constructor(N){super(N),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){var u;let N=!1;return(typeof navigator>"u"||((u=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent))==null?void 0:u[1])>=14)&&(N=!0),(0,_.shadow)(this,"isSyncFontLoadingSupported",N)}_queueLoadingCallback(N){const u=this.loadingContext,d={id:"pdfjs-font-loading-"+u.nextRequestId++,done:!1,complete:function(){for((0,_.assert)(!d.done,"completeRequest() cannot be called twice."),d.done=!0;u.requests.length>0&&u.requests[0].done;){const y=u.requests.shift();setTimeout(y.callback,0)}},callback:N};return u.requests.push(d),d}get _loadTestFont(){return(0,_.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(N,u,d){function v(x,w){return x.charCodeAt(w)<<24|x.charCodeAt(w+1)<<16|x.charCodeAt(w+2)<<8|255&x.charCodeAt(w+3)}function y(x,w,F,P){return x.substring(0,w)+P+x.substring(w+F)}let E,W;const m=this._document.createElement("canvas");m.width=1,m.height=1;const i=m.getContext("2d");let t=0;const e=`lt${Date.now()}${this.loadTestFontId++}`;let r=this._loadTestFont;r=y(r,976,e.length,e);const c=1482184792;let h=v(r,16);for(E=0,W=e.length-3;E<W;E+=4)h=h-c+v(e,E)|0;E<e.length&&(h=h-c+v(e+"XXX",E)|0),r=y(r,16,4,(0,_.string32)(h));const s=`@font-face {font-family:"${e}";src:${`url(data:font/opentype;base64,${btoa(r)});`}}`;this.insertRule(s);const l=[];for(const x of u)l.push(x.loadedName);l.push(e);const p=this._document.createElement("div");p.style.visibility="hidden",p.style.width=p.style.height="10px",p.style.position="absolute",p.style.top=p.style.left="0px";for(const x of l){const w=this._document.createElement("span");w.textContent="Hi",w.style.fontFamily=x,p.append(w)}this._document.body.append(p),function x(w,F){if(t++,t>30){(0,_.warn)("Load test font never loaded."),F();return}i.font="30px "+w,i.fillText(".",0,20),i.getImageData(0,0,1,1).data[3]>0?F():setTimeout(x.bind(null,w,F))}(e,()=>{p.remove(),d.complete()})}},A.FontFaceObject=class{constructor(N,{isEvalSupported:u=!0,disableFontFace:d=!1,ignoreErrors:v=!1,onUnsupportedFeature:y,fontRegistry:E=null}){this.compiledGlyphs=Object.create(null);for(const W in N)this[W]=N[W];this.isEvalSupported=u!==!1,this.disableFontFace=d===!0,this.ignoreErrors=v===!0,this._onUnsupportedFeature=y,this.fontRegistry=E}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let N;if(this.cssFontInfo){const u={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(u.style=`oblique ${this.cssFontInfo.italicAngle}deg`),N=new FontFace(this.cssFontInfo.fontFamily,this.data,u)}else N=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),N}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const N=(0,_.bytesToString)(this.data),u=`url(data:${this.mimetype};base64,${btoa(N)});`;let d;if(this.cssFontInfo){let v=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(v+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),d=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${v}src:${u}}`}else d=`@font-face {font-family:"${this.loadedName}";src:${u}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,u),d}getPathGenerator(N,u){if(this.compiledGlyphs[u]!==void 0)return this.compiledGlyphs[u];let d;try{d=N.get(this.loadedName+"_path_"+u)}catch(v){if(!this.ignoreErrors)throw v;return this._onUnsupportedFeature({featureId:_.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,_.warn)(`getPathGenerator - ignoring character: "${v}".`),this.compiledGlyphs[u]=function(y,E){}}if(this.isEvalSupported&&_.FeatureTest.isEvalSupported){const v=[];for(const y of d){const E=y.args!==void 0?y.args.join(","):"";v.push("c.",y.cmd,"(",E,`);
`)}return this.compiledGlyphs[u]=new Function("c","size",v.join(""))}return this.compiledGlyphs[u]=function(v,y){for(const E of d)E.cmd==="scale"&&(E.args=[y,-y]),v[E.cmd].apply(v,E.args)}}}},(st,A,Y)=>{var U,ae;Object.defineProperty(A,"__esModule",{value:!0}),A.CanvasGraphics=void 0;var _=Y(1),M=Y(4),q=Y(13),K=Y(14),N=Y(3);const u=4096,d=16;function v(I){if(I._transformStack&&(I._transformStack=[]),!I.mozCurrentTransform){I._originalSave=I.save,I._originalRestore=I.restore,I._originalRotate=I.rotate,I._originalScale=I.scale,I._originalTranslate=I.translate,I._originalTransform=I.transform,I._originalSetTransform=I.setTransform,I._originalResetTransform=I.resetTransform,I._transformMatrix=I._transformMatrix||[1,0,0,1,0,0],I._transformStack=[];try{const n=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(I),"lineWidth");I._setLineWidth=n.set,I._getLineWidth=n.get,Object.defineProperty(I,"lineWidth",{set:function(g){this._setLineWidth(1.000001*g)},get:function(){return this._getLineWidth()}})}catch{}Object.defineProperty(I,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(I,"mozCurrentTransformInverse",{get:function(){const[a,g,S,T,D,R]=this._transformMatrix,L=a*T-g*S,j=g*S-a*T;return[T/L,g/j,S/j,a/L,(T*D-S*R)/j,(g*D-a*R)/L]}}),I.save=function(){const a=this._transformMatrix;this._transformStack.push(a),this._transformMatrix=a.slice(0,6),this._originalSave()},I.restore=function(){this._transformStack.length===0&&(0,_.warn)("Tried to restore a ctx when the stack was already empty.");const a=this._transformStack.pop();a&&(this._transformMatrix=a,this._originalRestore())},I.translate=function(a,g){const S=this._transformMatrix;S[4]=S[0]*a+S[2]*g+S[4],S[5]=S[1]*a+S[3]*g+S[5],this._originalTranslate(a,g)},I.scale=function(a,g){const S=this._transformMatrix;S[0]*=a,S[1]*=a,S[2]*=g,S[3]*=g,this._originalScale(a,g)},I.transform=function(a,g,S,T,D,R){const L=this._transformMatrix;this._transformMatrix=[L[0]*a+L[2]*g,L[1]*a+L[3]*g,L[0]*S+L[2]*T,L[1]*S+L[3]*T,L[0]*D+L[2]*R+L[4],L[1]*D+L[3]*R+L[5]],I._originalTransform(a,g,S,T,D,R)},I.setTransform=function(a,g,S,T,D,R){this._transformMatrix=[a,g,S,T,D,R],I._originalSetTransform(a,g,S,T,D,R)},I.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0],I._originalResetTransform()},I.rotate=function(a){const g=Math.cos(a),S=Math.sin(a),T=this._transformMatrix;this._transformMatrix=[T[0]*g+T[2]*S,T[1]*g+T[3]*S,T[0]*-S+T[2]*g,T[1]*-S+T[3]*g,T[4],T[5]],this._originalRotate(a)}}}class y{constructor(n){this.canvasFactory=n,this.cache=Object.create(null)}getCanvas(n,a,g,S){let T;return this.cache[n]!==void 0?(T=this.cache[n],this.canvasFactory.reset(T,a,g),T.context.setTransform(1,0,0,1,0,0)):(T=this.canvasFactory.create(a,g),this.cache[n]=T),S&&v(T.context),T}delete(n){delete this.cache[n]}clear(){for(const n in this.cache){const a=this.cache[n];this.canvasFactory.destroy(a),delete this.cache[n]}}}function E(I,n,a,g,S,T,D,R,L,j){const[B,$,o,b,f,k]=I.mozCurrentTransform;if($===0&&o===0){const O=D*B+f,G=Math.round(O),X=R*b+k,Q=Math.round(X),Z=(D+L)*B+f,rt=Math.abs(Math.round(Z)-G)||1,H=(R+j)*b+k,nt=Math.abs(Math.round(H)-Q)||1;return I.setTransform(Math.sign(B),0,0,Math.sign(b),G,Q),I.drawImage(n,a,g,S,T,0,0,rt,nt),I.setTransform(B,$,o,b,f,k),[rt,nt]}if(B===0&&b===0){const O=R*o+f,G=Math.round(O),X=D*$+k,Q=Math.round(X),Z=(R+j)*o+f,rt=Math.abs(Math.round(Z)-G)||1,H=(D+L)*$+k,nt=Math.abs(Math.round(H)-Q)||1;return I.setTransform(0,Math.sign($),Math.sign(o),0,G,Q),I.drawImage(n,a,g,S,T,0,0,nt,rt),I.setTransform(B,$,o,b,f,k),[nt,rt]}return I.drawImage(n,a,g,S,T,D,R,L,j),[Math.hypot(B,$)*L,Math.hypot(o,b)*j]}class W{constructor(n,a){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=_.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=_.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=_.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,n,a])}clone(){const n=Object.create(this);return n.clipBox=this.clipBox.slice(),n}setCurrentPoint(n,a){this.x=n,this.y=a}updatePathMinMax(n,a,g){[a,g]=_.Util.applyTransform([a,g],n),this.minX=Math.min(this.minX,a),this.minY=Math.min(this.minY,g),this.maxX=Math.max(this.maxX,a),this.maxY=Math.max(this.maxY,g)}updateRectMinMax(n,a){const g=_.Util.applyTransform(a,n),S=_.Util.applyTransform(a.slice(2),n);this.minX=Math.min(this.minX,g[0],S[0]),this.minY=Math.min(this.minY,g[1],S[1]),this.maxX=Math.max(this.maxX,g[0],S[0]),this.maxY=Math.max(this.maxY,g[1],S[1])}updateScalingPathMinMax(n,a){_.Util.scaleMinMax(n,a),this.minX=Math.min(this.minX,a[0]),this.maxX=Math.max(this.maxX,a[1]),this.minY=Math.min(this.minY,a[2]),this.maxY=Math.max(this.maxY,a[3])}updateCurvePathMinMax(n,a,g,S,T,D,R,L,j,B){const $=_.Util.bezierBoundingBox(a,g,S,T,D,R,L,j);B?(B[0]=Math.min(B[0],$[0],$[2]),B[1]=Math.max(B[1],$[0],$[2]),B[2]=Math.min(B[2],$[1],$[3]),B[3]=Math.max(B[3],$[1],$[3])):this.updateRectMinMax(n,$)}getPathBoundingBox(n=q.PathType.FILL,a=null){const g=[this.minX,this.minY,this.maxX,this.maxY];if(n===q.PathType.STROKE){a||(0,_.unreachable)("Stroke bounding box must include transform.");const S=_.Util.singularValueDecompose2dScale(a),T=S[0]*this.lineWidth/2,D=S[1]*this.lineWidth/2;g[0]-=T,g[1]-=D,g[2]+=T,g[3]+=D}return g}updateClipFromPath(){const n=_.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(n||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(n){this.clipBox=n,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(n=q.PathType.FILL,a=null){return _.Util.intersect(this.clipBox,this.getPathBoundingBox(n,a))}}function m(I,n,a=null){if(typeof ImageData<"u"&&n instanceof ImageData){I.putImageData(n,0,0);return}const g=n.height,S=n.width,T=g%d,D=(g-T)/d,R=T===0?D:D+1,L=I.createImageData(S,d);let j,B=0;const $=n.data,o=L.data;let b,f,k,O,G,X,Q,Z;if(a)switch(a.length){case 1:G=a[0],X=a[0],Q=a[0],Z=a[0];break;case 4:G=a[0],X=a[1],Q=a[2],Z=a[3]}if(n.kind===_.ImageKind.GRAYSCALE_1BPP){const rt=$.byteLength,H=new Uint32Array(o.buffer,0,o.byteLength>>2),nt=H.length,ct=S+7>>3;let ot=4294967295,dt=_.FeatureTest.isLittleEndian?4278190080:255;for(Z&&Z[0]===255&&Z[255]===0&&([ot,dt]=[dt,ot]),b=0;b<R;b++){for(k=b<D?d:T,j=0,f=0;f<k;f++){const ft=rt-B;let z=0;const ht=ft>ct?S:8*ft-7,pt=-8&ht;let vt=0,bt=0;for(;z<pt;z+=8)bt=$[B++],H[j++]=128&bt?ot:dt,H[j++]=64&bt?ot:dt,H[j++]=32&bt?ot:dt,H[j++]=16&bt?ot:dt,H[j++]=8&bt?ot:dt,H[j++]=4&bt?ot:dt,H[j++]=2&bt?ot:dt,H[j++]=1&bt?ot:dt;for(;z<ht;z++)vt===0&&(bt=$[B++],vt=128),H[j++]=bt&vt?ot:dt,vt>>=1}for(;j<nt;)H[j++]=0;I.putImageData(L,0,b*d)}}else if(n.kind===_.ImageKind.RGBA_32BPP){const rt=!!(G||X||Q);for(f=0,O=S*d*4,b=0;b<D;b++){if(o.set($.subarray(B,B+O)),B+=O,rt)for(let H=0;H<O;H+=4)G&&(o[H+0]=G[o[H+0]]),X&&(o[H+1]=X[o[H+1]]),Q&&(o[H+2]=Q[o[H+2]]);I.putImageData(L,0,f),f+=d}if(b<R){if(O=S*T*4,o.set($.subarray(B,B+O)),rt)for(let H=0;H<O;H+=4)G&&(o[H+0]=G[o[H+0]]),X&&(o[H+1]=X[o[H+1]]),Q&&(o[H+2]=Q[o[H+2]]);I.putImageData(L,0,f)}}else{if(n.kind!==_.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${n.kind}`);{const rt=!!(G||X||Q);for(k=d,O=S*k,b=0;b<R;b++){for(b>=D&&(k=T,O=S*k),j=0,f=O;f--;)o[j++]=$[B++],o[j++]=$[B++],o[j++]=$[B++],o[j++]=255;if(rt)for(let H=0;H<j;H+=4)G&&(o[H+0]=G[o[H+0]]),X&&(o[H+1]=X[o[H+1]]),Q&&(o[H+2]=Q[o[H+2]]);I.putImageData(L,0,b*d)}}}}function i(I,n){if(n.bitmap){I.drawImage(n.bitmap,0,0);return}const a=n.height,g=n.width,S=a%d,T=(a-S)/d,D=S===0?T:T+1,R=I.createImageData(g,d);let L=0;const j=n.data,B=R.data;for(let $=0;$<D;$++){const o=$<T?d:S;({srcPos:L}=(0,K.applyMaskImageData)({src:j,srcPos:L,dest:B,width:g,height:o})),I.putImageData(R,0,$*d)}}function t(I,n){const a=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let g=0,S=a.length;g<S;g++){const T=a[g];I[T]!==void 0&&(n[T]=I[T])}I.setLineDash!==void 0&&(n.setLineDash(I.getLineDash()),n.lineDashOffset=I.lineDashOffset)}function e(I,n){I.strokeStyle=I.fillStyle=n||"#000000",I.fillRule="nonzero",I.globalAlpha=1,I.lineWidth=1,I.lineCap="butt",I.lineJoin="miter",I.miterLimit=10,I.globalCompositeOperation="source-over",I.font="10px sans-serif",I.setLineDash!==void 0&&(I.setLineDash([]),I.lineDashOffset=0)}function r(I,n,a,g){const S=I.length;for(let T=3;T<S;T+=4){const D=I[T];if(D===0)I[T-3]=n,I[T-2]=a,I[T-1]=g;else if(D<255){const R=255-D;I[T-3]=I[T-3]*D+n*R>>8,I[T-2]=I[T-2]*D+a*R>>8,I[T-1]=I[T-1]*D+g*R>>8}}}function c(I,n,a){const g=I.length;for(let S=3;S<g;S+=4){const T=a?a[I[S]]:I[S];n[S]=n[S]*T*.00392156862745098|0}}function h(I,n,a){const g=I.length;for(let S=3;S<g;S+=4){const T=77*I[S-3]+152*I[S-2]+28*I[S-1];n[S]=a?n[S]*a[T>>8]>>8:n[S]*T>>16}}function s(I,n,a,g){const S=g[0],T=g[1],D=g[2]-S,R=g[3]-T;D!==0&&R!==0&&(function(j,B,$,o,b,f,k,O,G,X,Q){const Z=!!f,rt=Z?f[0]:0,H=Z?f[1]:0,nt=Z?f[2]:0;let ct;ct=b==="Luminosity"?h:c;const ot=Math.min(o,Math.ceil(1048576/$));for(let dt=0;dt<o;dt+=ot){const ft=Math.min(ot,o-dt),z=j.getImageData(O-X,dt+(G-Q),$,ft),ht=B.getImageData(O,dt+G,$,ft);Z&&r(z.data,rt,H,nt),ct(z.data,ht.data,k),B.putImageData(ht,O,dt+G)}}(n.context,a,D,R,n.subtype,n.backdrop,n.transferMap,S,T,n.offsetX,n.offsetY),I.save(),I.globalAlpha=1,I.globalCompositeOperation="source-over",I.setTransform(1,0,0,1,0,0),I.drawImage(a.canvas,0,0),I.restore())}function l(I,n){const a=_.Util.singularValueDecompose2dScale(I);a[0]=Math.fround(a[0]),a[1]=Math.fround(a[1]);const g=Math.fround((globalThis.devicePixelRatio||1)*M.PixelsPerInch.PDF_TO_CSS_UNITS);return n!==void 0?n:a[0]<=g||a[1]<=g}const p=["butt","round","square"],x=["miter","round","bevel"],w={},F={},V=class{constructor(n,a,g,S,T,D,R,L){tt(this,U);this.ctx=n,this.current=new W(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=a,this.objs=g,this.canvasFactory=S,this.imageLayer=T,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=D,this.cachedCanvases=new y(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=R,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(L==null?void 0:L.background)||null,this.foregroundColor=(L==null?void 0:L.foreground)||null,n&&v(n),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(n,a=null){return typeof n=="string"?n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n):a}beginDrawing({transform:n,viewport:a,transparency:g=!1,background:S=null}){const T=this.ctx.canvas.width,D=this.ctx.canvas.height,R=S||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const L=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const j=this.backgroundColor=this.ctx.fillStyle;let B=!0,$=R;if(this.ctx.fillStyle=R,$=this.ctx.fillStyle,B=typeof $=="string"&&/^#[0-9A-Fa-f]{6}$/.test($),L==="#000000"&&j==="#ffffff"||L===j||!B)this.foregroundColor=this.backgroundColor=null;else{const[o,b,f]=(0,M.getRGB)($),k=G=>(G/=255)<=.03928?G/12.92:((G+.055)/1.055)**2.4,O=Math.round(.2126*k(o)+.7152*k(b)+.0722*k(f));this.selectColor=(G,X,Q)=>{const Z=.2126*k(G)+.7152*k(X)+.0722*k(Q);return Math.round(Z)===O?j:L}}}if(this.ctx.fillStyle=this.backgroundColor||R,this.ctx.fillRect(0,0,T,D),this.ctx.restore(),g){const L=this.cachedCanvases.getCanvas("transparent",T,D,!0);this.compositeCtx=this.ctx,this.transparentCanvas=L.canvas,this.ctx=L.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),e(this.ctx,this.foregroundColor),n&&(this.ctx.transform.apply(this.ctx,n),this.outputScaleX=n[0],this.outputScaleY=n[0]),this.ctx.transform.apply(this.ctx,a.transform),this.viewportScale=a.scale,this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()}executeOperatorList(n,a,g,S){const T=n.argsArray,D=n.fnArray;let R=a||0;const L=T.length;if(L===R)return R;const j=L-R>10&&typeof g=="function",B=j?Date.now()+15:0;let $=0;const o=this.commonObjs,b=this.objs;let f;for(;;){if(S!==void 0&&R===S.nextBreakPoint)return S.breakIt(R,g),R;if(f=D[R],f!==_.OPS.dependency)this[f].apply(this,T[R]);else for(const k of T[R]){const O=k.startsWith("g_")?o:b;if(!O.has(k))return O.get(k,g),R}if(R++,R===L)return R;if(j&&++$>10){if(Date.now()>B)return g(),R;$=0}}}endDrawing(){it(this,U,ae).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const n of this._cachedBitmapsMap.values()){for(const a of n.values())typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement&&(a.width=a.height=0);n.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(n,a){const g=n.width,S=n.height;let T,D,R=Math.max(Math.hypot(a[0],a[1]),1),L=Math.max(Math.hypot(a[2],a[3]),1),j=g,B=S,$="prescale1";for(;R>2&&j>1||L>2&&B>1;){let o=j,b=B;R>2&&j>1&&(o=Math.ceil(j/2),R/=j/o),L>2&&B>1&&(b=Math.ceil(B/2),L/=B/b),T=this.cachedCanvases.getCanvas($,o,b,!1),D=T.context,D.clearRect(0,0,o,b),D.drawImage(n,0,0,j,B,0,0,o,b),n=T.canvas,j=o,B=b,$=$==="prescale1"?"prescale2":"prescale1"}return{img:n,paintWidth:j,paintHeight:B}}_createMaskCanvas(n){const a=this.ctx,{width:g,height:S}=n,T=this.current.fillColor,D=this.current.patternFill,R=a.mozCurrentTransform;let L,j,B,$;if((n.bitmap||n.data)&&n.count>1){const nt=n.bitmap||n.data.buffer,ct=R.slice(0,4);j=JSON.stringify(D?ct:[ct,T]),L=this._cachedBitmapsMap.get(nt),L||(L=new Map,this._cachedBitmapsMap.set(nt,L));const ot=L.get(j);if(ot&&!D)return{canvas:ot,offsetX:Math.round(Math.min(R[0],R[2])+R[4]),offsetY:Math.round(Math.min(R[1],R[3])+R[5])};B=ot}B||($=this.cachedCanvases.getCanvas("maskCanvas",g,S,!1),i($.context,n));let o=_.Util.transform(R,[1/g,0,0,-1/S,0,0]);o=_.Util.transform(o,[1,0,0,1,0,-S]);const b=_.Util.applyTransform([0,0],o),f=_.Util.applyTransform([g,S],o),k=_.Util.normalizeRect([b[0],b[1],f[0],f[1]]),O=Math.round(k[2]-k[0])||1,G=Math.round(k[3]-k[1])||1,X=this.cachedCanvases.getCanvas("fillCanvas",O,G,!0),Q=X.context,Z=Math.min(b[0],f[0]),rt=Math.min(b[1],f[1]);Q.translate(-Z,-rt),Q.transform.apply(Q,o),B||(B=this._scaleImage($.canvas,Q.mozCurrentTransformInverse),B=B.img,L&&D&&L.set(j,B)),Q.imageSmoothingEnabled=l(Q.mozCurrentTransform,n.interpolate),E(Q,B,0,0,B.width,B.height,0,0,g,S),Q.globalCompositeOperation="source-in";const H=_.Util.transform(Q.mozCurrentTransformInverse,[1,0,0,1,-Z,-rt]);return Q.fillStyle=D?T.getPattern(a,this,H,q.PathType.FILL):T,Q.fillRect(0,0,g,S),L&&!D&&(this.cachedCanvases.delete("fillCanvas"),L.set(j,X.canvas)),{canvas:X.canvas,offsetX:Math.round(Z),offsetY:Math.round(rt)}}setLineWidth(n){n!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=n,this.ctx.lineWidth=n}setLineCap(n){this.ctx.lineCap=p[n]}setLineJoin(n){this.ctx.lineJoin=x[n]}setMiterLimit(n){this.ctx.miterLimit=n}setDash(n,a){const g=this.ctx;g.setLineDash!==void 0&&(g.setLineDash(n),g.lineDashOffset=a)}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(let a=0,g=n.length;a<g;a++){const S=n[a],T=S[0],D=S[1];switch(T){case"LW":this.setLineWidth(D);break;case"LC":this.setLineCap(D);break;case"LJ":this.setLineJoin(D);break;case"ML":this.setMiterLimit(D);break;case"D":this.setDash(D[0],D[1]);break;case"RI":this.setRenderingIntent(D);break;case"FL":this.setFlatness(D);break;case"Font":this.setFont(D[0],D[1]);break;case"CA":this.current.strokeAlpha=S[1];break;case"ca":this.current.fillAlpha=S[1],this.ctx.globalAlpha=S[1];break;case"BM":this.ctx.globalCompositeOperation=D;break;case"SMask":this.current.activeSMask=D?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=D}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const n=this.inSMaskMode;this.current.activeSMask&&!n?this.beginSMaskMode():!this.current.activeSMask&&n&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const n=this.ctx.canvas.width,a=this.ctx.canvas.height,g="smaskGroupAt"+this.groupLevel,S=this.cachedCanvases.getCanvas(g,n,a,!0);this.suspendedCtx=this.ctx,this.ctx=S.context;const T=this.ctx;T.setTransform.apply(T,this.suspendedCtx.mozCurrentTransform),t(this.suspendedCtx,T),function(R,L){if(R._removeMirroring)throw new Error("Context is already forwarding operations.");R.__originalSave=R.save,R.__originalRestore=R.restore,R.__originalRotate=R.rotate,R.__originalScale=R.scale,R.__originalTranslate=R.translate,R.__originalTransform=R.transform,R.__originalSetTransform=R.setTransform,R.__originalResetTransform=R.resetTransform,R.__originalClip=R.clip,R.__originalMoveTo=R.moveTo,R.__originalLineTo=R.lineTo,R.__originalBezierCurveTo=R.bezierCurveTo,R.__originalRect=R.rect,R.__originalClosePath=R.closePath,R.__originalBeginPath=R.beginPath,R._removeMirroring=()=>{R.save=R.__originalSave,R.restore=R.__originalRestore,R.rotate=R.__originalRotate,R.scale=R.__originalScale,R.translate=R.__originalTranslate,R.transform=R.__originalTransform,R.setTransform=R.__originalSetTransform,R.resetTransform=R.__originalResetTransform,R.clip=R.__originalClip,R.moveTo=R.__originalMoveTo,R.lineTo=R.__originalLineTo,R.bezierCurveTo=R.__originalBezierCurveTo,R.rect=R.__originalRect,R.closePath=R.__originalClosePath,R.beginPath=R.__originalBeginPath,delete R._removeMirroring},R.save=function(){L.save(),this.__originalSave()},R.restore=function(){L.restore(),this.__originalRestore()},R.translate=function(B,$){L.translate(B,$),this.__originalTranslate(B,$)},R.scale=function(B,$){L.scale(B,$),this.__originalScale(B,$)},R.transform=function(B,$,o,b,f,k){L.transform(B,$,o,b,f,k),this.__originalTransform(B,$,o,b,f,k)},R.setTransform=function(B,$,o,b,f,k){L.setTransform(B,$,o,b,f,k),this.__originalSetTransform(B,$,o,b,f,k)},R.resetTransform=function(){L.resetTransform(),this.__originalResetTransform()},R.rotate=function(B){L.rotate(B),this.__originalRotate(B)},R.clip=function(B){L.clip(B),this.__originalClip(B)},R.moveTo=function(j,B){L.moveTo(j,B),this.__originalMoveTo(j,B)},R.lineTo=function(j,B){L.lineTo(j,B),this.__originalLineTo(j,B)},R.bezierCurveTo=function(j,B,$,o,b,f){L.bezierCurveTo(j,B,$,o,b,f),this.__originalBezierCurveTo(j,B,$,o,b,f)},R.rect=function(j,B,$,o){L.rect(j,B,$,o),this.__originalRect(j,B,$,o)},R.closePath=function(){L.closePath(),this.__originalClosePath()},R.beginPath=function(){L.beginPath(),this.__originalBeginPath()}}(T,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),t(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(n){if(!this.current.activeSMask)return;n?(n[0]=Math.floor(n[0]),n[1]=Math.floor(n[1]),n[2]=Math.ceil(n[2]),n[3]=Math.ceil(n[3])):n=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const a=this.current.activeSMask;s(this.suspendedCtx,a,this.ctx,n),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(t(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const n=this.current;this.stateStack.push(n),this.current=n.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),t(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(n,a,g,S,T,D){this.ctx.transform(n,a,g,S,T,D),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(n,a,g){const S=this.ctx,T=this.current;let D,R,L=T.x,j=T.y;const B=S.mozCurrentTransform,$=B[0]===0&&B[3]===0||B[1]===0&&B[2]===0,o=$?g.slice(0):null;for(let b=0,f=0,k=n.length;b<k;b++)switch(0|n[b]){case _.OPS.rectangle:L=a[f++],j=a[f++];const O=a[f++],G=a[f++],X=L+O,Q=j+G;S.moveTo(L,j),O===0||G===0?S.lineTo(X,Q):(S.lineTo(X,j),S.lineTo(X,Q),S.lineTo(L,Q)),$||T.updateRectMinMax(B,[L,j,X,Q]),S.closePath();break;case _.OPS.moveTo:L=a[f++],j=a[f++],S.moveTo(L,j),$||T.updatePathMinMax(B,L,j);break;case _.OPS.lineTo:L=a[f++],j=a[f++],S.lineTo(L,j),$||T.updatePathMinMax(B,L,j);break;case _.OPS.curveTo:D=L,R=j,L=a[f+4],j=a[f+5],S.bezierCurveTo(a[f],a[f+1],a[f+2],a[f+3],L,j),T.updateCurvePathMinMax(B,D,R,a[f],a[f+1],a[f+2],a[f+3],L,j,o),f+=6;break;case _.OPS.curveTo2:D=L,R=j,S.bezierCurveTo(L,j,a[f],a[f+1],a[f+2],a[f+3]),T.updateCurvePathMinMax(B,D,R,L,j,a[f],a[f+1],a[f+2],a[f+3],o),L=a[f+2],j=a[f+3],f+=4;break;case _.OPS.curveTo3:D=L,R=j,L=a[f+2],j=a[f+3],S.bezierCurveTo(a[f],a[f+1],L,j,L,j),T.updateCurvePathMinMax(B,D,R,a[f],a[f+1],L,j,L,j,o),f+=4;break;case _.OPS.closePath:S.closePath()}$&&T.updateScalingPathMinMax(B,o),T.setCurrentPoint(L,j)}closePath(){this.ctx.closePath()}stroke(n){n=n===void 0||n;const a=this.ctx,g=this.current.strokeColor;a.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof g=="object"&&(g==null?void 0:g.getPattern)?(a.save(),a.strokeStyle=g.getPattern(a,this,a.mozCurrentTransformInverse,q.PathType.STROKE),this.rescaleAndStroke(!1),a.restore()):this.rescaleAndStroke(!0)),n&&this.consumePath(this.current.getClippedPathBoundingBox()),a.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(n){n=n===void 0||n;const a=this.ctx,g=this.current.fillColor;let S=!1;this.current.patternFill&&(a.save(),a.fillStyle=g.getPattern(a,this,a.mozCurrentTransformInverse,q.PathType.FILL),S=!0);const T=this.current.getClippedPathBoundingBox();this.contentVisible&&T!==null&&(this.pendingEOFill?(a.fill("evenodd"),this.pendingEOFill=!1):a.fill()),S&&a.restore(),n&&this.consumePath(T)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=w}eoClip(){this.pendingClip=F}beginText(){this.current.textMatrix=_.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const n=this.pendingTextPaths,a=this.ctx;if(n!==void 0){a.save(),a.beginPath();for(const g of n)a.setTransform.apply(a,g.transform),a.translate(g.x,g.y),g.addToPath(a,g.fontSize);a.restore(),a.clip(),a.beginPath(),delete this.pendingTextPaths}else a.beginPath()}setCharSpacing(n){this.current.charSpacing=n}setWordSpacing(n){this.current.wordSpacing=n}setHScale(n){this.current.textHScale=n/100}setLeading(n){this.current.leading=-n}setFont(n,a){const g=this.commonObjs.get(n),S=this.current;if(!g)throw new Error(`Can't find font for ${n}`);if(S.fontMatrix=g.fontMatrix||_.FONT_IDENTITY_MATRIX,S.fontMatrix[0]!==0&&S.fontMatrix[3]!==0||(0,_.warn)("Invalid font matrix for font "+n),a<0?(a=-a,S.fontDirection=-1):S.fontDirection=1,this.current.font=g,this.current.fontSize=a,g.isType3Font)return;const T=g.loadedName||"sans-serif";let D="normal";g.black?D="900":g.bold&&(D="bold");const R=g.italic?"italic":"normal",L=`"${T}", ${g.fallbackName}`;let j=a;a<16?j=16:a>100&&(j=100),this.current.fontSizeScale=a/j,this.ctx.font=`${R} ${D} ${j}px ${L}`}setTextRenderingMode(n){this.current.textRenderingMode=n}setTextRise(n){this.current.textRise=n}moveText(n,a){this.current.x=this.current.lineX+=n,this.current.y=this.current.lineY+=a}setLeadingMoveText(n,a){this.setLeading(-a),this.moveText(n,a)}setTextMatrix(n,a,g,S,T,D){this.current.textMatrix=[n,a,g,S,T,D],this.current.textMatrixScale=Math.hypot(n,a),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(n,a,g,S){const T=this.ctx,D=this.current,R=D.font,L=D.textRenderingMode,j=D.fontSize/D.fontSizeScale,B=L&_.TextRenderingMode.FILL_STROKE_MASK,$=!!(L&_.TextRenderingMode.ADD_TO_PATH_FLAG),o=D.patternFill&&!R.missingFile;let b;(R.disableFontFace||$||o)&&(b=R.getPathGenerator(this.commonObjs,n)),R.disableFontFace||o?(T.save(),T.translate(a,g),T.beginPath(),b(T,j),S&&T.setTransform.apply(T,S),B!==_.TextRenderingMode.FILL&&B!==_.TextRenderingMode.FILL_STROKE||T.fill(),B!==_.TextRenderingMode.STROKE&&B!==_.TextRenderingMode.FILL_STROKE||T.stroke(),T.restore()):(B!==_.TextRenderingMode.FILL&&B!==_.TextRenderingMode.FILL_STROKE||T.fillText(n,a,g),B!==_.TextRenderingMode.STROKE&&B!==_.TextRenderingMode.FILL_STROKE||T.strokeText(n,a,g)),$&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:T.mozCurrentTransform,x:a,y:g,fontSize:j,addToPath:b})}get isFontSubpixelAAEnabled(){const{context:n}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10,!1);n.scale(1.5,1),n.fillText("I",0,10);const a=n.getImageData(0,0,10,10).data;let g=!1;for(let S=3;S<a.length;S+=4)if(a[S]>0&&a[S]<255){g=!0;break}return(0,_.shadow)(this,"isFontSubpixelAAEnabled",g)}showText(n){const a=this.current,g=a.font;if(g.isType3Font)return this.showType3Text(n);const S=a.fontSize;if(S===0)return;const T=this.ctx,D=a.fontSizeScale,R=a.charSpacing,L=a.wordSpacing,j=a.fontDirection,B=a.textHScale*j,$=n.length,o=g.vertical,b=o?1:-1,f=g.defaultVMetrics,k=S*a.fontMatrix[0],O=a.textRenderingMode===_.TextRenderingMode.FILL&&!g.disableFontFace&&!a.patternFill;T.save(),T.transform.apply(T,a.textMatrix),T.translate(a.x,a.y+a.textRise),j>0?T.scale(B,-1):T.scale(B,1);let G;if(a.patternFill){T.save();const H=a.fillColor.getPattern(T,this,T.mozCurrentTransformInverse,q.PathType.FILL);G=T.mozCurrentTransform,T.restore(),T.fillStyle=H}let X=a.lineWidth;const Q=a.textMatrixScale;if(Q===0||X===0){const H=a.textRenderingMode&_.TextRenderingMode.FILL_STROKE_MASK;H!==_.TextRenderingMode.STROKE&&H!==_.TextRenderingMode.FILL_STROKE||(X=this.getSinglePixelWidth())}else X/=Q;D!==1&&(T.scale(D,D),X/=D),T.lineWidth=X;let Z,rt=0;for(Z=0;Z<$;++Z){const H=n[Z];if(typeof H=="number"){rt+=b*H*S/1e3;continue}let nt=!1;const ct=(H.isSpace?L:0)+R,ot=H.fontChar,dt=H.accent;let ft,z,ht,pt=H.width;if(o){const vt=H.vmetric||f,bt=-(H.vmetric?vt[1]:.5*pt)*k,Nt=vt[2]*k;pt=vt?-vt[0]:pt,ft=bt/D,z=(rt+Nt)/D}else ft=rt/D,z=0;if(g.remeasure&&pt>0){const vt=1e3*T.measureText(ot).width/S*D;if(pt<vt&&this.isFontSubpixelAAEnabled){const bt=pt/vt;nt=!0,T.save(),T.scale(bt,1),ft/=bt}else pt!==vt&&(ft+=(pt-vt)/2e3*S/D)}if(this.contentVisible&&(H.isInFont||g.missingFile)){if(O&&!dt)T.fillText(ot,ft,z);else if(this.paintChar(ot,ft,z,G),dt){const vt=ft+S*dt.offset.x/D,bt=z-S*dt.offset.y/D;this.paintChar(dt.fontChar,vt,bt,G)}}ht=o?pt*k-ct*j:pt*k+ct*j,rt+=ht,nt&&T.restore()}o?a.y-=rt:a.x+=rt*B,T.restore(),this.compose()}showType3Text(n){const a=this.ctx,g=this.current,S=g.font,T=g.fontSize,D=g.fontDirection,R=S.vertical?1:-1,L=g.charSpacing,j=g.wordSpacing,B=g.textHScale*D,$=g.fontMatrix||_.FONT_IDENTITY_MATRIX,o=n.length;let b,f,k,O;if(g.textRenderingMode!==_.TextRenderingMode.INVISIBLE&&T!==0){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,a.save(),a.transform.apply(a,g.textMatrix),a.translate(g.x,g.y),a.scale(B,D),b=0;b<o;++b){if(f=n[b],typeof f=="number"){O=R*f*T/1e3,this.ctx.translate(O,0),g.x+=O*B;continue}const G=(f.isSpace?j:0)+L,X=S.charProcOperatorList[f.operatorListId];if(!X){(0,_.warn)(`Type3 character "${f.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=f,this.save(),a.scale(T,T),a.transform.apply(a,$),this.executeOperatorList(X),this.restore()),k=_.Util.applyTransform([f.width,0],$)[0]*T+G,a.translate(k,0),g.x+=k*B}a.restore(),this.processingType3=null}}setCharWidth(n,a){}setCharWidthAndBounds(n,a,g,S,T,D){this.ctx.rect(g,S,T-g,D-S),this.ctx.clip(),this.endPath()}getColorN_Pattern(n){let a;if(n[0]==="TilingPattern"){const g=n[1],S=this.baseTransform||this.ctx.mozCurrentTransform.slice(),T={createCanvasGraphics:D=>new V(D,this.commonObjs,this.objs,this.canvasFactory)};a=new q.TilingPattern(n,g,this.ctx,T,S)}else a=this._getPattern(n[1],n[2]);return a}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(n,a,g){var T;const S=((T=this.selectColor)==null?void 0:T.call(this,n,a,g))||_.Util.makeHexColor(n,a,g);this.ctx.strokeStyle=S,this.current.strokeColor=S}setFillRGBColor(n,a,g){var T;const S=((T=this.selectColor)==null?void 0:T.call(this,n,a,g))||_.Util.makeHexColor(n,a,g);this.ctx.fillStyle=S,this.current.fillColor=S,this.current.patternFill=!1}_getPattern(n,a=null){let g;return this.cachedPatterns.has(n)?g=this.cachedPatterns.get(n):(g=(0,q.getShadingPattern)(this.objs.get(n)),this.cachedPatterns.set(n,g)),a&&(g.matrix=a),g}shadingFill(n){if(!this.contentVisible)return;const a=this.ctx;this.save();const g=this._getPattern(n);a.fillStyle=g.getPattern(a,this,a.mozCurrentTransformInverse,q.PathType.SHADING);const S=a.mozCurrentTransformInverse;if(S){const T=a.canvas,D=T.width,R=T.height,L=_.Util.applyTransform([0,0],S),j=_.Util.applyTransform([0,R],S),B=_.Util.applyTransform([D,0],S),$=_.Util.applyTransform([D,R],S),o=Math.min(L[0],j[0],B[0],$[0]),b=Math.min(L[1],j[1],B[1],$[1]),f=Math.max(L[0],j[0],B[0],$[0]),k=Math.max(L[1],j[1],B[1],$[1]);this.ctx.fillRect(o,b,f-o,k-b)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,_.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,_.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(n,a){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(n)&&n.length===6&&this.transform.apply(this,n),this.baseTransform=this.ctx.mozCurrentTransform,a)){const g=a[2]-a[0],S=a[3]-a[1];this.ctx.rect(a[0],a[1],g,S),this.current.updateRectMinMax(this.ctx.mozCurrentTransform,a),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(n){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const a=this.ctx;n.isolated||(0,_.info)("TODO: Support non-isolated groups."),n.knockout&&(0,_.warn)("Knockout groups not supported.");const g=a.mozCurrentTransform;if(n.matrix&&a.transform.apply(a,n.matrix),!n.bbox)throw new Error("Bounding box is required.");let S=_.Util.getAxialAlignedBoundingBox(n.bbox,a.mozCurrentTransform);const T=[0,0,a.canvas.width,a.canvas.height];S=_.Util.intersect(S,T)||[0,0,0,0];const D=Math.floor(S[0]),R=Math.floor(S[1]);let L=Math.max(Math.ceil(S[2])-D,1),j=Math.max(Math.ceil(S[3])-R,1),B=1,$=1;L>u&&(B=L/u,L=u),j>u&&($=j/u,j=u),this.current.startNewPathAndClipBox([0,0,L,j]);let o="groupAt"+this.groupLevel;n.smask&&(o+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(o,L,j,!0),f=b.context;f.scale(1/B,1/$),f.translate(-D,-R),f.transform.apply(f,g),n.smask?this.smaskStack.push({canvas:b.canvas,context:f,offsetX:D,offsetY:R,scaleX:B,scaleY:$,subtype:n.smask.subtype,backdrop:n.smask.backdrop,transferMap:n.smask.transferMap||null,startTransformInverse:null}):(a.setTransform(1,0,0,1,0,0),a.translate(D,R),a.scale(B,$),a.save()),t(a,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(a),this.groupLevel++}endGroup(n){if(!this.contentVisible)return;this.groupLevel--;const a=this.ctx,g=this.groupStack.pop();if(this.ctx=g,this.ctx.imageSmoothingEnabled=!1,n.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const S=this.ctx.mozCurrentTransform;this.restore(),this.ctx.save(),this.ctx.setTransform.apply(this.ctx,S);const T=_.Util.getAxialAlignedBoundingBox([0,0,a.canvas.width,a.canvas.height],S);this.ctx.drawImage(a.canvas,0,0),this.ctx.restore(),this.compose(T)}}beginAnnotation(n,a,g,S,T){if(it(this,U,ae).call(this),e(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform),Array.isArray(a)&&a.length===4){const D=a[2]-a[0],R=a[3]-a[1];if(T&&this.annotationCanvasMap){(g=g.slice())[4]-=a[0],g[5]-=a[1],(a=a.slice())[0]=a[1]=0,a[2]=D,a[3]=R;const[L,j]=_.Util.singularValueDecompose2dScale(this.ctx.mozCurrentTransform),{viewportScale:B}=this,$=Math.ceil(D*this.outputScaleX*B),o=Math.ceil(R*this.outputScaleY*B);this.annotationCanvas=this.canvasFactory.create($,o);const{canvas:b,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(n,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,v(this.ctx),this.ctx.setTransform(L,0,0,-j,0,R*j),e(this.ctx,this.foregroundColor)}else e(this.ctx,this.foregroundColor),this.ctx.rect(a[0],a[1],D,R),this.ctx.clip(),this.endPath()}this.current=new W(this.ctx.canvas.width,this.ctx.canvas.height),this.transform.apply(this,g),this.transform.apply(this,S)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(n){if(!this.contentVisible)return;const a=n.count;(n=this.getObject(n.data,n)).count=a;const g=this.ctx,S=this.processingType3;if(S&&(S.compiled===void 0&&(S.compiled=function(L){const{width:j,height:B}=L;if(j>1e3||B>1e3)return null;const $=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),o=j+1;let b,f,k,O=new Uint8Array(o*(B+1));const G=j+7&-8;let X=new Uint8Array(G*B),Q=0;for(const ot of L.data){let dt=128;for(;dt>0;)X[Q++]=ot&dt?0:255,dt>>=1}let Z=0;for(Q=0,X[Q]!==0&&(O[0]=1,++Z),f=1;f<j;f++)X[Q]!==X[Q+1]&&(O[f]=X[Q]?2:1,++Z),Q++;for(X[Q]!==0&&(O[f]=2,++Z),b=1;b<B;b++){Q=b*G,k=b*o,X[Q-G]!==X[Q]&&(O[k]=X[Q]?1:8,++Z);let ot=(X[Q]?4:0)+(X[Q-G]?8:0);for(f=1;f<j;f++)ot=(ot>>2)+(X[Q+1]?4:0)+(X[Q-G+1]?8:0),$[ot]&&(O[k+f]=$[ot],++Z),Q++;if(X[Q-G]!==X[Q]&&(O[k+f]=X[Q]?2:4,++Z),Z>1e3)return null}for(Q=G*(B-1),k=b*o,X[Q]!==0&&(O[k]=8,++Z),f=1;f<j;f++)X[Q]!==X[Q+1]&&(O[k+f]=X[Q]?4:8,++Z),Q++;if(X[Q]!==0&&(O[k+f]=4,++Z),Z>1e3)return null;const rt=new Int32Array([0,o,-1,0,-o,0,0,0,1]);let H,nt,ct;for(N.isNodeJS?nt=[]:H=new Path2D,b=0;Z&&b<=B;b++){let ot=b*o;const dt=ot+j;for(;ot<dt&&!O[ot];)ot++;if(ot===dt)continue;H?H.moveTo(ot%o,b):ct=[ot%o,b];const ft=ot;let z=O[ot];do{const ht=rt[z];do ot+=ht;while(!O[ot]);const pt=O[ot];pt!==5&&pt!==10?(z=pt,O[ot]=0):(z=pt&51*z>>4,O[ot]&=z>>2|z<<2),H?H.lineTo(ot%o,ot/o|0):ct.push(ot%o,ot/o|0),O[ot]||--Z}while(ft!==ot);H||nt.push(ct),--b}return X=null,O=null,function(ot){if(ot.save(),ot.scale(1/j,-1/B),ot.translate(0,-B),H)ot.fill(H);else{ot.beginPath();for(const dt of nt){ot.moveTo(dt[0],dt[1]);for(let ft=2,z=dt.length;ft<z;ft+=2)ot.lineTo(dt[ft],dt[ft+1])}ot.fill()}ot.beginPath(),ot.restore()}}(n)),S.compiled)){S.compiled(g);return}const T=this._createMaskCanvas(n),D=T.canvas;g.save(),g.setTransform(1,0,0,1,0,0),g.drawImage(D,T.offsetX,T.offsetY),g.restore(),this.compose()}paintImageMaskXObjectRepeat(n,a,g=0,S=0,T,D){if(!this.contentVisible)return;n=this.getObject(n.data,n);const R=this.ctx;R.save();const L=R.mozCurrentTransform;R.transform(a,g,S,T,0,0);const j=this._createMaskCanvas(n);R.setTransform(1,0,0,1,0,0);for(let B=0,$=D.length;B<$;B+=2){const o=_.Util.transform(L,[a,g,S,T,D[B],D[B+1]]),[b,f]=_.Util.applyTransform([0,0],o);R.drawImage(j.canvas,b,f)}R.restore(),this.compose()}paintImageMaskXObjectGroup(n){if(!this.contentVisible)return;const a=this.ctx,g=this.current.fillColor,S=this.current.patternFill;for(const T of n){const{data:D,width:R,height:L,transform:j}=T,B=this.cachedCanvases.getCanvas("maskCanvas",R,L,!1),$=B.context;$.save(),i($,this.getObject(D,T)),$.globalCompositeOperation="source-in",$.fillStyle=S?g.getPattern($,this,a.mozCurrentTransformInverse,q.PathType.FILL):g,$.fillRect(0,0,R,L),$.restore(),a.save(),a.transform.apply(a,j),a.scale(1,-1),E(a,B.canvas,0,0,R,L,0,-1,1,1),a.restore()}this.compose()}paintImageXObject(n){if(!this.contentVisible)return;const a=this.getObject(n);a?this.paintInlineImageXObject(a):(0,_.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(n,a,g,S){if(!this.contentVisible)return;const T=this.getObject(n);if(!T){(0,_.warn)("Dependent image isn't ready yet");return}const D=T.width,R=T.height,L=[];for(let j=0,B=S.length;j<B;j+=2)L.push({transform:[a,0,0,g,S[j],S[j+1]],x:0,y:0,w:D,h:R});this.paintInlineImageXObjectGroup(T,L)}paintInlineImageXObject(n){if(!this.contentVisible)return;const a=n.width,g=n.height,S=this.ctx;this.save(),S.scale(1/a,-1/g);let T;if(typeof HTMLElement=="function"&&n instanceof HTMLElement||!n.data)T=n;else{const j=this.cachedCanvases.getCanvas("inlineImage",a,g,!1);m(j.context,n,this.current.transferMaps),T=j.canvas}const D=this._scaleImage(T,S.mozCurrentTransformInverse);S.imageSmoothingEnabled=l(S.mozCurrentTransform,n.interpolate);const[R,L]=E(S,D.img,0,0,D.paintWidth,D.paintHeight,0,-g,a,g);if(this.imageLayer){const j=this.getCanvasPosition(0,-g);this.imageLayer.appendImage({imgData:n,left:j[0],top:j[1],width:R,height:L})}this.compose(),this.restore()}paintInlineImageXObjectGroup(n,a){if(!this.contentVisible)return;const g=this.ctx,S=n.width,T=n.height,D=this.cachedCanvases.getCanvas("inlineImage",S,T,!1);m(D.context,n,this.current.transferMaps);for(let R=0,L=a.length;R<L;R++){const j=a[R];if(g.save(),g.transform.apply(g,j.transform),g.scale(1,-1),E(g,D.canvas,j.x,j.y,j.w,j.h,0,-1,1,1),this.imageLayer){const B=this.getCanvasPosition(j.x,j.y);this.imageLayer.appendImage({imgData:n,left:B[0],top:B[1],width:S,height:T})}g.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(n){}markPointProps(n,a){}beginMarkedContent(n){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(n,a){n==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(a)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(n){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const g=this.ctx;this.pendingClip&&(a||(this.pendingClip===F?g.clip("evenodd"):g.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),g.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const n=this.ctx.mozCurrentTransform;if(n[1]===0&&n[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(n[0]),Math.abs(n[3]));else{const a=Math.abs(n[0]*n[3]-n[2]*n[1]),g=Math.hypot(n[0],n[2]),S=Math.hypot(n[1],n[3]);this._cachedGetSinglePixelWidth=Math.max(g,S)/a}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:n}=this.current,a=this.ctx.mozCurrentTransform;let g,S;if(a[1]===0&&a[2]===0){const T=Math.abs(a[0]),D=Math.abs(a[3]);if(n===0)g=1/T,S=1/D;else{const R=T*n,L=D*n;g=R<1?1/R:1,S=L<1?1/L:1}}else{const T=Math.abs(a[0]*a[3]-a[2]*a[1]),D=Math.hypot(a[0],a[1]),R=Math.hypot(a[2],a[3]);if(n===0)g=R/T,S=D/T;else{const L=n*T;g=R>L?R/L:1,S=D>L?D/L:1}}this._cachedScaleForStroking=[g,S]}return this._cachedScaleForStroking}rescaleAndStroke(n){const{ctx:a}=this,{lineWidth:g}=this.current,[S,T]=this.getScaleForStroking();if(a.lineWidth=g||1,S===1&&T===1){a.stroke();return}let D,R,L;n&&(D=a.mozCurrentTransform.slice(),R=a.getLineDash().slice(),L=a.lineDashOffset),a.scale(S,T);const j=Math.max(S,T);a.setLineDash(a.getLineDash().map(B=>B/j)),a.lineDashOffset/=j,a.stroke(),n&&(a.setTransform(...D),a.setLineDash(R),a.lineDashOffset=L)}getCanvasPosition(n,a){const g=this.ctx.mozCurrentTransform;return[g[0]*n+g[2]*a+g[4],g[1]*n+g[3]*a+g[5]]}isContentVisible(){for(let n=this.markedContentStack.length-1;n>=0;n--)if(!this.markedContentStack[n].visible)return!1;return!0}};let P=V;U=new WeakSet,ae=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},A.CanvasGraphics=P;for(const I in _.OPS)P.prototype[I]!==void 0&&(P.prototype[_.OPS[I]]=P.prototype[I])},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.TilingPattern=A.PathType=void 0,A.getShadingPattern=function(e){switch(e[0]){case"RadialAxial":return new u(e);case"Mesh":return new y(e);case"Dummy":return new E}throw new Error(`Unknown IR type: ${e[0]}`)};var _=Y(1),M=Y(3);const q={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};A.PathType=q;function K(t,e){if(!e||M.isNodeJS)return;const r=e[2]-e[0],c=e[3]-e[1],h=new Path2D;h.rect(e[0],e[1],r,c),t.clip(h)}class N{constructor(){this.constructor===N&&(0,_.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,_.unreachable)("Abstract method `getPattern` called.")}}class u extends N{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let r;this._type==="axial"?r=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(r=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const c of this._colorStops)r.addColorStop(c[0],c[1]);return r}getPattern(e,r,c,h){let s;if(h===q.STROKE||h===q.FILL){const l=r.current.getClippedPathBoundingBox(h,e.mozCurrentTransform)||[0,0,0,0],p=Math.ceil(l[2]-l[0])||1,x=Math.ceil(l[3]-l[1])||1,w=r.cachedCanvases.getCanvas("pattern",p,x,!0),F=w.context;F.clearRect(0,0,F.canvas.width,F.canvas.height),F.beginPath(),F.rect(0,0,F.canvas.width,F.canvas.height),F.translate(-l[0],-l[1]),c=_.Util.transform(c,[1,0,0,1,l[0],l[1]]),F.transform.apply(F,r.baseTransform),this.matrix&&F.transform.apply(F,this.matrix),K(F,this._bbox),F.fillStyle=this._createGradient(F),F.fill(),s=e.createPattern(w.canvas,"no-repeat");const P=new DOMMatrix(c);try{s.setTransform(P)}catch(U){(0,_.warn)(`RadialAxialShadingPattern.getPattern: "${U==null?void 0:U.message}".`)}}else K(e,this._bbox),s=this._createGradient(e);return s}}function d(t,e,r,c,h,s,l,p){const x=e.coords,w=e.colors,F=t.data,P=4*t.width;let U;x[r+1]>x[c+1]&&(U=r,r=c,c=U,U=s,s=l,l=U),x[c+1]>x[h+1]&&(U=c,c=h,h=U,U=l,l=p,p=U),x[r+1]>x[c+1]&&(U=r,r=c,c=U,U=s,s=l,l=U);const J=(x[r]+e.offsetX)*e.scaleX,V=(x[r+1]+e.offsetY)*e.scaleY,I=(x[c]+e.offsetX)*e.scaleX,n=(x[c+1]+e.offsetY)*e.scaleY,a=(x[h]+e.offsetX)*e.scaleX,g=(x[h+1]+e.offsetY)*e.scaleY;if(V>=g)return;const S=w[s],T=w[s+1],D=w[s+2],R=w[l],L=w[l+1],j=w[l+2],B=w[p],$=w[p+1],o=w[p+2],b=Math.round(V),f=Math.round(g);let k,O,G,X,Q,Z,rt,H;for(let nt=b;nt<=f;nt++){if(nt<n){let z;z=nt<V?0:(V-nt)/(V-n),k=J-(J-I)*z,O=S-(S-R)*z,G=T-(T-L)*z,X=D-(D-j)*z}else{let z;z=nt>g?1:n===g?0:(n-nt)/(n-g),k=I-(I-a)*z,O=R-(R-B)*z,G=L-(L-$)*z,X=j-(j-o)*z}let ct;ct=nt<V?0:nt>g?1:(V-nt)/(V-g),Q=J-(J-a)*ct,Z=S-(S-B)*ct,rt=T-(T-$)*ct,H=D-(D-o)*ct;const ot=Math.round(Math.min(k,Q)),dt=Math.round(Math.max(k,Q));let ft=P*nt+4*ot;for(let z=ot;z<=dt;z++)ct=(k-z)/(k-Q),ct<0?ct=0:ct>1&&(ct=1),F[ft++]=O-(O-Z)*ct|0,F[ft++]=G-(G-rt)*ct|0,F[ft++]=X-(X-H)*ct|0,F[ft++]=255}}function v(t,e,r){const c=e.coords,h=e.colors;let s,l;switch(e.type){case"lattice":const p=e.verticesPerRow,x=Math.floor(c.length/p)-1,w=p-1;for(s=0;s<x;s++){let F=s*p;for(let P=0;P<w;P++,F++)d(t,r,c[F],c[F+1],c[F+p],h[F],h[F+1],h[F+p]),d(t,r,c[F+p+1],c[F+1],c[F+p],h[F+p+1],h[F+1],h[F+p])}break;case"triangles":for(s=0,l=c.length;s<l;s+=3)d(t,r,c[s],c[s+1],c[s+2],h[s],h[s+1],h[s+2]);break;default:throw new Error("illegal figure")}}class y extends N{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,r,c){const h=Math.floor(this._bounds[0]),s=Math.floor(this._bounds[1]),l=Math.ceil(this._bounds[2])-h,p=Math.ceil(this._bounds[3])-s,x=Math.min(Math.ceil(Math.abs(l*e[0]*1.1)),3e3),w=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),F=l/x,P=p/w,U={coords:this._coords,colors:this._colors,offsetX:-h,offsetY:-s,scaleX:1/F,scaleY:1/P},J=x+4,V=w+4,I=c.getCanvas("mesh",J,V,!1),n=I.context,a=n.createImageData(x,w);if(r){const g=a.data;for(let S=0,T=g.length;S<T;S+=4)g[S]=r[0],g[S+1]=r[1],g[S+2]=r[2],g[S+3]=255}for(const g of this._figures)v(a,g,U);return n.putImageData(a,2,2),{canvas:I.canvas,offsetX:h-2*F,offsetY:s-2*P,scaleX:F,scaleY:P}}getPattern(e,r,c,h){K(e,this._bbox);let s;if(h===q.SHADING)s=_.Util.singularValueDecompose2dScale(e.mozCurrentTransform);else if(s=_.Util.singularValueDecompose2dScale(r.baseTransform),this.matrix){const p=_.Util.singularValueDecompose2dScale(this.matrix);s=[s[0]*p[0],s[1]*p[1]]}const l=this._createMeshCanvas(s,h===q.SHADING?null:this._background,r.cachedCanvases);return h!==q.SHADING&&(e.setTransform.apply(e,r.baseTransform),this.matrix&&e.transform.apply(e,this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class E extends N{getPattern(){return"hotpink"}}const W=1,m=2;class i{static get MAX_PATTERN_SIZE(){return(0,_.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(e,r,c,h,s){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=r,this.ctx=c,this.canvasGraphicsFactory=h,this.baseTransform=s}createPatternCanvas(e){const r=this.operatorList,c=this.bbox,h=this.xstep,s=this.ystep,l=this.paintType,p=this.tilingType,x=this.color,w=this.canvasGraphicsFactory;(0,_.info)("TilingType: "+p);const F=c[0],P=c[1],U=c[2],J=c[3],V=_.Util.singularValueDecompose2dScale(this.matrix),I=_.Util.singularValueDecompose2dScale(this.baseTransform),n=[V[0]*I[0],V[1]*I[1]],a=this.getSizeAndScale(h,this.ctx.canvas.width,n[0]),g=this.getSizeAndScale(s,this.ctx.canvas.height,n[1]),S=e.cachedCanvases.getCanvas("pattern",a.size,g.size,!0),T=S.context,D=w.createCanvasGraphics(T);D.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(D,l,x);let R=F,L=P,j=U,B=J;return F<0&&(R=0,j+=Math.abs(F)),P<0&&(L=0,B+=Math.abs(P)),T.translate(-a.scale*R,-g.scale*L),D.transform(a.scale,0,0,g.scale,0,0),T.save(),this.clipBbox(D,R,L,j,B),D.baseTransform=D.ctx.mozCurrentTransform.slice(),D.executeOperatorList(r),D.endDrawing(),{canvas:S.canvas,scaleX:a.scale,scaleY:g.scale,offsetX:R,offsetY:L}}getSizeAndScale(e,r,c){e=Math.abs(e);const h=Math.max(i.MAX_PATTERN_SIZE,r);let s=Math.ceil(e*c);return s>=h?s=h:c=s/e,{scale:c,size:s}}clipBbox(e,r,c,h,s){const l=h-r,p=s-c;e.ctx.rect(r,c,l,p),e.current.updateRectMinMax(e.ctx.mozCurrentTransform,[r,c,h,s]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,r,c){const h=e.ctx,s=e.current;switch(r){case W:const l=this.ctx;h.fillStyle=l.fillStyle,h.strokeStyle=l.strokeStyle,s.fillColor=l.fillStyle,s.strokeColor=l.strokeStyle;break;case m:const p=_.Util.makeHexColor(c[0],c[1],c[2]);h.fillStyle=p,h.strokeStyle=p,s.fillColor=p,s.strokeColor=p;break;default:throw new _.FormatError(`Unsupported paint type: ${r}`)}}getPattern(e,r,c,h){let s=c;h!==q.SHADING&&(s=_.Util.transform(s,r.baseTransform),this.matrix&&(s=_.Util.transform(s,this.matrix)));const l=this.createPatternCanvas(r);let p=new DOMMatrix(s);p=p.translate(l.offsetX,l.offsetY),p=p.scale(1/l.scaleX,1/l.scaleY);const x=e.createPattern(l.canvas,"repeat");try{x.setTransform(p)}catch(w){(0,_.warn)(`TilingPattern.getPattern: "${w==null?void 0:w.message}".`)}return x}}A.TilingPattern=i},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.applyMaskImageData=function({src:q,srcPos:K=0,dest:N,destPos:u=0,width:d,height:v,inverseDecode:y=!1}){const E=_.FeatureTest.isLittleEndian?4278190080:255,[W,m]=y?[0,E]:[E,0],i=d>>3,t=7&d,e=q.length;N=new Uint32Array(N.buffer);for(let r=0;r<v;r++){for(const h=K+i;K<h;K++){const s=K<e?q[K]:255;N[u++]=128&s?m:W,N[u++]=64&s?m:W,N[u++]=32&s?m:W,N[u++]=16&s?m:W,N[u++]=8&s?m:W,N[u++]=4&s?m:W,N[u++]=2&s?m:W,N[u++]=1&s?m:W}if(t===0)continue;const c=K<e?q[K++]:255;for(let h=0;h<t;h++)N[u++]=c&1<<7-h?m:W}return{srcPos:K,destPos:u}};var _=Y(1)},(st,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.GlobalWorkerOptions=void 0;const Y=Object.create(null);A.GlobalWorkerOptions=Y,Y.workerPort=Y.workerPort===void 0?null:Y.workerPort,Y.workerSrc=Y.workerSrc===void 0?"":Y.workerSrc},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.MessageHandler=void 0;var _=Y(1);const M=1,q=2,K=1,N=2,u=3,d=4,v=5,y=6,E=7,W=8;function m(i){switch(i instanceof Error||typeof i=="object"&&i!==null||(0,_.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new _.AbortException(i.message);case"MissingPDFException":return new _.MissingPDFException(i.message);case"PasswordException":return new _.PasswordException(i.message,i.code);case"UnexpectedResponseException":return new _.UnexpectedResponseException(i.message,i.status);case"UnknownErrorException":return new _.UnknownErrorException(i.message,i.details);default:return new _.UnknownErrorException(i.message,i.toString())}}A.MessageHandler=class{constructor(t,e,r){this.sourceName=t,this.targetName=e,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=c=>{const h=c.data;if(h.targetName!==this.sourceName)return;if(h.stream){this._processStreamMessage(h);return}if(h.callback){const l=h.callbackId,p=this.callbackCapabilities[l];if(!p)throw new Error(`Cannot resolve callback ${l}`);if(delete this.callbackCapabilities[l],h.callback===M)p.resolve(h.data);else{if(h.callback!==q)throw new Error("Unexpected callback case");p.reject(m(h.reason))}return}const s=this.actionHandler[h.action];if(!s)throw new Error(`Unknown action from worker: ${h.action}`);if(h.callbackId){const l=this.sourceName,p=h.sourceName;new Promise(function(x){x(s(h.data))}).then(function(x){r.postMessage({sourceName:l,targetName:p,callback:M,callbackId:h.callbackId,data:x})},function(x){r.postMessage({sourceName:l,targetName:p,callback:q,callbackId:h.callbackId,reason:m(x)})})}else h.streamId?this._createStreamSink(h):s(h.data)},r.addEventListener("message",this._onComObjOnMessage)}on(t,e){const r=this.actionHandler;if(r[t])throw new Error(`There is already an actionName called "${t}"`);r[t]=e}send(t,e,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},r)}sendWithPromise(t,e,r){const c=this.callbackId++,h=(0,_.createPromiseCapability)();this.callbackCapabilities[c]=h;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:c,data:e},r)}catch(s){h.reject(s)}return h.promise}sendWithStream(t,e,r,c){const h=this.streamId++,s=this.sourceName,l=this.targetName,p=this.comObj;return new ReadableStream({start:x=>{const w=(0,_.createPromiseCapability)();return this.streamControllers[h]={controller:x,startCall:w,pullCall:null,cancelCall:null,isClosed:!1},p.postMessage({sourceName:s,targetName:l,action:t,streamId:h,data:e,desiredSize:x.desiredSize},c),w.promise},pull:x=>{const w=(0,_.createPromiseCapability)();return this.streamControllers[h].pullCall=w,p.postMessage({sourceName:s,targetName:l,stream:y,streamId:h,desiredSize:x.desiredSize}),w.promise},cancel:x=>{(0,_.assert)(x instanceof Error,"cancel must have a valid reason");const w=(0,_.createPromiseCapability)();return this.streamControllers[h].cancelCall=w,this.streamControllers[h].isClosed=!0,p.postMessage({sourceName:s,targetName:l,stream:K,streamId:h,reason:m(x)}),w.promise}},r)}_createStreamSink(t){const e=t.streamId,r=this.sourceName,c=t.sourceName,h=this.comObj,s=this,l=this.actionHandler[t.action],p={enqueue(x,w=1,F){if(this.isCancelled)return;const P=this.desiredSize;this.desiredSize-=w,P>0&&this.desiredSize<=0&&(this.sinkCapability=(0,_.createPromiseCapability)(),this.ready=this.sinkCapability.promise),h.postMessage({sourceName:r,targetName:c,stream:d,streamId:e,chunk:x},F)},close(){this.isCancelled||(this.isCancelled=!0,h.postMessage({sourceName:r,targetName:c,stream:u,streamId:e}),delete s.streamSinks[e])},error(x){(0,_.assert)(x instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,h.postMessage({sourceName:r,targetName:c,stream:v,streamId:e,reason:m(x)}))},sinkCapability:(0,_.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};p.sinkCapability.resolve(),p.ready=p.sinkCapability.promise,this.streamSinks[e]=p,new Promise(function(x){x(l(t.data,p))}).then(function(){h.postMessage({sourceName:r,targetName:c,stream:W,streamId:e,success:!0})},function(x){h.postMessage({sourceName:r,targetName:c,stream:W,streamId:e,reason:m(x)})})}_processStreamMessage(t){const e=t.streamId,r=this.sourceName,c=t.sourceName,h=this.comObj,s=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case W:t.success?s.startCall.resolve():s.startCall.reject(m(t.reason));break;case E:t.success?s.pullCall.resolve():s.pullCall.reject(m(t.reason));break;case y:if(!l){h.postMessage({sourceName:r,targetName:c,stream:E,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,new Promise(function(p){p(l.onPull&&l.onPull())}).then(function(){h.postMessage({sourceName:r,targetName:c,stream:E,streamId:e,success:!0})},function(p){h.postMessage({sourceName:r,targetName:c,stream:E,streamId:e,reason:m(p)})});break;case d:if((0,_.assert)(s,"enqueue should have stream controller"),s.isClosed)break;s.controller.enqueue(t.chunk);break;case u:if((0,_.assert)(s,"close should have stream controller"),s.isClosed)break;s.isClosed=!0,s.controller.close(),this._deleteStreamController(s,e);break;case v:(0,_.assert)(s,"error should have stream controller"),s.controller.error(m(t.reason)),this._deleteStreamController(s,e);break;case N:t.success?s.cancelCall.resolve():s.cancelCall.reject(m(t.reason)),this._deleteStreamController(s,e);break;case K:if(!l)break;new Promise(function(p){p(l.onCancel&&l.onCancel(m(t.reason)))}).then(function(){h.postMessage({sourceName:r,targetName:c,stream:N,streamId:e,success:!0})},function(p){h.postMessage({sourceName:r,targetName:c,stream:N,streamId:e,reason:m(p)})}),l.sinkCapability.reject(m(t.reason)),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(t,e){await Promise.allSettled([t.startCall&&t.startCall.promise,t.pullCall&&t.pullCall.promise,t.cancelCall&&t.cancelCall.promise]),delete this.streamControllers[e]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},(st,A,Y)=>{var M,q,K;Object.defineProperty(A,"__esModule",{value:!0}),A.Metadata=void 0;var _=Y(1);A.Metadata=(K=class{constructor({parsedData:u,rawData:d}){tt(this,M,void 0);tt(this,q,void 0);lt(this,M,u),lt(this,q,d)}getRaw(){return C(this,q)}get(u){var d;return(d=C(this,M).get(u))!=null?d:null}getAll(){return(0,_.objectFromMap)(C(this,M))}has(u){return C(this,M).has(u)}},M=new WeakMap,q=new WeakMap,K)},(st,A,Y)=>{var K,N,u,d,v,y,oe,W;Object.defineProperty(A,"__esModule",{value:!0}),A.OptionalContentConfig=void 0;var _=Y(1);const M=Symbol("INTERNAL");class q{constructor(i,t){tt(this,K,!0);this.name=i,this.intent=t}get visible(){return C(this,K)}_setVisible(i,t){i!==M&&(0,_.unreachable)("Internal method `_setVisible` called."),lt(this,K,t)}}K=new WeakMap,A.OptionalContentConfig=(W=class{constructor(i){tt(this,y);tt(this,N,!0);tt(this,u,new Map);tt(this,d,null);tt(this,v,null);if(this.name=null,this.creator=null,i!==null){this.name=i.name,this.creator=i.creator,lt(this,v,i.order);for(const t of i.groups)C(this,u).set(t.id,new q(t.name,t.intent));if(i.baseState==="OFF")for(const t of C(this,u).values())t._setVisible(M,!1);for(const t of i.on)C(this,u).get(t)._setVisible(M,!0);for(const t of i.off)C(this,u).get(t)._setVisible(M,!1);lt(this,d,new Map);for(const[t,e]of C(this,u))C(this,d).set(t,e.visible)}}isVisible(i){if(C(this,u).size===0)return!0;if(!i)return(0,_.warn)("Optional content group not defined."),!0;if(i.type==="OCG")return C(this,u).has(i.id)?C(this,u).get(i.id).visible:((0,_.warn)(`Optional content group not found: ${i.id}`),!0);if(i.type==="OCMD"){if(i.expression)return it(this,y,oe).call(this,i.expression);if(!i.policy||i.policy==="AnyOn"){for(const t of i.ids){if(!C(this,u).has(t))return(0,_.warn)(`Optional content group not found: ${t}`),!0;if(C(this,u).get(t).visible)return!0}return!1}if(i.policy==="AllOn"){for(const t of i.ids){if(!C(this,u).has(t))return(0,_.warn)(`Optional content group not found: ${t}`),!0;if(!C(this,u).get(t).visible)return!1}return!0}if(i.policy==="AnyOff"){for(const t of i.ids){if(!C(this,u).has(t))return(0,_.warn)(`Optional content group not found: ${t}`),!0;if(!C(this,u).get(t).visible)return!0}return!1}if(i.policy==="AllOff"){for(const t of i.ids){if(!C(this,u).has(t))return(0,_.warn)(`Optional content group not found: ${t}`),!0;if(C(this,u).get(t).visible)return!1}return!0}return(0,_.warn)(`Unknown optional content policy ${i.policy}.`),!0}return(0,_.warn)(`Unknown group type ${i.type}.`),!0}setVisibility(i,t=!0){C(this,u).has(i)?(C(this,u).get(i)._setVisible(M,!!t),lt(this,N,null)):(0,_.warn)(`Optional content group not found: ${i}`)}get hasInitialVisibility(){if(C(this,N)!==null)return C(this,N);for(const[i,t]of C(this,u)){const e=C(this,d).get(i);if(t.visible!==e)return lt(this,N,!1)}return lt(this,N,!0)}getOrder(){return C(this,u).size?C(this,v)?C(this,v).slice():[...C(this,u).keys()]:null}getGroups(){return C(this,u).size>0?(0,_.objectFromMap)(C(this,u)):null}getGroup(i){return C(this,u).get(i)||null}},N=new WeakMap,u=new WeakMap,d=new WeakMap,v=new WeakMap,y=new WeakSet,oe=function(i){const t=i.length;if(t<2)return!0;const e=i[0];for(let r=1;r<t;r++){const c=i[r];let h;if(Array.isArray(c))h=it(this,y,oe).call(this,c);else{if(!C(this,u).has(c))return(0,_.warn)(`Optional content group not found: ${c}`),!0;h=C(this,u).get(c).visible}switch(e){case"And":if(!h)return!1;break;case"Or":if(h)return!0;break;case"Not":return!h;default:return!0}}return e==="And"},W)},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFDataTransportStream=void 0;var _=Y(1),M=Y(4);A.PDFDataTransportStream=class{constructor(u,d){(0,_.assert)(d,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=u.progressiveDone||!1,this._contentDispositionFilename=u.contentDispositionFilename||null;const v=u.initialData;if((v==null?void 0:v.length)>0){const y=new Uint8Array(v).buffer;this._queuedChunks.push(y)}this._pdfDataRangeTransport=d,this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._contentLength=u.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((y,E)=>{this._onReceiveData({begin:y,chunk:E})}),this._pdfDataRangeTransport.addProgressListener((y,E)=>{this._onProgress({loaded:y,total:E})}),this._pdfDataRangeTransport.addProgressiveReadListener(y=>{this._onReceiveData({chunk:y})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(u){const d=new Uint8Array(u.chunk).buffer;if(u.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(d):this._queuedChunks.push(d);else{const v=this._rangeReaders.some(function(y){return y._begin!==u.begin?!1:(y._enqueue(d),!0)});(0,_.assert)(v,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var u,d;return(d=(u=this._fullRequestReader)==null?void 0:u._loaded)!=null?d:0}_onProgress(u){if(u.total===void 0){const d=this._rangeReaders[0];d!=null&&d.onProgress&&d.onProgress({loaded:u.loaded})}else{const d=this._fullRequestReader;d!=null&&d.onProgress&&d.onProgress({loaded:u.loaded,total:u.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(u){const d=this._rangeReaders.indexOf(u);d>=0&&this._rangeReaders.splice(d,1)}getFullReader(){(0,_.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const u=this._queuedChunks;return this._queuedChunks=null,new q(this,u,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(u,d){if(d<=this._progressiveDataLength)return null;const v=new K(this,u,d);return this._pdfDataRangeTransport.requestDataRange(u,d),this._rangeReaders.push(v),v}cancelAllRequests(u){this._fullRequestReader&&this._fullRequestReader.cancel(u);for(const d of this._rangeReaders.slice(0))d.cancel(u);this._pdfDataRangeTransport.abort()}};class q{constructor(u,d,v=!1,y=null){this._stream=u,this._done=v||!1,this._filename=(0,M.isPdfFile)(y)?y:null,this._queuedChunks=d||[],this._loaded=0;for(const E of this._queuedChunks)this._loaded+=E.byteLength;this._requests=[],this._headersReady=Promise.resolve(),u._fullRequestReader=this,this.onProgress=null}_enqueue(u){this._done||(this._requests.length>0?this._requests.shift().resolve({value:u,done:!1}):this._queuedChunks.push(u),this._loaded+=u.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const u=(0,_.createPromiseCapability)();return this._requests.push(u),u.promise}cancel(u){this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class K{constructor(u,d,v){this._stream=u,this._begin=d,this._end=v,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(u){if(!this._done){if(this._requests.length===0)this._queuedChunk=u;else{this._requests.shift().resolve({value:u,done:!1});for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const d=this._queuedChunk;return this._queuedChunk=null,{value:d,done:!1}}if(this._done)return{value:void 0,done:!0};const u=(0,_.createPromiseCapability)();return this._requests.push(u),u.promise}cancel(u){this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(st,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.XfaText=void 0;class Y{static textContent(M){const q=[],K={items:q,styles:Object.create(null)};return function N(u){var y;if(!u)return;let d=null;const v=u.name;if(v==="#text")d=u.value;else{if(!Y.shouldBuildText(v))return;(y=u==null?void 0:u.attributes)!=null&&y.textContent?d=u.attributes.textContent:u.value&&(d=u.value)}if(d!==null&&q.push({str:d}),u.children)for(const E of u.children)N(E)}(M),K}static shouldBuildText(M){return!(M==="textarea"||M==="input"||M==="option"||M==="select")}}A.XfaText=Y},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.NodeStandardFontDataFactory=A.NodeCanvasFactory=A.NodeCMapReaderFactory=void 0;var _=Y(5);const M=function(u){return new Promise((d,v)=>{require$$5.readFile(u,(y,E)=>{!y&&E?d(new Uint8Array(E)):v(new Error(y))})})};class q extends _.BaseCanvasFactory{_createCanvas(d,v){return require$$1.createCanvas(d,v)}}A.NodeCanvasFactory=q;class K extends _.BaseCMapReaderFactory{_fetchData(d,v){return M(d).then(y=>({cMapData:y,compressionType:v}))}}A.NodeCMapReaderFactory=K;class N extends _.BaseStandardFontDataFactory{_fetchData(d){return M(d)}}A.NodeStandardFontDataFactory=N},(st,A,Y)=>{var d,v,y,E,W,m,i,t,e,r,le,h,ce,l,Kt,x,we,F,he,U,Pe;Object.defineProperty(A,"__esModule",{value:!0}),A.AnnotationEditorLayer=void 0;var _=Y(1),M=Y(9),q=Y(4),K=Y(23),N=Y(24);const V=class{constructor(n){tt(this,r);tt(this,h);tt(this,x);tt(this,F);tt(this,U);tt(this,d,!1);tt(this,v,this.pointerup.bind(this));tt(this,y,this.pointerdown.bind(this));tt(this,E,new Map);tt(this,W,!1);tt(this,m,new WeakMap);tt(this,i,new Map);tt(this,t,void 0);tt(this,e,new Set);V._initialized||(V._initialized=!0,K.FreeTextEditor.initialize(n.l10n),N.InkEditor.initialize(n.l10n),n.uiManager.registerEditorTypes([K.FreeTextEditor,N.InkEditor])),lt(this,t,n.uiManager),this.annotationStorage=n.annotationStorage,this.pageIndex=n.pageIndex,this.div=n.div,C(this,t).addLayer(this)}get textLayerElements(){const n=this.div.parentNode.getElementsByClassName("textLayer").item(0);if(!n)return(0,_.shadow)(this,"textLayerElements",null);let a=C(this,m).get(n);return a||(a=n.querySelectorAll('span[role="presentation"]'),a.length===0?(0,_.shadow)(this,"textLayerElements",null):(a=Array.from(a),a.sort(it(V,l,Kt)),C(this,m).set(n,a),a))}updateToolbar(n){C(this,t).updateToolbar(n)}updateMode(n=C(this,t).getMode()){it(this,U,Pe).call(this),n===_.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),C(this,t).unselectAll()}addInkEditorIfNeeded(n){if(!(!n&&C(this,t).getMode()!==_.AnnotationEditorType.INK)){if(!n){for(const a of C(this,E).values())if(a.isEmpty()){a.setInBackground();return}}it(this,F,he).call(this,{offsetX:0,offsetY:0}).setInBackground()}}setEditingState(n){C(this,t).setEditingState(n)}addCommands(n){C(this,t).addCommands(n)}enable(){this.div.style.pointerEvents="auto";for(const n of C(this,E).values())n.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const n of C(this,E).values())n.disableEditing()}setActiveEditor(n){C(this,t).getActive()!==n&&C(this,t).setActiveEditor(n)}enableClick(){this.div.addEventListener("pointerdown",C(this,y)),this.div.addEventListener("pointerup",C(this,v))}disableClick(){this.div.removeEventListener("pointerdown",C(this,y)),this.div.removeEventListener("pointerup",C(this,v))}attach(n){C(this,E).set(n.id,n)}detach(n){C(this,E).delete(n.id),this.removePointerInTextLayer(n)}remove(n){C(this,t).removeEditor(n),this.detach(n),this.annotationStorage.removeKey(n.id),n.div.style.display="none",setTimeout(()=>{n.div.style.display="",n.div.remove(),n.isAttachedToDOM=!1,document.activeElement===document.body&&C(this,t).focusMainContainer()},0),C(this,W)||this.addInkEditorIfNeeded(!1)}onTextLayerRendered(){C(this,i).clear();for(const n of C(this,e))n.isAttachedToDOM&&this.addPointerInTextLayer(n);C(this,e).clear()}removePointerInTextLayer(n){if(!C(this,r,le)){C(this,e).delete(n);return}const{id:a}=n,g=C(this,i).get(a);if(!g)return;C(this,i).delete(a);let S=g.getAttribute("aria-owns");S!=null&&S.includes(a)&&(S=S.split(" ").filter(T=>T!==a).join(" "),S?g.setAttribute("aria-owns",S):(g.removeAttribute("aria-owns"),g.setAttribute("role","presentation")))}addPointerInTextLayer(n){if(!C(this,r,le)){C(this,e).add(n);return}this.removePointerInTextLayer(n);const a=this.textLayerElements;if(!a)return;const{contentDiv:g}=n,S=n.getIdForTextLayer(),T=(0,q.binarySearchFirstItem)(a,L=>{var j;return it(j=V,l,Kt).call(j,g,L)<0}),D=a[Math.max(0,T-1)],R=D.getAttribute("aria-owns");R!=null&&R.includes(S)||D.setAttribute("aria-owns",R?`${R} ${S}`:S),D.removeAttribute("role"),C(this,i).set(S,D)}moveDivInDOM(n){this.addPointerInTextLayer(n);const{div:a,contentDiv:g}=n;if(!this.div.hasChildNodes()){this.div.append(a);return}const S=Array.from(this.div.childNodes).filter(D=>D!==a);if(S.length===0)return;const T=(0,q.binarySearchFirstItem)(S,D=>{var R;return it(R=V,l,Kt).call(R,g,D)<0});T===0?S[0].before(a):S[T-1].after(a)}add(n){if(it(this,h,ce).call(this,n),this.addToAnnotationStorage(n),C(this,t).addEditor(n),this.attach(n),!n.isAttachedToDOM){const a=n.render();this.div.append(a),n.isAttachedToDOM=!0}this.moveDivInDOM(n),n.onceAdded()}addToAnnotationStorage(n){n.isEmpty()||this.annotationStorage.has(n.id)||this.annotationStorage.setValue(n.id,n)}addOrRebuild(n){n.needsToBeRebuilt()?n.rebuild():this.add(n)}addANewEditor(n){this.addCommands({cmd:()=>{this.addOrRebuild(n)},undo:()=>{n.remove()},mustExec:!0})}addUndoableEditor(n){this.addCommands({cmd:()=>{this.addOrRebuild(n)},undo:()=>{n.remove()},mustExec:!1})}getNextId(){return C(this,t).getId()}deserialize(n){switch(n.annotationType){case _.AnnotationEditorType.FREETEXT:return K.FreeTextEditor.deserialize(n,this);case _.AnnotationEditorType.INK:return N.InkEditor.deserialize(n,this)}return null}setSelected(n){C(this,t).setSelected(n)}toggleSelected(n){C(this,t).toggleSelected(n)}isSelected(n){return C(this,t).isSelected(n)}unselect(n){C(this,t).unselect(n)}pointerup(n){const a=M.KeyboardManager.platform.isMac;n.button!==0||n.ctrlKey&&a||n.target===this.div&&(C(this,d)?it(this,F,he).call(this,n):lt(this,d,!0))}pointerdown(n){const a=M.KeyboardManager.platform.isMac;if(n.button!==0||n.ctrlKey&&a||n.target!==this.div)return;const g=C(this,t).getActive();lt(this,d,!g||g.isEmpty())}drop(n){const a=n.dataTransfer.getData("text/plain"),g=C(this,t).getEditor(a);if(!g)return;n.preventDefault(),n.dataTransfer.dropEffect="move",it(this,h,ce).call(this,g);const S=this.div.getBoundingClientRect(),T=n.clientX-S.x,D=n.clientY-S.y;g.translate(T-g.startX,D-g.startY),this.moveDivInDOM(g),g.div.focus()}dragover(n){n.preventDefault()}destroy(){var n;((n=C(this,t).getActive())==null?void 0:n.parent)===this&&C(this,t).setActiveEditor(null);for(const a of C(this,E).values())this.removePointerInTextLayer(a),a.isAttachedToDOM=!1,a.div.remove(),a.parent=null;C(this,i).clear(),this.div=null,C(this,E).clear(),C(this,e).clear(),C(this,t).removeLayer(this)}render(n){this.viewport=n.viewport,(0,M.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const a of C(this,t).getEditors(this.pageIndex))this.add(a);this.updateMode()}update(n){this.viewport=n.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[n,a,g,S]=this.viewport.viewBox;return[g-n,S-a]}get viewportBaseDimensions(){const{width:n,height:a,rotation:g}=this.viewport;return g%180==0?[n,a]:[a,n]}setDimensions(){const{width:n,height:a,rotation:g}=this.viewport,S=g%180!=0,T=Math.floor(n)+"px",D=Math.floor(a)+"px";this.div.style.width=S?D:T,this.div.style.height=S?T:D,this.div.setAttribute("data-main-rotation",g)}};let u=V;d=new WeakMap,v=new WeakMap,y=new WeakMap,E=new WeakMap,W=new WeakMap,m=new WeakMap,i=new WeakMap,t=new WeakMap,e=new WeakMap,r=new WeakSet,le=function(){return!!this.div.parentNode.querySelector(".textLayer .endOfContent")},h=new WeakSet,ce=function(n){var a;n.parent!==this&&(this.attach(n),n.pageIndex=this.pageIndex,(a=n.parent)==null||a.detach(n),n.parent=this,n.div&&n.isAttachedToDOM&&(n.div.remove(),this.div.append(n.div)))},l=new WeakSet,Kt=function(n,a){const g=n.getBoundingClientRect(),S=a.getBoundingClientRect();return g.y+g.height<=S.y?-1:S.y+S.height<=g.y?1:g.x+g.width/2-(S.x+S.width/2)},x=new WeakSet,we=function(n){switch(C(this,t).getMode()){case _.AnnotationEditorType.FREETEXT:return new K.FreeTextEditor(n);case _.AnnotationEditorType.INK:return new N.InkEditor(n)}return null},F=new WeakSet,he=function(n){const a=this.getNextId(),g=it(this,x,we).call(this,{parent:this,id:a,x:n.offsetX,y:n.offsetY});return g&&this.add(g),g},U=new WeakSet,Pe=function(){lt(this,W,!0);for(const n of C(this,E).values())n.isEmpty()&&n.remove();lt(this,W,!1)},tt(u,l),Et(u,"_initialized",!1),A.AnnotationEditorLayer=u},(st,A,Y)=>{var N,u,d,v,y,E,W,m,i,ke,e,Fe,c,Re,s,de;Object.defineProperty(A,"__esModule",{value:!0}),A.FreeTextEditor=void 0;var _=Y(1),M=Y(9),q=Y(8);const p=class extends q.AnnotationEditor{constructor(F){super({...F,name:"freeTextEditor"});tt(this,i);tt(this,e);tt(this,c);tt(this,s);tt(this,N,this.editorDivBlur.bind(this));tt(this,u,this.editorDivFocus.bind(this));tt(this,d,this.editorDivKeydown.bind(this));tt(this,v,void 0);tt(this,y,"");tt(this,E,"");tt(this,W,!1);tt(this,m,void 0);lt(this,v,F.color||p._defaultColor||q.AnnotationEditor._defaultLineColor),lt(this,m,F.fontSize||p._defaultFontSize)}static initialize(F){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(U=>[U,F.get(U)]));const P=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(P.getPropertyValue("--freetext-padding"))}static updateDefaultParams(F,P){switch(F){case _.AnnotationEditorParamsType.FREETEXT_SIZE:p._defaultFontSize=P;break;case _.AnnotationEditorParamsType.FREETEXT_COLOR:p._defaultColor=P}}updateParams(F,P){switch(F){case _.AnnotationEditorParamsType.FREETEXT_SIZE:it(this,i,ke).call(this,P);break;case _.AnnotationEditorParamsType.FREETEXT_COLOR:it(this,e,Fe).call(this,P)}}static get defaultPropertiesToUpdate(){return[[_.AnnotationEditorParamsType.FREETEXT_SIZE,p._defaultFontSize],[_.AnnotationEditorParamsType.FREETEXT_COLOR,p._defaultColor||q.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[_.AnnotationEditorParamsType.FREETEXT_SIZE,C(this,m)],[_.AnnotationEditorParamsType.FREETEXT_COLOR,C(this,v)]]}getInitialTranslation(){return[-p._internalPadding*this.parent.scaleFactor,-(p._internalPadding+C(this,m))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(_.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",C(this,d)),this.editorDiv.addEventListener("focus",C(this,u)),this.editorDiv.addEventListener("blur",C(this,N)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",C(this,d)),this.editorDiv.removeEventListener("focus",C(this,u)),this.editorDiv.removeEventListener("blur",C(this,N)),this.div.focus(),this.isEditing=!1)}focusin(F){super.focusin(F),F.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),C(this,W)||(lt(this,W,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),lt(this,E,this.editorDiv.innerHTML),lt(this,y,it(this,c,Re).call(this).trimEnd()),it(this,s,de).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(F){this.enableEditMode(),this.editorDiv.focus()}keydown(F){F.target===this.div&&F.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(F){p._keyboardManager.exec(this,F)}editorDivFocus(F){this.isEditing=!0}editorDivBlur(F){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}getIdForTextLayer(){return this.editorDiv.id}render(){if(this.div)return this.div;let F,P;this.width&&(F=this.x,P=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),p._l10nPromise.get("editor_free_text_aria_label").then(J=>{var V;return(V=this.editorDiv)==null?void 0:V.setAttribute("aria-label",J)}),p._l10nPromise.get("free_text_default_content").then(J=>{var V;return(V=this.editorDiv)==null?void 0:V.setAttribute("default-content",J)}),this.editorDiv.contentEditable=!0;const{style:U}=this.editorDiv;if(U.fontSize=`calc(${C(this,m)}px * var(--scale-factor))`,U.color=C(this,v),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,M.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[J,V]=this.parent.viewportBaseDimensions;this.setAt(F*J,P*V,this.width*J,this.height*V),this.editorDiv.innerHTML=C(this,E),this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(F,P){const U=super.deserialize(F,P);return lt(U,m,F.fontSize),lt(U,v,_.Util.makeHexColor(...F.color)),lt(U,y,F.value),lt(U,E,F.value.split(`
`).map(J=>`<div>${J}</div>`).join("")),U}serialize(){if(this.isEmpty())return null;const F=p._internalPadding*this.parent.scaleFactor,P=this.getRect(F,F),U=q.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:_.AnnotationEditorType.FREETEXT,color:U,fontSize:C(this,m),value:C(this,y),pageIndex:this.parent.pageIndex,rect:P,rotation:this.rotation}}};let K=p;N=new WeakMap,u=new WeakMap,d=new WeakMap,v=new WeakMap,y=new WeakMap,E=new WeakMap,W=new WeakMap,m=new WeakMap,i=new WeakSet,ke=function(F){const P=J=>{this.editorDiv.style.fontSize=`calc(${J}px * var(--scale-factor))`,this.translate(0,-(J-C(this,m))*this.parent.scaleFactor),lt(this,m,J),it(this,s,de).call(this)},U=C(this,m);this.parent.addCommands({cmd:()=>{P(F)},undo:()=>{P(U)},mustExec:!0,type:_.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},e=new WeakSet,Fe=function(F){const P=C(this,v);this.parent.addCommands({cmd:()=>{lt(this,v,F),this.editorDiv.style.color=F},undo:()=>{lt(this,v,P),this.editorDiv.style.color=P},mustExec:!0,type:_.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},c=new WeakSet,Re=function(){const F=this.editorDiv.getElementsByTagName("div");if(F.length===0)return this.editorDiv.innerText;const P=[];for(let U=0,J=F.length;U<J;U++){const V=F[U].firstChild;(V==null?void 0:V.nodeName)==="#text"?P.push(V.data):P.push("")}return P.join(`
`)},s=new WeakSet,de=function(){const[F,P]=this.parent.viewportBaseDimensions,U=this.div.getBoundingClientRect();this.width=U.width/F,this.height=U.height/P},Et(K,"_freeTextDefaultContent",""),Et(K,"_l10nPromise"),Et(K,"_internalPadding",0),Et(K,"_defaultColor",null),Et(K,"_defaultFontSize",10),Et(K,"_keyboardManager",new M.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],p.prototype.commitOrRemove]])),A.FreeTextEditor=K},(st,A,Y)=>{var d,v,y,E,W,m,i,t,e,r,c,h,s,l,p,Me,w,De,P,Ie,J,Oe,I,ue,a,Le,S,Ne,D,je,L,Lt,B,pe,o,Jt,f,Qt,O,jt,X,fe,Z,Zt,H,ge,ct,Be,dt,Ue,z,qe,pt,me,bt,te,Pt,Bt,Ut,be;Object.defineProperty(A,"__esModule",{value:!0}),A.InkEditor=void 0,Object.defineProperty(A,"fitCurve",{enumerable:!0,get:function(){return q.fitCurve}});var _=Y(1),M=Y(8),q=Y(25),K=Y(9);const N=16,wt=class extends M.AnnotationEditor{constructor(et){super({...et,name:"inkEditor"});tt(this,p);tt(this,w);tt(this,P);tt(this,J);tt(this,I);tt(this,a);tt(this,S);tt(this,D);tt(this,L);tt(this,B);tt(this,o);tt(this,f);tt(this,O);tt(this,X);tt(this,Z);tt(this,ct);tt(this,dt);tt(this,z);tt(this,pt);tt(this,bt);tt(this,Pt);tt(this,Ut);tt(this,d,0);tt(this,v,0);tt(this,y,0);tt(this,E,this.canvasPointermove.bind(this));tt(this,W,this.canvasPointerleave.bind(this));tt(this,m,this.canvasPointerup.bind(this));tt(this,i,this.canvasPointerdown.bind(this));tt(this,t,!1);tt(this,e,!1);tt(this,r,null);tt(this,c,null);tt(this,h,0);tt(this,s,0);tt(this,l,null);this.color=et.color||null,this.thickness=et.thickness||null,this.opacity=et.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(et){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(at=>[at,et.get(at)]))}static updateDefaultParams(et,at){switch(et){case _.AnnotationEditorParamsType.INK_THICKNESS:wt._defaultThickness=at;break;case _.AnnotationEditorParamsType.INK_COLOR:wt._defaultColor=at;break;case _.AnnotationEditorParamsType.INK_OPACITY:wt._defaultOpacity=at/100}}updateParams(et,at){switch(et){case _.AnnotationEditorParamsType.INK_THICKNESS:it(this,p,Me).call(this,at);break;case _.AnnotationEditorParamsType.INK_COLOR:it(this,w,De).call(this,at);break;case _.AnnotationEditorParamsType.INK_OPACITY:it(this,P,Ie).call(this,at)}}static get defaultPropertiesToUpdate(){return[[_.AnnotationEditorParamsType.INK_THICKNESS,wt._defaultThickness],[_.AnnotationEditorParamsType.INK_COLOR,wt._defaultColor||M.AnnotationEditor._defaultLineColor],[_.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*wt._defaultOpacity)]]}get propertiesToUpdate(){var et;return[[_.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||wt._defaultThickness],[_.AnnotationEditorParamsType.INK_COLOR,this.color||wt._defaultColor||M.AnnotationEditor._defaultLineColor],[_.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((et=this.opacity)!=null?et:wt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(it(this,o,Jt).call(this),it(this,f,Qt).call(this)),this.isAttachedToDOM||(this.parent.add(this),it(this,O,jt).call(this)),it(this,Pt,Bt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,C(this,c).disconnect(),lt(this,c,null),super.remove())}enableEditMode(){!C(this,t)&&this.canvas!==null&&(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",C(this,i)),this.canvas.addEventListener("pointerup",C(this,m)))}disableEditMode(){this.isInEditMode()&&this.canvas!==null&&(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",C(this,i)),this.canvas.removeEventListener("pointerup",C(this,m)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){C(this,t)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),lt(this,t,!0),this.div.classList.add("disabled"),it(this,Pt,Bt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveDivInDOM(this),this.div.focus())}focusin(et){super.focusin(et),this.enableEditMode()}canvasPointerdown(et){et.button===0&&this.isInEditMode()&&!C(this,t)&&(this.setInForeground(),et.type!=="mouse"&&this.div.focus(),et.stopPropagation(),this.canvas.addEventListener("pointerleave",C(this,W)),this.canvas.addEventListener("pointermove",C(this,E)),it(this,a,Le).call(this,et.offsetX,et.offsetY))}canvasPointermove(et){et.stopPropagation(),it(this,S,Ne).call(this,et.offsetX,et.offsetY)}canvasPointerup(et){et.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(et.stopPropagation(),it(this,B,pe).call(this,et),this.setInBackground())}canvasPointerleave(et){it(this,B,pe).call(this,et),this.setInBackground()}render(){if(this.div)return this.div;let et,at;this.width&&(et=this.x,at=this.y),super.render(),wt._l10nPromise.get("editor_ink_aria_label").then(mt=>{var gt;return(gt=this.div)==null?void 0:gt.setAttribute("aria-label",mt)});const[ut,_t,yt,At]=it(this,J,Oe).call(this);if(this.setAt(ut,_t,0,0),this.setDims(yt,At),it(this,o,Jt).call(this),this.width){const[mt,gt]=this.parent.viewportBaseDimensions;this.setAt(et*mt,at*gt,this.width*mt,this.height*gt),lt(this,e,!0),it(this,O,jt).call(this),this.setDims(this.width*mt,this.height*gt),it(this,L,Lt).call(this),it(this,Ut,be).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return it(this,f,Qt).call(this),this.div}setDimensions(et,at){const ut=Math.round(et),_t=Math.round(at);if(C(this,h)===ut&&C(this,s)===_t)return;lt(this,h,ut),lt(this,s,_t),this.canvas.style.visibility="hidden",C(this,d)&&Math.abs(C(this,d)-et/at)>.01&&(at=Math.ceil(et/C(this,d)),this.setDims(et,at));const[yt,At]=this.parent.viewportBaseDimensions;this.width=et/yt,this.height=at/At,C(this,t)&&it(this,X,fe).call(this,et,at),it(this,O,jt).call(this),it(this,L,Lt).call(this),this.canvas.style.visibility="visible"}static deserialize(et,at){var It,Ct;const ut=super.deserialize(et,at);ut.thickness=et.thickness,ut.color=_.Util.makeHexColor(...et.color),ut.opacity=et.opacity;const[_t,yt]=at.pageDimensions,At=ut.width*_t,mt=ut.height*yt,gt=at.scaleFactor,Tt=et.thickness/2;lt(ut,d,At/mt),lt(ut,t,!0),lt(ut,h,Math.round(At)),lt(ut,s,Math.round(mt));for(const{bezier:St}of et.paths){const Ft=[];ut.paths.push(Ft);let Rt=gt*(St[0]-Tt),Mt=gt*(mt-St[1]-Tt);for(let Dt=2,Gt=St.length;Dt<Gt;Dt+=6){const Ht=gt*(St[Dt]-Tt),Vt=gt*(mt-St[Dt+1]-Tt),Xt=gt*(St[Dt+2]-Tt),$t=gt*(mt-St[Dt+3]-Tt),ye=gt*(St[Dt+4]-Tt),ve=gt*(mt-St[Dt+5]-Tt);Ft.push([[Rt,Mt],[Ht,Vt],[Xt,$t],[ye,ve]]),Rt=ye,Mt=ve}const Ot=it(this,H,ge).call(this,Ft);ut.bezierPath2D.push(Ot)}const xt=it(It=ut,pt,me).call(It);return lt(ut,y,xt[2]-xt[0]),lt(ut,v,xt[3]-xt[1]),it(Ct=ut,X,fe).call(Ct,At,mt),ut}serialize(){if(this.isEmpty())return null;const et=this.getRect(0,0),at=this.rotation%180==0?et[3]-et[1]:et[2]-et[0],ut=M.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:_.AnnotationEditorType.INK,color:ut,thickness:this.thickness,opacity:this.opacity,paths:it(this,ct,Be).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,at),pageIndex:this.parent.pageIndex,rect:et,rotation:this.rotation}}};let u=wt;d=new WeakMap,v=new WeakMap,y=new WeakMap,E=new WeakMap,W=new WeakMap,m=new WeakMap,i=new WeakMap,t=new WeakMap,e=new WeakMap,r=new WeakMap,c=new WeakMap,h=new WeakMap,s=new WeakMap,l=new WeakMap,p=new WeakSet,Me=function(et){const at=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=et,it(this,Pt,Bt).call(this)},undo:()=>{this.thickness=at,it(this,Pt,Bt).call(this)},mustExec:!0,type:_.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},w=new WeakSet,De=function(et){const at=this.color;this.parent.addCommands({cmd:()=>{this.color=et,it(this,L,Lt).call(this)},undo:()=>{this.color=at,it(this,L,Lt).call(this)},mustExec:!0,type:_.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},P=new WeakSet,Ie=function(et){et/=100;const at=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=et,it(this,L,Lt).call(this)},undo:()=>{this.opacity=at,it(this,L,Lt).call(this)},mustExec:!0,type:_.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},J=new WeakSet,Oe=function(){const{width:et,height:at,rotation:ut}=this.parent.viewport;switch(ut){case 90:return[0,et,et,at];case 180:return[et,at,et,at];case 270:return[at,0,et,at];default:return[0,0,et,at]}},I=new WeakSet,ue=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,K.opacityToHex)(this.opacity)}`},a=new WeakSet,Le=function(et,at){var ut;this.isEditing=!0,C(this,e)||(lt(this,e,!0),it(this,O,jt).call(this),this.thickness||(this.thickness=wt._defaultThickness),this.color||(this.color=wt._defaultColor||M.AnnotationEditor._defaultLineColor),(ut=this.opacity)!=null||(this.opacity=wt._defaultOpacity)),this.currentPath.push([et,at]),lt(this,r,null),it(this,I,ue).call(this),this.ctx.beginPath(),this.ctx.moveTo(et,at),lt(this,l,()=>{C(this,l)&&(C(this,r)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):it(this,L,Lt).call(this),this.ctx.lineTo(...C(this,r)),lt(this,r,null),this.ctx.stroke()),window.requestAnimationFrame(C(this,l)))}),window.requestAnimationFrame(C(this,l))},S=new WeakSet,Ne=function(et,at){const[ut,_t]=this.currentPath.at(-1);(et!==ut||at!==_t)&&(this.currentPath.push([et,at]),lt(this,r,[et,at]))},D=new WeakSet,je=function(et,at){var mt;this.ctx.closePath(),lt(this,l,null),et=Math.min(Math.max(et,0),this.canvas.width),at=Math.min(Math.max(at,0),this.canvas.height);const[ut,_t]=this.currentPath.at(-1);et===ut&&at===_t||this.currentPath.push([et,at]);let yt;if(this.currentPath.length!==1)yt=(0,q.fitCurve)(this.currentPath,30,null);else{const gt=[et,at];yt=[[gt,gt.slice(),gt.slice(),gt]]}const At=it(mt=wt,H,ge).call(mt,yt);this.currentPath.length=0,this.parent.addCommands({cmd:()=>{this.paths.push(yt),this.bezierPath2D.push(At),this.rebuild()},undo:()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(it(this,o,Jt).call(this),it(this,f,Qt).call(this)),it(this,Pt,Bt).call(this))},mustExec:!0})},L=new WeakSet,Lt=function(){if(this.isEmpty()){it(this,Z,Zt).call(this);return}it(this,I,ue).call(this);const{canvas:et,ctx:at}=this;at.setTransform(1,0,0,1,0,0),at.clearRect(0,0,et.width,et.height),it(this,Z,Zt).call(this);for(const ut of this.bezierPath2D)at.stroke(ut)},B=new WeakSet,pe=function(et){it(this,D,je).call(this,et.offsetX,et.offsetY),this.canvas.removeEventListener("pointerleave",C(this,W)),this.canvas.removeEventListener("pointermove",C(this,E)),this.parent.addToAnnotationStorage(this)},o=new WeakSet,Jt=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",wt._l10nPromise.get("editor_ink_canvas_aria_label").then(et=>{var at;return(at=this.canvas)==null?void 0:at.setAttribute("aria-label",et)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},f=new WeakSet,Qt=function(){lt(this,c,new ResizeObserver(et=>{const at=et[0].contentRect;at.width&&at.height&&this.setDimensions(at.width,at.height)})),C(this,c).observe(this.div)},O=new WeakSet,jt=function(){if(!C(this,e))return;const[et,at]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*et),this.canvas.height=Math.ceil(this.height*at),it(this,Z,Zt).call(this)},X=new WeakSet,fe=function(et,at){const ut=it(this,bt,te).call(this),_t=(et-ut)/C(this,y),yt=(at-ut)/C(this,v);this.scaleFactor=Math.min(_t,yt)},Z=new WeakSet,Zt=function(){const et=it(this,bt,te).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+et,this.translationY*this.scaleFactor+et)},H=new WeakSet,ge=function(et){const at=new Path2D;for(let ut=0,_t=et.length;ut<_t;ut++){const[yt,At,mt,gt]=et[ut];ut===0&&at.moveTo(...yt),at.bezierCurveTo(At[0],At[1],mt[0],mt[1],gt[0],gt[1])}return at},ct=new WeakSet,Be=function(et,at,ut,_t){const yt=[],At=this.thickness/2;let mt,gt;for(const Tt of this.paths){mt=[],gt=[];for(let xt=0,It=Tt.length;xt<It;xt++){const[Ct,St,Ft,Rt]=Tt[xt],Mt=et*(Ct[0]+at)+At,Ot=_t-et*(Ct[1]+ut)-At,Dt=et*(St[0]+at)+At,Gt=_t-et*(St[1]+ut)-At,Ht=et*(Ft[0]+at)+At,Vt=_t-et*(Ft[1]+ut)-At,Xt=et*(Rt[0]+at)+At,$t=_t-et*(Rt[1]+ut)-At;xt===0&&(mt.push(Mt,Ot),gt.push(Mt,Ot)),mt.push(Dt,Gt,Ht,Vt,Xt,$t),it(this,dt,Ue).call(this,Mt,Ot,Dt,Gt,Ht,Vt,Xt,$t,4,gt)}yt.push({bezier:mt,points:gt})}return yt},dt=new WeakSet,Ue=function(et,at,ut,_t,yt,At,mt,gt,Tt,xt){if(it(this,z,qe).call(this,et,at,ut,_t,yt,At,mt,gt))xt.push(mt,gt);else{for(let It=1;It<Tt-1;It++){const Ct=It/Tt,St=1-Ct;let Ft=Ct*et+St*ut,Rt=Ct*at+St*_t,Mt=Ct*ut+St*yt,Ot=Ct*_t+St*At;Ft=Ct*Ft+St*Mt,Rt=Ct*Rt+St*Ot,Mt=Ct*Mt+St*(Ct*yt+St*mt),Ot=Ct*Ot+St*(Ct*At+St*gt),Ft=Ct*Ft+St*Mt,Rt=Ct*Rt+St*Ot,xt.push(Ft,Rt)}xt.push(mt,gt)}},z=new WeakSet,qe=function(et,at,ut,_t,yt,At,mt,gt){const Tt=(3*ut-2*et-mt)**2,xt=(3*_t-2*at-gt)**2,It=(3*yt-et-2*mt)**2,Ct=(3*At-at-2*gt)**2;return Math.max(Tt,It)+Math.max(xt,Ct)<=10},pt=new WeakSet,me=function(){let et=1/0,at=-1/0,ut=1/0,_t=-1/0;for(const yt of this.paths)for(const[At,mt,gt,Tt]of yt){const xt=_.Util.bezierBoundingBox(...At,...mt,...gt,...Tt);et=Math.min(et,xt[0]),ut=Math.min(ut,xt[1]),at=Math.max(at,xt[2]),_t=Math.max(_t,xt[3])}return[et,ut,at,_t]},bt=new WeakSet,te=function(){return C(this,t)?Math.ceil(this.thickness*this.parent.scaleFactor):0},Pt=new WeakSet,Bt=function(et=!1){if(this.isEmpty())return;if(!C(this,t)){it(this,L,Lt).call(this);return}const at=it(this,pt,me).call(this),ut=it(this,bt,te).call(this);lt(this,y,Math.max(N,at[2]-at[0])),lt(this,v,Math.max(N,at[3]-at[1]));const _t=Math.ceil(ut+C(this,y)*this.scaleFactor),yt=Math.ceil(ut+C(this,v)*this.scaleFactor),[At,mt]=this.parent.viewportBaseDimensions;this.width=_t/At,this.height=yt/mt,lt(this,d,_t/yt),it(this,Ut,be).call(this);const gt=this.translationX,Tt=this.translationY;this.translationX=-at[0],this.translationY=-at[1],it(this,O,jt).call(this),it(this,L,Lt).call(this),lt(this,h,_t),lt(this,s,yt),this.setDims(_t,yt);const xt=et?ut/this.scaleFactor/2:0;this.translate(gt-this.translationX-xt,Tt-this.translationY-xt)},Ut=new WeakSet,be=function(){const{style:et}=this.div;C(this,d)>=1?(et.minHeight="16px",et.minWidth=`${Math.round(C(this,d)*N)}px`):(et.minWidth="16px",et.minHeight=`${Math.round(N/C(this,d))}px`)},tt(u,H),Et(u,"_defaultColor",null),Et(u,"_defaultOpacity",1),Et(u,"_defaultThickness",1),Et(u,"_l10nPromise"),A.InkEditor=u},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.fitCurve=void 0;const _=Y(26);A.fitCurve=_},st=>{function A(v,y,E,W,m){var i,t,e,r,c,h,s,l,p,x,w,F,P;if(v.length===2)return F=u.vectorLen(u.subtract(v[0],v[1]))/3,[i=[v[0],u.addArrays(v[0],u.mulItems(y,F)),u.addArrays(v[1],u.mulItems(E,F)),v[1]]];if(t=function(J){var V,I,n,a=[];return J.forEach((g,S)=>{V=S?I+u.vectorLen(u.subtract(g,n)):0,a.push(V),I=V,n=g}),a=a.map(g=>g/I)}(v),[i,r,h]=Y(v,t,t,y,E,m),r===0||r<W)return[i];if(r<W*W)for(e=t,c=r,s=h,P=0;P<20;P++){if(e=_(i,v,e),[i,r,h]=Y(v,t,e,y,E,m),r<W)return[i];if(h===s){let U=r/c;if(U>.9999&&U<1.0001)break}c=r,s=h}return w=[],(l=u.subtract(v[h-1],v[h+1])).every(U=>U===0)&&(l=u.subtract(v[h-1],v[h]),[l[0],l[1]]=[-l[1],l[0]]),p=u.normalize(l),x=u.mulItems(p,-1),w=(w=w.concat(A(v.slice(0,h+1),y,p,W,m))).concat(A(v.slice(h),x,E,W,m))}function Y(v,y,E,W,m,i){var t,e,r;return t=function(h,s,l,p){var x,w,F,P,U,J,V,I,n,a,g,S,T,D,R,L,j,B=h[0],$=h[h.length-1];for(x=[B,null,null,$],w=u.zeros_Xx2x2(s.length),T=0,D=s.length;T<D;T++)j=1-(L=s[T]),(F=w[T])[0]=u.mulItems(l,3*L*(j*j)),F[1]=u.mulItems(p,3*j*(L*L));for(P=[[0,0],[0,0]],U=[0,0],T=0,D=h.length;T<D;T++)L=s[T],F=w[T],P[0][0]+=u.dot(F[0],F[0]),P[0][1]+=u.dot(F[0],F[1]),P[1][0]+=u.dot(F[0],F[1]),P[1][1]+=u.dot(F[1],F[1]),R=u.subtract(h[T],d.q([B,B,$,$],L)),U[0]+=u.dot(F[0],R),U[1]+=u.dot(F[1],R);return J=P[0][0]*P[1][1]-P[1][0]*P[0][1],V=P[0][0]*U[1]-P[1][0]*U[0],I=U[0]*P[1][1]-U[1]*P[0][1],n=J===0?0:I/J,a=J===0?0:V/J,S=u.vectorLen(u.subtract(B,$)),n<(g=1e-6*S)||a<g?(x[1]=u.addArrays(B,u.mulItems(l,S/3)),x[2]=u.addArrays($,u.mulItems(p,S/3))):(x[1]=u.addArrays(B,u.mulItems(l,n)),x[2]=u.addArrays($,u.mulItems(p,a))),x}(v,E,W,m),[e,r]=function(h,s,l){var p,x,w,F,P,U,J,V;x=0,w=Math.floor(h.length/2);const I=q(s,10);for(P=0,U=h.length;P<U;P++)J=h[P],V=K(s,l[P],I,10),(p=(F=u.subtract(d.q(s,V),J))[0]*F[0]+F[1]*F[1])>x&&(x=p,w=P);return[x,w]}(v,t,y),i&&i({bez:t,points:v,params:y,maxErr:e,maxPoint:r}),[t,e,r]}function _(v,y,E){return E.map((W,m)=>M(v,y[m],W))}function M(v,y,E){var W=u.subtract(d.q(v,E),y),m=d.qprime(v,E),i=u.mulMatrix(W,m),t=u.sum(u.squareItems(m))+2*u.mulMatrix(W,d.qprimeprime(v,E));return t===0?E:E-i/t}var q=function(v,y){for(var E,W=[0],m=v[0],i=0,t=1;t<=y;t++)E=d.q(v,t/y),i+=u.vectorLen(u.subtract(E,m)),W.push(i),m=E;return W=W.map(e=>e/i)};function K(v,y,E,W){if(y<0)return 0;if(y>1)return 1;for(var m,i,t,e,r=1;r<=W;r++)if(y<=E[r]){t=(r-1)/W,i=r/W,e=(y-(m=E[r-1]))/(E[r]-m)*(i-t)+t;break}return e}function N(v,y){return u.normalize(u.subtract(v,y))}class u{static zeros_Xx2x2(y){for(var E=[];y--;)E.push([0,0]);return E}static mulItems(y,E){return y.map(W=>W*E)}static mulMatrix(y,E){return y.reduce((W,m,i)=>W+m*E[i],0)}static subtract(y,E){return y.map((W,m)=>W-E[m])}static addArrays(y,E){return y.map((W,m)=>W+E[m])}static addItems(y,E){return y.map(W=>W+E)}static sum(y){return y.reduce((E,W)=>E+W)}static dot(y,E){return u.mulMatrix(y,E)}static vectorLen(y){return Math.hypot(...y)}static divItems(y,E){return y.map(W=>W/E)}static squareItems(y){return y.map(E=>E*E)}static normalize(y){return this.divItems(y,this.vectorLen(y))}}class d{static q(y,E){var W=1-E,m=u.mulItems(y[0],W*W*W),i=u.mulItems(y[1],3*W*W*E),t=u.mulItems(y[2],3*W*E*E),e=u.mulItems(y[3],E*E*E);return u.addArrays(u.addArrays(m,i),u.addArrays(t,e))}static qprime(y,E){var W=1-E,m=u.mulItems(u.subtract(y[1],y[0]),3*W*W),i=u.mulItems(u.subtract(y[2],y[1]),6*W*E),t=u.mulItems(u.subtract(y[3],y[2]),3*E*E);return u.addArrays(u.addArrays(m,i),t)}static qprimeprime(y,E){return u.addArrays(u.mulItems(u.addArrays(u.subtract(y[2],u.mulItems(y[1],2)),y[0]),6*(1-E)),u.mulItems(u.addArrays(u.subtract(y[3],u.mulItems(y[2],2)),y[1]),6*E))}}st.exports=function(y,E,W){if(!Array.isArray(y))throw new TypeError("First argument should be an array");if(y.forEach(e=>{if(!Array.isArray(e)||e.some(r=>typeof r!="number")||e.length!==y[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),(y=y.filter((e,r)=>r===0||!e.every((c,h)=>c===y[r-1][h]))).length<2)return[];const m=y.length,i=N(y[1],y[0]),t=N(y[m-2],y[m-1]);return A(y,i,t,E,W)},st.exports.fitCubic=A,st.exports.createTangent=N},(st,A,Y)=>{var D,R,_e,j,Ae;Object.defineProperty(A,"__esModule",{value:!0}),A.AnnotationLayer=void 0;var _=Y(1),M=Y(4),q=Y(7),K=Y(28),N=Y(29);const u=1e3,d=new WeakSet;function v($){return{width:$[2]-$[0],height:$[3]-$[1]}}class y{static create(o){switch(o.data.annotationType){case _.AnnotationType.LINK:return new W(o);case _.AnnotationType.TEXT:return new m(o);case _.AnnotationType.WIDGET:switch(o.data.fieldType){case"Tx":return new t(o);case"Btn":return o.data.radioButton?new r(o):o.data.checkBox?new e(o):new c(o);case"Ch":return new h(o)}return new i(o);case _.AnnotationType.POPUP:return new s(o);case _.AnnotationType.FREETEXT:return new p(o);case _.AnnotationType.LINE:return new x(o);case _.AnnotationType.SQUARE:return new w(o);case _.AnnotationType.CIRCLE:return new F(o);case _.AnnotationType.POLYLINE:return new P(o);case _.AnnotationType.CARET:return new J(o);case _.AnnotationType.INK:return new V(o);case _.AnnotationType.POLYGON:return new U(o);case _.AnnotationType.HIGHLIGHT:return new I(o);case _.AnnotationType.UNDERLINE:return new n(o);case _.AnnotationType.SQUIGGLY:return new a(o);case _.AnnotationType.STRIKEOUT:return new g(o);case _.AnnotationType.STAMP:return new S(o);case _.AnnotationType.FILEATTACHMENT:return new T(o);default:return new E(o)}}}class E{constructor(o,{isRenderable:b=!1,ignoreBorder:f=!1,createQuadrilaterals:k=!1}={}){this.isRenderable=b,this.data=o.data,this.layer=o.layer,this.page=o.page,this.viewport=o.viewport,this.linkService=o.linkService,this.downloadManager=o.downloadManager,this.imageResourcesPath=o.imageResourcesPath,this.renderForms=o.renderForms,this.svgFactory=o.svgFactory,this.annotationStorage=o.annotationStorage,this.enableScripting=o.enableScripting,this.hasJSActions=o.hasJSActions,this._fieldObjects=o.fieldObjects,this._mouseState=o.mouseState,b&&(this.container=this._createContainer(f)),k&&(this.quadrilaterals=this._createQuadrilaterals(f))}_createContainer(o=!1){const b=this.data,f=this.page,k=this.viewport,O=document.createElement("section"),{width:G,height:X}=v(b.rect),[Q,Z,rt,H]=k.viewBox,nt=rt-Q,ct=H-Z;O.setAttribute("data-annotation-id",b.id);const ot=_.Util.normalizeRect([b.rect[0],f.view[3]-b.rect[1]+f.view[1],b.rect[2],f.view[3]-b.rect[3]+f.view[1]]);if(!o&&b.borderStyle.width>0){O.style.borderWidth=`${b.borderStyle.width}px`;const ft=b.borderStyle.horizontalCornerRadius,z=b.borderStyle.verticalCornerRadius;if(ft>0||z>0){const pt=`calc(${ft}px * var(--scale-factor)) / calc(${z}px * var(--scale-factor))`;O.style.borderRadius=pt}switch(b.borderStyle.style){case _.AnnotationBorderStyleType.SOLID:O.style.borderStyle="solid";break;case _.AnnotationBorderStyleType.DASHED:O.style.borderStyle="dashed";break;case _.AnnotationBorderStyleType.BEVELED:(0,_.warn)("Unimplemented border style: beveled");break;case _.AnnotationBorderStyleType.INSET:(0,_.warn)("Unimplemented border style: inset");break;case _.AnnotationBorderStyleType.UNDERLINE:O.style.borderBottomStyle="solid"}const ht=b.borderColor||null;ht?O.style.borderColor=_.Util.makeHexColor(0|ht[0],0|ht[1],0|ht[2]):O.style.borderWidth=0}O.style.left=100*(ot[0]-Q)/nt+"%",O.style.top=100*(ot[1]-Z)/ct+"%";const{rotation:dt}=b;return b.hasOwnCanvas||dt===0?(O.style.width=100*G/nt+"%",O.style.height=100*X/ct+"%"):this.setRotation(dt,O),O}setRotation(o,b=this.container){const[f,k,O,G]=this.viewport.viewBox,X=O-f,Q=G-k,{width:Z,height:rt}=v(this.data.rect);let H,nt;o%180==0?(H=100*Z/X,nt=100*rt/Q):(H=100*rt/X,nt=100*Z/Q),b.style.width=`${H}%`,b.style.height=`${nt}%`,b.setAttribute("data-main-rotation",(360-o)%360)}get _commonActions(){const o=(b,f,k)=>{const O=k.detail[b];k.target.style[f]=K.ColorConverters[`${O[0]}_HTML`](O.slice(1))};return(0,_.shadow)(this,"_commonActions",{display:b=>{const f=b.detail.display%2==1;this.container.style.visibility=f?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:f,print:b.detail.display===0||b.detail.display===3})},print:b=>{this.annotationStorage.setValue(this.data.id,{print:b.detail.print})},hidden:b=>{this.container.style.visibility=b.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:b.detail.hidden})},focus:b=>{setTimeout(()=>b.target.focus({preventScroll:!1}),0)},userName:b=>{b.target.title=b.detail.userName},readonly:b=>{b.detail.readonly?b.target.setAttribute("readonly",""):b.target.removeAttribute("readonly")},required:b=>{this._setRequired(b.target,b.detail.required)},bgColor:b=>{o("bgColor","backgroundColor",b)},fillColor:b=>{o("fillColor","backgroundColor",b)},fgColor:b=>{o("fgColor","color",b)},textColor:b=>{o("textColor","color",b)},borderColor:b=>{o("borderColor","borderColor",b)},strokeColor:b=>{o("strokeColor","borderColor",b)},rotation:b=>{const f=b.detail.rotation;this.setRotation(f),this.annotationStorage.setValue(this.data.id,{rotation:f})}})}_dispatchEventFromSandbox(o,b){const f=this._commonActions;for(const k of Object.keys(b.detail)){const O=o[k]||f[k];O&&O(b)}}_setDefaultPropertiesFromJS(o){if(!this.enableScripting)return;const b=this.annotationStorage.getRawValue(this.data.id);if(!b)return;const f=this._commonActions;for(const[k,O]of Object.entries(b)){const G=f[k];G&&(G({detail:O,target:o}),delete b[k])}}_createQuadrilaterals(o=!1){if(!this.data.quadPoints)return null;const b=[],f=this.data.rect;for(const k of this.data.quadPoints)this.data.rect=[k[2].x,k[2].y,k[1].x,k[1].y],b.push(this._createContainer(o));return this.data.rect=f,b}_createPopup(o,b){let f=this.container;this.quadrilaterals&&(o=o||this.quadrilaterals,f=this.quadrilaterals[0]),o||((o=document.createElement("div")).className="popupTriggerArea",f.append(o));const k=new l({container:f,trigger:o,color:b.color,titleObj:b.titleObj,modificationDate:b.modificationDate,contentsObj:b.contentsObj,richText:b.richText,hideWrapper:!0}).render();k.style.left="100%",f.append(k)}_renderQuadrilaterals(o){for(const b of this.quadrilaterals)b.className=o;return this.quadrilaterals}render(){(0,_.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(o,b=null){const f=[];if(this._fieldObjects){const k=this._fieldObjects[o];if(k)for(const{page:O,id:G,exportValues:X}of k){if(O===-1||G===b)continue;const Q=typeof X=="string"?X:null,Z=document.querySelector(`[data-element-id="${G}"]`);!Z||d.has(Z)?f.push({id:G,exportValue:Q,domElement:Z}):(0,_.warn)(`_getElementsByName - element not allowed: ${G}`)}return f}for(const k of document.getElementsByName(o)){const{id:O,exportValue:G}=k;O!==b&&d.has(k)&&f.push({id:O,exportValue:G,domElement:k})}return f}static get platform(){const o=typeof navigator<"u"?navigator.platform:"";return(0,_.shadow)(this,"platform",{isWin:o.includes("Win"),isMac:o.includes("Mac")})}}class W extends E{constructor(o,b=null){super(o,{isRenderable:!0,ignoreBorder:!!(b!=null&&b.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=o.data.isTooltipOnly}render(){const{data:o,linkService:b}=this,f=document.createElement("a");f.setAttribute("data-element-id",o.id);let k=!1;return o.url?(b.addLinkAttributes(f,o.url,o.newWindow),k=!0):o.action?(this._bindNamedAction(f,o.action),k=!0):o.dest?(this._bindLink(f,o.dest),k=!0):(o.actions&&(o.actions.Action||o.actions["Mouse Up"]||o.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(f,o),k=!0),o.resetForm?(this._bindResetFormAction(f,o.resetForm),k=!0):this.isTooltipOnly&&!k&&(this._bindLink(f,""),k=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((O,G)=>{const X=G===0?f:f.cloneNode();return O.append(X),O}):(this.container.className="linkAnnotation",k&&this.container.append(f),this.container)}_bindLink(o,b){o.href=this.linkService.getDestinationHash(b),o.onclick=()=>(b&&this.linkService.goToDestination(b),!1),(b||b==="")&&(o.className="internalLink")}_bindNamedAction(o,b){o.href=this.linkService.getAnchorUrl(""),o.onclick=()=>(this.linkService.executeNamedAction(b),!1),o.className="internalLink"}_bindJSAction(o,b){o.href=this.linkService.getAnchorUrl("");const f=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const k of Object.keys(b.actions)){const O=f.get(k);O&&(o[O]=()=>{var G;return(G=this.linkService.eventBus)==null||G.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b.id,name:k}}),!1})}o.onclick||(o.onclick=()=>!1),o.className="internalLink"}_bindResetFormAction(o,b){const f=o.onclick;f||(o.href=this.linkService.getAnchorUrl("")),o.className="internalLink",this._fieldObjects?o.onclick=()=>{var rt;f&&f();const{fields:k,refs:O,include:G}=b,X=[];if(k.length!==0||O.length!==0){const H=new Set(O);for(const nt of k){const ct=this._fieldObjects[nt]||[];for(const{id:ot}of ct)H.add(ot)}for(const nt of Object.values(this._fieldObjects))for(const ct of nt)H.has(ct.id)===G&&X.push(ct)}else for(const H of Object.values(this._fieldObjects))X.push(...H);const Q=this.annotationStorage,Z=[];for(const H of X){const{id:nt}=H;switch(Z.push(nt),H.type){case"text":{const ot=H.defaultValue||"";Q.setValue(nt,{value:ot});break}case"checkbox":case"radiobutton":{const ot=H.defaultValue===H.exportValues;Q.setValue(nt,{value:ot});break}case"combobox":case"listbox":{const ot=H.defaultValue||"";Q.setValue(nt,{value:ot});break}default:continue}const ct=document.querySelector(`[data-element-id="${nt}"]`);ct&&(d.has(ct)?ct.dispatchEvent(new Event("resetform")):(0,_.warn)(`_bindResetFormAction - element not allowed: ${nt}`))}return this.enableScripting&&((rt=this.linkService.eventBus)==null||rt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Z,name:"ResetForm"}})),!1}:((0,_.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),f||(o.onclick=()=>!1))}}class m extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str))})}render(){this.container.className="textAnnotation";const o=document.createElement("img");return o.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",o.alt="[{{type}} Annotation]",o.dataset.l10nId="text_annotation_type",o.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(o,this.data),this.container.append(o),this.container}}class i extends E{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(o){const{isWin:b,isMac:f}=E.platform;return b&&o.ctrlKey||f&&o.metaKey}_setEventListener(o,b,f,k){b.includes("mouse")?o.addEventListener(b,O=>{var G;(G=this.linkService.eventBus)==null||G.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:f,value:k(O),shift:O.shiftKey,modifier:this._getKeyModifier(O)}})}):o.addEventListener(b,O=>{var G;(G=this.linkService.eventBus)==null||G.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:f,value:k(O)}})})}_setEventListeners(o,b,f){var k;for(const[O,G]of b)(G==="Action"||((k=this.data.actions)==null?void 0:k[G]))&&this._setEventListener(o,O,G,f)}_setBackgroundColor(o){const b=this.data.backgroundColor||null;o.style.backgroundColor=b===null?"transparent":_.Util.makeHexColor(b[0],b[1],b[2])}_setTextStyle(o){const b=["left","center","right"],{fontColor:f}=this.data.defaultAppearanceData,k=this.data.defaultAppearanceData.fontSize||9,O=o.style;let G;if(this.data.multiLine){const X=Math.abs(this.data.rect[3]-this.data.rect[1]),Q=X/(Math.round(X/(_.LINE_FACTOR*k))||1);G=Math.min(k,Math.round(Q/_.LINE_FACTOR))}else{const X=Math.abs(this.data.rect[3]-this.data.rect[1]);G=Math.min(k,Math.round(X/_.LINE_FACTOR))}O.fontSize=`calc(${G}px * var(--scale-factor))`,O.color=_.Util.makeHexColor(f[0],f[1],f[2]),this.data.textAlignment!==null&&(O.textAlign=b[this.data.textAlignment])}_setRequired(o,b){b?o.setAttribute("required",!0):o.removeAttribute("required"),o.setAttribute("aria-required",b)}}class t extends i{constructor(o){super(o,{isRenderable:o.renderForms||!o.data.hasAppearance&&!!o.data.fieldValue})}setPropertyOnSiblings(o,b,f,k){const O=this.annotationStorage;for(const G of this._getElementsByName(o.name,o.id))G.domElement&&(G.domElement[b]=f),O.setValue(G.id,{[k]:f})}render(){var k;const o=this.annotationStorage,b=this.data.id;this.container.className="textWidgetAnnotation";let f=null;if(this.renderForms){const O=o.getValue(b,{value:this.data.fieldValue}),G=O.formattedValue||O.value||"",X={userValue:G,formattedValue:null,valueOnFocus:""};this.data.multiLine?(f=document.createElement("textarea"),f.textContent=G,this.data.doNotScroll&&(f.style.overflowY="hidden")):(f=document.createElement("input"),f.type="text",f.setAttribute("value",G),this.data.doNotScroll&&(f.style.overflowX="hidden")),d.add(f),f.setAttribute("data-element-id",b),f.disabled=this.data.readOnly,f.name=this.data.fieldName,f.tabIndex=u,this._setRequired(f,this.data.required),f.addEventListener("input",Z=>{o.setValue(b,{value:Z.target.value}),this.setPropertyOnSiblings(f,"value",Z.target.value,"value")}),f.addEventListener("resetform",Z=>{var H;const rt=(H=this.data.defaultFieldValue)!=null?H:"";f.value=X.userValue=rt,X.formattedValue=null});let Q=Z=>{const{formattedValue:rt}=X;rt!=null&&(Z.target.value=rt),Z.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){f.addEventListener("focus",rt=>{X.userValue&&(rt.target.value=X.userValue),X.valueOnFocus=rt.target.value}),f.addEventListener("updatefromsandbox",rt=>{const H={value(nt){var ct;X.userValue=(ct=nt.detail.value)!=null?ct:"",o.setValue(b,{value:X.userValue.toString()}),nt.target.value=X.userValue},formattedValue(nt){const{formattedValue:ct}=nt.detail;X.formattedValue=ct,ct!=null&&nt.target!==document.activeElement&&(nt.target.value=ct),o.setValue(b,{formattedValue:ct})},selRange(nt){nt.target.setSelectionRange(...nt.detail.selRange)}};this._dispatchEventFromSandbox(H,rt)}),f.addEventListener("keydown",rt=>{var ct;let H=-1;if(rt.key==="Escape"?H=0:rt.key==="Enter"?H=2:rt.key==="Tab"&&(H=3),H===-1)return;const{value:nt}=rt.target;X.valueOnFocus!==nt&&(X.userValue=nt,(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b,name:"Keystroke",value:nt,willCommit:!0,commitKey:H,selStart:rt.target.selectionStart,selEnd:rt.target.selectionEnd}}))});const Z=Q;Q=null,f.addEventListener("blur",rt=>{var nt;const{value:H}=rt.target;X.userValue=H,this._mouseState.isDown&&X.valueOnFocus!==H&&((nt=this.linkService.eventBus)==null||nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b,name:"Keystroke",value:H,willCommit:!0,commitKey:1,selStart:rt.target.selectionStart,selEnd:rt.target.selectionEnd}})),Z(rt)}),(k=this.data.actions)!=null&&k.Keystroke&&f.addEventListener("beforeinput",rt=>{var ht;const{data:H,target:nt}=rt,{value:ct,selectionStart:ot,selectionEnd:dt}=nt;let ft=ot,z=dt;switch(rt.inputType){case"deleteWordBackward":{const pt=ct.substring(0,ot).match(/\w*[^\w]*$/);pt&&(ft-=pt[0].length);break}case"deleteWordForward":{const pt=ct.substring(ot).match(/^[^\w]*\w*/);pt&&(z+=pt[0].length);break}case"deleteContentBackward":ot===dt&&(ft-=1);break;case"deleteContentForward":ot===dt&&(z+=1)}rt.preventDefault(),(ht=this.linkService.eventBus)==null||ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b,name:"Keystroke",value:ct,change:H||"",willCommit:!1,selStart:ft,selEnd:z}})}),this._setEventListeners(f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],rt=>rt.target.value)}if(Q&&f.addEventListener("blur",Q),this.data.maxLen!==null&&(f.maxLength=this.data.maxLen),this.data.comb){const Z=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;f.classList.add("comb"),f.style.letterSpacing=`calc(${Z}px * var(--scale-factor) - 1ch)`}}else f=document.createElement("div"),f.textContent=this.data.fieldValue,f.style.verticalAlign="middle",f.style.display="table-cell";return this._setTextStyle(f),this._setBackgroundColor(f),this._setDefaultPropertiesFromJS(f),this.container.append(f),this.container}}class e extends i{constructor(o){super(o,{isRenderable:o.renderForms})}render(){const o=this.annotationStorage,b=this.data,f=b.id;let k=o.getValue(f,{value:b.exportValue===b.fieldValue}).value;typeof k=="string"&&(k=k!=="Off",o.setValue(f,{value:k})),this.container.className="buttonWidgetAnnotation checkBox";const O=document.createElement("input");return d.add(O),O.setAttribute("data-element-id",f),O.disabled=b.readOnly,this._setRequired(O,this.data.required),O.type="checkbox",O.name=b.fieldName,k&&O.setAttribute("checked",!0),O.setAttribute("exportValue",b.exportValue),O.tabIndex=u,O.addEventListener("change",G=>{const{name:X,checked:Q}=G.target;for(const Z of this._getElementsByName(X,f)){const rt=Q&&Z.exportValue===b.exportValue;Z.domElement&&(Z.domElement.checked=rt),o.setValue(Z.id,{value:rt})}o.setValue(f,{value:Q})}),O.addEventListener("resetform",G=>{const X=b.defaultFieldValue||"Off";G.target.checked=X===b.exportValue}),this.enableScripting&&this.hasJSActions&&(O.addEventListener("updatefromsandbox",G=>{const X={value(Q){Q.target.checked=Q.detail.value!=="Off",o.setValue(f,{value:Q.target.checked})}};this._dispatchEventFromSandbox(X,G)}),this._setEventListeners(O,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],G=>G.target.checked)),this._setBackgroundColor(O),this._setDefaultPropertiesFromJS(O),this.container.append(O),this.container}}class r extends i{constructor(o){super(o,{isRenderable:o.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const o=this.annotationStorage,b=this.data,f=b.id;let k=o.getValue(f,{value:b.fieldValue===b.buttonValue}).value;typeof k=="string"&&(k=k!==b.buttonValue,o.setValue(f,{value:k}));const O=document.createElement("input");if(d.add(O),O.setAttribute("data-element-id",f),O.disabled=b.readOnly,this._setRequired(O,this.data.required),O.type="radio",O.name=b.fieldName,k&&O.setAttribute("checked",!0),O.tabIndex=u,O.addEventListener("change",G=>{const{name:X,checked:Q}=G.target;for(const Z of this._getElementsByName(X,f))o.setValue(Z.id,{value:!1});o.setValue(f,{value:Q})}),O.addEventListener("resetform",G=>{const X=b.defaultFieldValue;G.target.checked=X!=null&&X===b.buttonValue}),this.enableScripting&&this.hasJSActions){const G=b.buttonValue;O.addEventListener("updatefromsandbox",X=>{const Q={value:Z=>{const rt=G===Z.detail.value;for(const H of this._getElementsByName(Z.target.name)){const nt=rt&&H.id===f;H.domElement&&(H.domElement.checked=nt),o.setValue(H.id,{value:nt})}}};this._dispatchEventFromSandbox(Q,X)}),this._setEventListeners(O,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],X=>X.target.checked)}return this._setBackgroundColor(O),this._setDefaultPropertiesFromJS(O),this.container.append(O),this.container}}class c extends W{constructor(o){super(o,{ignoreBorder:o.data.hasAppearance})}render(){const o=super.render();o.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(o.title=this.data.alternativeText);const b=o.lastChild;return this.enableScripting&&this.hasJSActions&&b&&(this._setDefaultPropertiesFromJS(b),b.addEventListener("updatefromsandbox",f=>{this._dispatchEventFromSandbox({},f)})),o}}class h extends i{constructor(o){super(o,{isRenderable:o.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const o=this.annotationStorage,b=this.data.id,f=o.getValue(b,{value:this.data.fieldValue}),k=document.createElement("select");d.add(k),k.setAttribute("data-element-id",b),k.disabled=this.data.readOnly,this._setRequired(k,this.data.required),k.name=this.data.fieldName,k.tabIndex=u;let O=this.data.combo&&this.data.options.length>0;this.data.combo||(k.size=this.data.options.length,this.data.multiSelect&&(k.multiple=!0)),k.addEventListener("resetform",Z=>{const rt=this.data.defaultFieldValue;for(const H of k.options)H.selected=H.value===rt});for(const Z of this.data.options){const rt=document.createElement("option");rt.textContent=Z.displayValue,rt.value=Z.exportValue,f.value.includes(Z.exportValue)&&(rt.setAttribute("selected",!0),O=!1),k.append(rt)}let G=null;if(O){const Z=document.createElement("option");Z.value=" ",Z.setAttribute("hidden",!0),Z.setAttribute("selected",!0),k.prepend(Z),G=()=>{Z.remove(),k.removeEventListener("input",G),G=null},k.addEventListener("input",G)}const X=(Z,rt)=>{const H=rt?"value":"textContent",nt=Z.target.options;return Z.target.multiple?Array.prototype.filter.call(nt,ct=>ct.selected).map(ct=>ct[H]):nt.selectedIndex===-1?null:nt[nt.selectedIndex][H]},Q=Z=>{const rt=Z.target.options;return Array.prototype.map.call(rt,H=>({displayValue:H.textContent,exportValue:H.value}))};return this.enableScripting&&this.hasJSActions?(k.addEventListener("updatefromsandbox",Z=>{const rt={value(H){G==null||G();const nt=H.detail.value,ct=new Set(Array.isArray(nt)?nt:[nt]);for(const ot of k.options)ot.selected=ct.has(ot.value);o.setValue(b,{value:X(H,!0)})},multipleSelection(H){k.multiple=!0},remove(H){const nt=k.options,ct=H.detail.remove;nt[ct].selected=!1,k.remove(ct),nt.length>0&&Array.prototype.findIndex.call(nt,ot=>ot.selected)===-1&&(nt[0].selected=!0),o.setValue(b,{value:X(H,!0),items:Q(H)})},clear(H){for(;k.length!==0;)k.remove(0);o.setValue(b,{value:null,items:[]})},insert(H){const{index:nt,displayValue:ct,exportValue:ot}=H.detail.insert,dt=k.children[nt],ft=document.createElement("option");ft.textContent=ct,ft.value=ot,dt?dt.before(ft):k.append(ft),o.setValue(b,{value:X(H,!0),items:Q(H)})},items(H){const{items:nt}=H.detail;for(;k.length!==0;)k.remove(0);for(const ct of nt){const{displayValue:ot,exportValue:dt}=ct,ft=document.createElement("option");ft.textContent=ot,ft.value=dt,k.append(ft)}k.options.length>0&&(k.options[0].selected=!0),o.setValue(b,{value:X(H,!0),items:Q(H)})},indices(H){const nt=new Set(H.detail.indices);for(const ct of H.target.options)ct.selected=nt.has(ct.index);o.setValue(b,{value:X(H,!0)})},editable(H){H.target.disabled=!H.detail.editable}};this._dispatchEventFromSandbox(rt,Z)}),k.addEventListener("input",Z=>{var nt;const rt=X(Z,!0),H=X(Z,!1);o.setValue(b,{value:rt}),(nt=this.linkService.eventBus)==null||nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b,name:"Keystroke",value:H,changeEx:rt,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(k,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],Z=>Z.target.checked)):k.addEventListener("input",function(Z){o.setValue(b,{value:X(Z,!0)})}),this.data.combo&&this._setTextStyle(k),this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class s extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str))})}render(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;const o=`[data-annotation-id="${this.data.parentId}"]`,b=this.layer.querySelectorAll(o);if(b.length===0)return this.container;const f=new l({container:this.container,trigger:Array.from(b),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),k=this.page,O=_.Util.normalizeRect([this.data.parentRect[0],k.view[3]-this.data.parentRect[1]+k.view[1],this.data.parentRect[2],k.view[3]-this.data.parentRect[3]+k.view[1]]),G=O[0]+this.data.parentRect[2]-this.data.parentRect[0],X=O[1],[Q,Z,rt,H]=this.viewport.viewBox,nt=rt-Q,ct=H-Z;return this.container.style.left=100*(G-Q)/nt+"%",this.container.style.top=100*(X-Z)/ct+"%",this.container.append(f.render()),this.container}}class l{constructor(o){this.container=o.container,this.trigger=o.trigger,this.color=o.color,this.titleObj=o.titleObj,this.modificationDate=o.modificationDate,this.contentsObj=o.contentsObj,this.richText=o.richText,this.hideWrapper=o.hideWrapper||!1,this.pinned=!1}render(){var G,X;const o=document.createElement("div");o.className="popupWrapper",this.hideElement=this.hideWrapper?o:this.container,this.hideElement.hidden=!0;const b=document.createElement("div");b.className="popup";const f=this.color;if(f){const Q=.7*(255-f[0])+f[0],Z=.7*(255-f[1])+f[1],rt=.7*(255-f[2])+f[2];b.style.backgroundColor=_.Util.makeHexColor(0|Q,0|Z,0|rt)}const k=document.createElement("h1");k.dir=this.titleObj.dir,k.textContent=this.titleObj.str,b.append(k);const O=M.PDFDateString.toDateObject(this.modificationDate);if(O){const Q=document.createElement("span");Q.className="popupDate",Q.textContent="{{date}}, {{time}}",Q.dataset.l10nId="annotation_date_string",Q.dataset.l10nArgs=JSON.stringify({date:O.toLocaleDateString(),time:O.toLocaleTimeString()}),b.append(Q)}if(!((G=this.richText)!=null&&G.str)||((X=this.contentsObj)==null?void 0:X.str)&&this.contentsObj.str!==this.richText.str){const Q=this._formatContents(this.contentsObj);b.append(Q)}else N.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:b}),b.lastChild.className="richText popupContent";Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const Q of this.trigger)Q.addEventListener("click",this._toggle.bind(this)),Q.addEventListener("mouseover",this._show.bind(this,!1)),Q.addEventListener("mouseout",this._hide.bind(this,!1));return b.addEventListener("click",this._hide.bind(this,!0)),o.append(b),o}_formatContents({str:o,dir:b}){const f=document.createElement("p");f.className="popupContent",f.dir=b;const k=o.split(/(?:\r\n?|\n)/);for(let O=0,G=k.length;O<G;++O){const X=k[O];f.append(document.createTextNode(X)),O<G-1&&f.append(document.createElement("br"))}return f}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(o=!1){o&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(o=!0){o&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class p extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class x extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const o=this.data,{width:b,height:f}=v(o.rect),k=this.svgFactory.create(b,f,!0),O=this.svgFactory.createElement("svg:line");return O.setAttribute("x1",o.rect[2]-o.lineCoordinates[0]),O.setAttribute("y1",o.rect[3]-o.lineCoordinates[1]),O.setAttribute("x2",o.rect[2]-o.lineCoordinates[2]),O.setAttribute("y2",o.rect[3]-o.lineCoordinates[3]),O.setAttribute("stroke-width",o.borderStyle.width||1),O.setAttribute("stroke","transparent"),O.setAttribute("fill","transparent"),k.append(O),this.container.append(k),this._createPopup(O,o),this.container}}class w extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const o=this.data,{width:b,height:f}=v(o.rect),k=this.svgFactory.create(b,f,!0),O=o.borderStyle.width,G=this.svgFactory.createElement("svg:rect");return G.setAttribute("x",O/2),G.setAttribute("y",O/2),G.setAttribute("width",b-O),G.setAttribute("height",f-O),G.setAttribute("stroke-width",O||1),G.setAttribute("stroke","transparent"),G.setAttribute("fill","transparent"),k.append(G),this.container.append(k),this._createPopup(G,o),this.container}}class F extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const o=this.data,{width:b,height:f}=v(o.rect),k=this.svgFactory.create(b,f,!0),O=o.borderStyle.width,G=this.svgFactory.createElement("svg:ellipse");return G.setAttribute("cx",b/2),G.setAttribute("cy",f/2),G.setAttribute("rx",b/2-O/2),G.setAttribute("ry",f/2-O/2),G.setAttribute("stroke-width",O||1),G.setAttribute("stroke","transparent"),G.setAttribute("fill","transparent"),k.append(G),this.container.append(k),this._createPopup(G,o),this.container}}class P extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const o=this.data,{width:b,height:f}=v(o.rect),k=this.svgFactory.create(b,f,!0);let O=[];for(const X of o.vertices){const Q=X.x-o.rect[0],Z=o.rect[3]-X.y;O.push(Q+","+Z)}O=O.join(" ");const G=this.svgFactory.createElement(this.svgElementName);return G.setAttribute("points",O),G.setAttribute("stroke-width",o.borderStyle.width||1),G.setAttribute("stroke","transparent"),G.setAttribute("fill","transparent"),k.append(G),this.container.append(k),this._createPopup(G,o),this.container}}class U extends P{constructor(o){super(o),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class J extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class V extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const o=this.data,{width:b,height:f}=v(o.rect),k=this.svgFactory.create(b,f,!0);for(const O of o.inkLists){let G=[];for(const Q of O){const Z=Q.x-o.rect[0],rt=o.rect[3]-Q.y;G.push(`${Z},${rt}`)}G=G.join(" ");const X=this.svgFactory.createElement(this.svgElementName);X.setAttribute("points",G),X.setAttribute("stroke-width",o.borderStyle.width||1),X.setAttribute("stroke","transparent"),X.setAttribute("fill","transparent"),this._createPopup(X,o),k.append(X)}return this.container.append(k),this.container}}class I extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class n extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class a extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class g extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class S extends E{constructor(o){var b,f,k;super(o,{isRenderable:!!(o.data.hasPopup||((b=o.data.titleObj)==null?void 0:b.str)||((f=o.data.contentsObj)==null?void 0:f.str)||((k=o.data.richText)==null?void 0:k.str)),ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class T extends E{constructor(o){var k;super(o,{isRenderable:!0});const{filename:b,content:f}=this.data.file;this.filename=(0,M.getFilenameFromUrl)(b),this.content=f,(k=this.linkService.eventBus)==null||k.dispatch("fileattachmentannotation",{source:this,filename:b,content:f})}render(){var b,f;this.container.className="fileAttachmentAnnotation";const o=document.createElement("div");return o.className="popupTriggerArea",o.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(((b=this.data.titleObj)==null?void 0:b.str)||((f=this.data.contentsObj)==null?void 0:f.str)||this.data.richText)&&this._createPopup(o,this.data),this.container.append(o),this.container}_download(){var o;(o=this.downloadManager)==null||o.openOrDownloadData(this.container,this.content,this.filename)}}A.AnnotationLayer=(R=class{static render(o){const{annotations:b,div:f,viewport:k}=o;it(this,D,_e).call(this,f,k);const O=[],G=[];for(const X of b){if(!X)continue;if(X.annotationType===_.AnnotationType.POPUP){G.push(X);continue}const{width:Q,height:Z}=v(X.rect);Q<=0||Z<=0||O.push(X)}G.length&&O.push(...G);for(const X of O){const Q=y.create({data:X,layer:f,page:o.page,viewport:k,linkService:o.linkService,downloadManager:o.downloadManager,imageResourcesPath:o.imageResourcesPath||"",renderForms:o.renderForms!==!1,svgFactory:new M.DOMSVGFactory,annotationStorage:o.annotationStorage||new q.AnnotationStorage,enableScripting:o.enableScripting,hasJSActions:o.hasJSActions,fieldObjects:o.fieldObjects,mouseState:o.mouseState||{isDown:!1}});if(Q.isRenderable){const Z=Q.render();if(X.hidden&&(Z.style.visibility="hidden"),Array.isArray(Z))for(const rt of Z)f.append(rt);else Q instanceof s?f.prepend(Z):f.append(Z)}}it(this,j,Ae).call(this,f,o.annotationCanvasMap)}static update(o){const{annotationCanvasMap:b,div:f,viewport:k}=o;it(this,D,_e).call(this,f,k),it(this,j,Ae).call(this,f,b),f.hidden=!1}},D=new WeakSet,_e=function(o,{width:b,height:f,rotation:k}){const{style:O}=o,G=k%180!=0,X=Math.floor(b)+"px",Q=Math.floor(f)+"px";O.width=G?Q:X,O.height=G?X:Q,o.setAttribute("data-main-rotation",k)},j=new WeakSet,Ae=function(o,b){if(b){for(const[f,k]of b){const O=o.querySelector(`[data-annotation-id="${f}"]`);if(!O)continue;const{firstChild:G}=O;G?G.nodeName==="CANVAS"?G.replaceWith(k):G.before(k):O.append(k)}b.clear()}},tt(R,D),tt(R,j),R)},(st,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.ColorConverters=void 0;function Y(_){return Math.floor(255*Math.max(0,Math.min(1,_))).toString(16).padStart(2,"0")}A.ColorConverters=class{static CMYK_G([M,q,K,N]){return["G",1-Math.min(1,.3*M+.59*K+.11*q+N)]}static G_CMYK([M]){return["CMYK",0,0,0,1-M]}static G_RGB([M]){return["RGB",M,M,M]}static G_HTML([M]){const q=Y(M);return`#${q}${q}${q}`}static RGB_G([M,q,K]){return["G",.3*M+.59*q+.11*K]}static RGB_HTML([M,q,K]){return`#${Y(M)}${Y(q)}${Y(K)}`}static T_HTML(){return"#00000000"}static CMYK_RGB([M,q,K,N]){return["RGB",1-Math.min(1,M+N),1-Math.min(1,K+N),1-Math.min(1,q+N)]}static CMYK_HTML(M){const q=this.CMYK_RGB(M).slice(1);return this.RGB_HTML(q)}static RGB_CMYK([M,q,K]){const N=1-M,u=1-q,d=1-K;return["CMYK",N,u,d,Math.min(N,u,d)]}}},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.XfaLayer=void 0;var _=Y(20);A.XfaLayer=class{static setupStorage(q,K,N,u,d){const v=u.getValue(K,{value:null});switch(N.name){case"textarea":if(v.value!==null&&(q.textContent=v.value),d==="print")break;q.addEventListener("input",y=>{u.setValue(K,{value:y.target.value})});break;case"input":if(N.attributes.type==="radio"||N.attributes.type==="checkbox"){if(v.value===N.attributes.xfaOn?q.setAttribute("checked",!0):v.value===N.attributes.xfaOff&&q.removeAttribute("checked"),d==="print")break;q.addEventListener("change",y=>{u.setValue(K,{value:y.target.checked?y.target.getAttribute("xfaOn"):y.target.getAttribute("xfaOff")})})}else{if(v.value!==null&&q.setAttribute("value",v.value),d==="print")break;q.addEventListener("input",y=>{u.setValue(K,{value:y.target.value})})}break;case"select":if(v.value!==null)for(const y of N.children)y.attributes.value===v.value&&(y.attributes.selected=!0);q.addEventListener("input",y=>{const E=y.target.options,W=E.selectedIndex===-1?"":E[E.selectedIndex].value;u.setValue(K,{value:W})})}}static setAttributes({html:q,element:K,storage:N=null,intent:u,linkService:d}){const{attributes:v}=K,y=q instanceof HTMLAnchorElement;v.type==="radio"&&(v.name=`${v.name}-${u}`);for(const[E,W]of Object.entries(v))if(W!=null)switch(E){case"class":W.length&&q.setAttribute(E,W.join(" "));break;case"dataId":break;case"id":q.setAttribute("data-element-id",W);break;case"style":Object.assign(q.style,W);break;case"textContent":q.textContent=W;break;default:(!y||E!=="href"&&E!=="newWindow")&&q.setAttribute(E,W)}y&&d.addLinkAttributes(q,v.href,v.newWindow),N&&v.dataId&&this.setupStorage(q,v.dataId,K,N)}static render(q){var m;const K=q.annotationStorage,N=q.linkService,u=q.xfaHtml,d=q.intent||"display",v=document.createElement(u.name);u.attributes&&this.setAttributes({html:v,element:u,intent:d,linkService:N});const y=[[u,-1,v]],E=q.div;if(E.append(v),q.viewport){const i=`matrix(${q.viewport.transform.join(",")})`;E.style.transform=i}d!=="richText"&&E.setAttribute("class","xfaLayer xfaFont");const W=[];for(;y.length>0;){const[i,t,e]=y.at(-1);if(t+1===i.children.length){y.pop();continue}const r=i.children[++y.at(-1)[1]];if(r===null)continue;const{name:c}=r;if(c==="#text"){const s=document.createTextNode(r.value);W.push(s),e.append(s);continue}let h;if(h=(m=r==null?void 0:r.attributes)!=null&&m.xmlns?document.createElementNS(r.attributes.xmlns,c):document.createElement(c),e.append(h),r.attributes&&this.setAttributes({html:h,element:r,storage:K,intent:d,linkService:N}),r.children&&r.children.length>0)y.push([r,-1,h]);else if(r.value){const s=document.createTextNode(r.value);_.XfaText.shouldBuildText(c)&&W.push(s),h.append(s)}}for(const i of E.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))i.setAttribute("readOnly",!0);return{textDivs:W}}static update(q){const K=`matrix(${q.viewport.transform.join(",")})`;q.div.style.transform=K,q.div.hidden=!1}}},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.TextLayerRenderTask=void 0,A.renderTextLayer=function(i){const t=new W({textContent:i.textContent,textContentStream:i.textContentStream,container:i.container,viewport:i.viewport,textDivs:i.textDivs,textContentItemsStr:i.textContentItemsStr,enhanceTextSelection:i.enhanceTextSelection});return t._render(i.timeout),t};var _=Y(1),M=Y(4);const q=30,K=new Map,N=/^\s+$/g;function u(m,i,t,e){const r=document.createElement("span"),c=m._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:i.str!=="",hasEOL:i.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:i.str!=="",hasEOL:i.hasEOL,fontSize:0};m._textDivs.push(r);const h=_.Util.transform(m._viewport.transform,i.transform);let s=Math.atan2(h[1],h[0]);const l=t[i.fontName];l.vertical&&(s+=Math.PI/2);const p=Math.hypot(h[2],h[3]),x=p*function(J,V){const I=K.get(J);if(I)return I;V.save(),V.font=`30px ${J}`;const n=V.measureText("");let a=n.fontBoundingBoxAscent,g=Math.abs(n.fontBoundingBoxDescent);if(a){V.restore();const T=a/(a+g);return K.set(J,T),T}V.strokeStyle="red",V.clearRect(0,0,q,q),V.strokeText("g",0,0);let S=V.getImageData(0,0,q,q).data;g=0;for(let T=S.length-1-3;T>=0;T-=4)if(S[T]>0){g=Math.ceil(T/4/q);break}V.clearRect(0,0,q,q),V.strokeText("A",0,q),S=V.getImageData(0,0,q,q).data,a=0;for(let T=0,D=S.length;T<D;T+=4)if(S[T]>0){a=q-Math.floor(T/4/q);break}if(V.restore(),a){const T=a/(a+g);return K.set(J,T),T}return K.set(J,.8),.8}(l.fontFamily,e);let w,F;s===0?(w=h[4],F=h[5]-x):(w=h[4]+x*Math.sin(s),F=h[5]-x*Math.cos(s)),r.style.left=`${w}px`,r.style.top=`${F}px`,r.style.fontSize=`${p}px`,r.style.fontFamily=l.fontFamily,c.fontSize=p,r.setAttribute("role","presentation"),r.textContent=i.str,r.dir=i.dir,m._fontInspectorEnabled&&(r.dataset.fontName=i.fontName),s!==0&&(c.angle=s*(180/Math.PI));let P=!1;if(i.str.length>1||m._enhanceTextSelection&&N.test(i.str))P=!0;else if(i.str!==" "&&i.transform[0]!==i.transform[3]){const U=Math.abs(i.transform[0]),J=Math.abs(i.transform[3]);U!==J&&Math.max(U,J)/Math.min(U,J)>1.5&&(P=!0)}if(P&&(l.vertical?c.canvasWidth=i.height*m._viewport.scale:c.canvasWidth=i.width*m._viewport.scale),m._textDivProperties.set(r,c),m._textContentStream&&m._layoutText(r),m._enhanceTextSelection&&c.hasText){let U=1,J=0;s!==0&&(U=Math.cos(s),J=Math.sin(s));const V=(l.vertical?i.height:i.width)*m._viewport.scale,I=p;let n,a;s!==0?(n=[U,J,-J,U,w,F],a=_.Util.getAxialAlignedBoundingBox([0,0,V,I],n)):a=[w,F,w+V,F+I],m._bounds.push({left:a[0],top:a[1],right:a[2],bottom:a[3],div:r,size:[V,I],m:n})}}function d(m){if(m._canceled)return;const i=m._textDivs,t=m._capability,e=i.length;if(e>1e5)m._renderingDone=!0,t.resolve();else{if(!m._textContentStream)for(let r=0;r<e;r++)m._layoutText(i[r]);m._renderingDone=!0,t.resolve()}}function v(m,i,t){let e=0;for(let r=0;r<t;r++){const c=m[i++];c>0&&(e=e?Math.min(c,e):c)}return e}function y(m){const i=m._bounds,t=m._viewport,e=function(c,h,s){const l=s.map(function(x,w){return{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom,index:w,x1New:void 0,x2New:void 0}});E(c,l);const p=new Array(s.length);for(const x of l){const w=x.index;p[w]={left:x.x1New,top:0,right:x.x2New,bottom:0}}s.map(function(x,w){const F=p[w],P=l[w];P.x1=x.top,P.y1=c-F.right,P.x2=x.bottom,P.y2=c-F.left,P.index=w,P.x1New=void 0,P.x2New=void 0}),E(h,l);for(const x of l){const w=x.index;p[w].top=x.x1New,p[w].bottom=x.x2New}return p}(t.width,t.height,i);for(let r=0;r<e.length;r++){const c=i[r].div,h=m._textDivProperties.get(c);if(h.angle===0){h.paddingLeft=i[r].left-e[r].left,h.paddingTop=i[r].top-e[r].top,h.paddingRight=e[r].right-i[r].right,h.paddingBottom=e[r].bottom-i[r].bottom,m._textDivProperties.set(c,h);continue}const s=e[r],l=i[r],p=l.m,x=p[0],w=p[1],F=[[0,0],[0,l.size[1]],[l.size[0],0],l.size],P=new Float64Array(64);for(let J=0,V=F.length;J<V;J++){const I=_.Util.applyTransform(F[J],p);P[J+0]=x&&(s.left-I[0])/x,P[J+4]=w&&(s.top-I[1])/w,P[J+8]=x&&(s.right-I[0])/x,P[J+12]=w&&(s.bottom-I[1])/w,P[J+16]=w&&(s.left-I[0])/-w,P[J+20]=x&&(s.top-I[1])/x,P[J+24]=w&&(s.right-I[0])/-w,P[J+28]=x&&(s.bottom-I[1])/x,P[J+32]=x&&(s.left-I[0])/-x,P[J+36]=w&&(s.top-I[1])/-w,P[J+40]=x&&(s.right-I[0])/-x,P[J+44]=w&&(s.bottom-I[1])/-w,P[J+48]=w&&(s.left-I[0])/w,P[J+52]=x&&(s.top-I[1])/-x,P[J+56]=w&&(s.right-I[0])/w,P[J+60]=x&&(s.bottom-I[1])/-x}const U=1+Math.min(Math.abs(x),Math.abs(w));h.paddingLeft=v(P,32,16)/U,h.paddingTop=v(P,48,16)/U,h.paddingRight=v(P,0,16)/U,h.paddingBottom=v(P,16,16)/U,m._textDivProperties.set(c,h)}}function E(m,i){i.sort(function(e,r){return e.x1-r.x1||e.index-r.index});const t=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const e of i){let r=0;for(;r<t.length&&t[r].end<=e.y1;)r++;let c,h,s=t.length-1;for(;s>=0&&t[s].start>=e.y2;)s--;let l,p,x=-1/0;for(l=r;l<=s;l++){c=t[l],h=c.boundary;let P;P=h.x2>e.x1?h.index>e.index?h.x1New:e.x1:h.x2New===void 0?(h.x2+e.x1)/2:h.x2New,P>x&&(x=P)}for(e.x1New=x,l=r;l<=s;l++)c=t[l],h=c.boundary,h.x2New===void 0?h.x2>e.x1?h.index>e.index&&(h.x2New=h.x2):h.x2New=x:h.x2New>x&&(h.x2New=Math.max(x,h.x2));const w=[];let F=null;for(l=r;l<=s;l++){c=t[l],h=c.boundary;const P=h.x2>e.x2?h:e;F===P?w.at(-1).end=c.end:(w.push({start:c.start,end:c.end,boundary:P}),F=P)}for(t[r].start<e.y1&&(w[0].start=e.y1,w.unshift({start:t[r].start,end:e.y1,boundary:t[r].boundary})),e.y2<t[s].end&&(w.at(-1).end=e.y2,w.push({start:e.y2,end:t[s].end,boundary:t[s].boundary})),l=r;l<=s;l++){if(c=t[l],h=c.boundary,h.x2New!==void 0)continue;let P=!1;for(p=r-1;!P&&p>=0&&t[p].start>=h.y1;p--)P=t[p].boundary===h;for(p=s+1;!P&&p<t.length&&t[p].end<=h.y2;p++)P=t[p].boundary===h;for(p=0;!P&&p<w.length;p++)P=w[p].boundary===h;P||(h.x2New=x)}Array.prototype.splice.apply(t,[r,s-r+1,...w])}for(const e of t){const r=e.boundary;r.x2New===void 0&&(r.x2New=Math.max(m,r.x2))}}class W{constructor({textContent:i,textContentStream:t,container:e,viewport:r,textDivs:c,textContentItemsStr:h,enhanceTextSelection:s}){var l;s&&(0,M.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=i,this._textContentStream=t,this._container=e,this._document=e.ownerDocument,this._viewport=r,this._textDivs=c||[],this._textContentItemsStr=h||[],this._enhanceTextSelection=!!s,this._fontInspectorEnabled=!!((l=globalThis.FontInspector)!=null&&l.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,_.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new _.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(i,t){for(let e=0,r=i.length;e<r;e++)if(i[e].str!==void 0)this._textContentItemsStr.push(i[e].str),u(this,i[e],t,this._layoutTextCtx);else if(i[e].type==="beginMarkedContentProps"||i[e].type==="beginMarkedContent"){const c=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),i[e].id!==null&&this._container.setAttribute("id",`${i[e].id}`),c.append(this._container)}else i[e].type==="endMarkedContent"&&(this._container=this._container.parentNode)}_layoutText(i){const t=this._textDivProperties.get(i);let e="";if(t.canvasWidth!==0&&t.hasText){const{fontFamily:r}=i.style,{fontSize:c}=t;(c!==this._layoutTextLastFontSize||r!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${c*this._devicePixelRatio}px ${r}`,this._layoutTextLastFontSize=c,this._layoutTextLastFontFamily=r);const{width:h}=this._layoutTextCtx.measureText(i.textContent);if(h>0){const s=this._devicePixelRatio*t.canvasWidth/h;this._enhanceTextSelection&&(t.scale=s),e=`scaleX(${s})`}}if(t.angle!==0&&(e=`rotate(${t.angle}deg) ${e}`),e.length>0&&(this._enhanceTextSelection&&(t.originalTransform=e),i.style.transform=e),t.hasText&&this._container.append(i),t.hasEOL){const r=document.createElement("br");r.setAttribute("role","presentation"),this._container.append(r)}}_render(i=0){const t=(0,_.createPromiseCapability)();let e=Object.create(null);const r=this._document.createElement("canvas");if(r.height=r.width=q,this._layoutTextCtx=r.getContext("2d",{alpha:!1}),this._textContent){const c=this._textContent.items,h=this._textContent.styles;this._processItems(c,h),t.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');{const c=()=>{this._reader.read().then(({value:h,done:s})=>{s?t.resolve():(Object.assign(e,h.styles),this._processItems(h.items,e),c())},t.reject)};this._reader=this._textContentStream.getReader(),c()}}t.promise.then(()=>{e=null,i?this._renderTimer=setTimeout(()=>{d(this),this._renderTimer=null},i):d(this)},this._capability.reject)}expandTextDivs(i=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(y(this),this._bounds=null);const t=[],e=[];for(let r=0,c=this._textDivs.length;r<c;r++){const h=this._textDivs[r],s=this._textDivProperties.get(h);s.hasText&&(i?(t.length=0,e.length=0,s.originalTransform&&t.push(s.originalTransform),s.paddingTop>0?(e.push(`${s.paddingTop}px`),t.push(`translateY(${-s.paddingTop}px)`)):e.push(0),s.paddingRight>0?e.push(s.paddingRight/s.scale+"px"):e.push(0),s.paddingBottom>0?e.push(`${s.paddingBottom}px`):e.push(0),s.paddingLeft>0?(e.push(s.paddingLeft/s.scale+"px"),t.push(`translateX(${-s.paddingLeft/s.scale}px)`)):e.push(0),h.style.padding=e.join(" "),t.length&&(h.style.transform=t.join(" "))):(h.style.padding=null,h.style.transform=s.originalTransform))}}}A.TextLayerRenderTask=W},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.SVGGraphics=void 0;var _=Y(4),M=Y(1),q=Y(3);let K=class{constructor(){(0,M.unreachable)("Not implemented: SVGGraphics")}};A.SVGGraphics=K;{let i=function(s){let l=[];const p=[];for(const x of s)x.fn!=="save"?x.fn==="restore"?l=p.pop():l.push(x):(l.push({fnId:92,fn:"group",items:[]}),p.push(l),l=l.at(-1).items);return l},t=function(s){if(Number.isInteger(s))return s.toString();const l=s.toFixed(10);let p=l.length-1;if(l[p]!=="0")return l;do p--;while(l[p]==="0");return l.substring(0,l[p]==="."?p:p+1)},e=function(s){if(s[4]===0&&s[5]===0){if(s[1]===0&&s[2]===0)return s[0]===1&&s[3]===1?"":`scale(${t(s[0])} ${t(s[3])})`;if(s[0]===s[3]&&s[1]===-s[2])return`rotate(${t(180*Math.acos(s[0])/Math.PI)})`}else if(s[0]===1&&s[1]===0&&s[2]===0&&s[3]===1)return`translate(${t(s[4])} ${t(s[5])})`;return`matrix(${t(s[0])} ${t(s[1])} ${t(s[2])} ${t(s[3])} ${t(s[4])} ${t(s[5])})`};const N={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},u="http://www.w3.org/XML/1998/namespace",d="http://www.w3.org/1999/xlink",v=["butt","round","square"],y=["miter","round","bevel"],E=function(s,l="",p=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!p)return URL.createObjectURL(new Blob([s],{type:l}));const x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let w=`data:${l};base64,`;for(let F=0,P=s.length;F<P;F+=3){const U=255&s[F],J=255&s[F+1],V=255&s[F+2];w+=x[U>>2]+x[(3&U)<<4|J>>4]+x[F+1<P?(15&J)<<2|V>>6:64]+x[F+2<P?63&V:64]}return w},W=function(){const s=new Uint8Array([137,80,78,71,13,10,26,10]),l=new Int32Array(256);for(let F=0;F<256;F++){let P=F;for(let U=0;U<8;U++)P=1&P?3988292384^P>>1&2147483647:P>>1&2147483647;l[F]=P}function p(F,P,U,J){let V=J;const I=P.length;U[V]=I>>24&255,U[V+1]=I>>16&255,U[V+2]=I>>8&255,U[V+3]=255&I,V+=4,U[V]=255&F.charCodeAt(0),U[V+1]=255&F.charCodeAt(1),U[V+2]=255&F.charCodeAt(2),U[V+3]=255&F.charCodeAt(3),V+=4,U.set(P,V),V+=P.length;const n=function(g,S,T){let D=-1;for(let R=S;R<T;R++){const L=255&(D^g[R]);D=D>>>8^l[L]}return-1^D}(U,J+4,V);U[V]=n>>24&255,U[V+1]=n>>16&255,U[V+2]=n>>8&255,U[V+3]=255&n}function x(F){let P=F.length;const U=65535,J=Math.ceil(P/U),V=new Uint8Array(2+P+5*J+4);let I=0;V[I++]=120,V[I++]=156;let n=0;for(;P>U;)V[I++]=0,V[I++]=255,V[I++]=255,V[I++]=0,V[I++]=0,V.set(F.subarray(n,n+U),I),I+=U,n+=U,P-=U;V[I++]=1,V[I++]=255&P,V[I++]=P>>8&255,V[I++]=255&~P,V[I++]=(65535&~P)>>8&255,V.set(F.subarray(n),I),I+=F.length-n;const a=function(S,T,D){let R=1,L=0;for(let j=T;j<D;++j)R=(R+(255&S[j]))%65521,L=(L+R)%65521;return L<<16|R}(F,0,F.length);return V[I++]=a>>24&255,V[I++]=a>>16&255,V[I++]=a>>8&255,V[I++]=255&a,V}function w(F,P,U,J){const V=F.width,I=F.height;let n,a,g;const S=F.data;switch(P){case M.ImageKind.GRAYSCALE_1BPP:a=0,n=1,g=V+7>>3;break;case M.ImageKind.RGB_24BPP:a=2,n=8,g=3*V;break;case M.ImageKind.RGBA_32BPP:a=6,n=8,g=4*V;break;default:throw new Error("invalid format")}const T=new Uint8Array((1+g)*I);let D=0,R=0;for(let b=0;b<I;++b)T[D++]=0,T.set(S.subarray(R,R+g),D),R+=g,D+=g;if(P===M.ImageKind.GRAYSCALE_1BPP&&J){D=0;for(let b=0;b<I;b++){D++;for(let f=0;f<g;f++)T[D++]^=255}}const L=new Uint8Array([V>>24&255,V>>16&255,V>>8&255,255&V,I>>24&255,I>>16&255,I>>8&255,255&I,n,a,0,0,0]),j=function(f){if(!q.isNodeJS)return x(f);try{let k;k=parseInt(process.versions.node)>=8?f:Buffer.from(f);const O=require$$5.deflateSync(k,{level:9});return O instanceof Uint8Array?O:new Uint8Array(O)}catch(k){(0,M.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+k)}return x(f)}(T),B=s.length+36+L.length+j.length,$=new Uint8Array(B);let o=0;return $.set(s,o),o+=s.length,p("IHDR",L,$,o),o+=12+L.length,p("IDATA",j,$,o),o+=12+j.length,p("IEND",new Uint8Array(0),$,o),E($,"image/png",U)}return function(P,U,J){return w(P,P.kind===void 0?M.ImageKind.GRAYSCALE_1BPP:P.kind,U,J)}}();class m{constructor(){this.fontSizeScale=1,this.fontWeight=N.fontWeight,this.fontSize=0,this.textMatrix=M.IDENTITY_MATRIX,this.fontMatrix=M.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=M.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=N.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(l,p){this.x=l,this.y=p}}let r=0,c=0,h=0;A.SVGGraphics=K=class{constructor(s,l,p=!1){(0,_.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new _.DOMSVGFactory,this.current=new m,this.transformMatrix=M.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=s,this.objs=l,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!p,this._operatorIdMapping=[];for(const x in M.OPS)this._operatorIdMapping[M.OPS[x]]=x}save(){this.transformStack.push(this.transformMatrix);const s=this.current;this.extraStack.push(s),this.current=s.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(s){this.save(),this.executeOpTree(s),this.restore()}loadDependencies(s){const l=s.fnArray,p=s.argsArray;for(let x=0,w=l.length;x<w;x++)if(l[x]===M.OPS.dependency)for(const F of p[x]){const P=F.startsWith("g_")?this.commonObjs:this.objs,U=new Promise(J=>{P.get(F,J)});this.current.dependencies.push(U)}return Promise.all(this.current.dependencies)}transform(s,l,p,x,w,F){const P=[s,l,p,x,w,F];this.transformMatrix=M.Util.transform(this.transformMatrix,P),this.tgrp=null}getSVG(s,l){this.viewport=l;const p=this._initialize(l);return this.loadDependencies(s).then(()=>(this.transformMatrix=M.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(s)),p))}convertOpList(s){const l=this._operatorIdMapping,p=s.argsArray,x=s.fnArray,w=[];for(let F=0,P=x.length;F<P;F++){const U=x[F];w.push({fnId:U,fn:l[U],args:p[F]})}return i(w)}executeOpTree(s){for(const l of s){const p=l.fn,x=l.fnId,w=l.args;switch(0|x){case M.OPS.beginText:this.beginText();break;case M.OPS.dependency:break;case M.OPS.setLeading:this.setLeading(w);break;case M.OPS.setLeadingMoveText:this.setLeadingMoveText(w[0],w[1]);break;case M.OPS.setFont:this.setFont(w);break;case M.OPS.showText:case M.OPS.showSpacedText:this.showText(w[0]);break;case M.OPS.endText:this.endText();break;case M.OPS.moveText:this.moveText(w[0],w[1]);break;case M.OPS.setCharSpacing:this.setCharSpacing(w[0]);break;case M.OPS.setWordSpacing:this.setWordSpacing(w[0]);break;case M.OPS.setHScale:this.setHScale(w[0]);break;case M.OPS.setTextMatrix:this.setTextMatrix(w[0],w[1],w[2],w[3],w[4],w[5]);break;case M.OPS.setTextRise:this.setTextRise(w[0]);break;case M.OPS.setTextRenderingMode:this.setTextRenderingMode(w[0]);break;case M.OPS.setLineWidth:this.setLineWidth(w[0]);break;case M.OPS.setLineJoin:this.setLineJoin(w[0]);break;case M.OPS.setLineCap:this.setLineCap(w[0]);break;case M.OPS.setMiterLimit:this.setMiterLimit(w[0]);break;case M.OPS.setFillRGBColor:this.setFillRGBColor(w[0],w[1],w[2]);break;case M.OPS.setStrokeRGBColor:this.setStrokeRGBColor(w[0],w[1],w[2]);break;case M.OPS.setStrokeColorN:this.setStrokeColorN(w);break;case M.OPS.setFillColorN:this.setFillColorN(w);break;case M.OPS.shadingFill:this.shadingFill(w[0]);break;case M.OPS.setDash:this.setDash(w[0],w[1]);break;case M.OPS.setRenderingIntent:this.setRenderingIntent(w[0]);break;case M.OPS.setFlatness:this.setFlatness(w[0]);break;case M.OPS.setGState:this.setGState(w[0]);break;case M.OPS.fill:this.fill();break;case M.OPS.eoFill:this.eoFill();break;case M.OPS.stroke:this.stroke();break;case M.OPS.fillStroke:this.fillStroke();break;case M.OPS.eoFillStroke:this.eoFillStroke();break;case M.OPS.clip:this.clip("nonzero");break;case M.OPS.eoClip:this.clip("evenodd");break;case M.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case M.OPS.paintImageXObject:this.paintImageXObject(w[0]);break;case M.OPS.paintInlineImageXObject:this.paintInlineImageXObject(w[0]);break;case M.OPS.paintImageMaskXObject:this.paintImageMaskXObject(w[0]);break;case M.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(w[0],w[1]);break;case M.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case M.OPS.closePath:this.closePath();break;case M.OPS.closeStroke:this.closeStroke();break;case M.OPS.closeFillStroke:this.closeFillStroke();break;case M.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case M.OPS.nextLine:this.nextLine();break;case M.OPS.transform:this.transform(w[0],w[1],w[2],w[3],w[4],w[5]);break;case M.OPS.constructPath:this.constructPath(w[0],w[1]);break;case M.OPS.endPath:this.endPath();break;case 92:this.group(l.items);break;default:(0,M.warn)(`Unimplemented operator ${p}`)}}}setWordSpacing(s){this.current.wordSpacing=s}setCharSpacing(s){this.current.charSpacing=s}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(s,l,p,x,w,F){const P=this.current;P.textMatrix=P.lineMatrix=[s,l,p,x,w,F],P.textMatrixScale=Math.hypot(s,l),P.x=P.lineX=0,P.y=P.lineY=0,P.xcoords=[],P.ycoords=[],P.tspan=this.svgFactory.createElement("svg:tspan"),P.tspan.setAttributeNS(null,"font-family",P.fontFamily),P.tspan.setAttributeNS(null,"font-size",`${t(P.fontSize)}px`),P.tspan.setAttributeNS(null,"y",t(-P.y)),P.txtElement=this.svgFactory.createElement("svg:text"),P.txtElement.append(P.tspan)}beginText(){const s=this.current;s.x=s.lineX=0,s.y=s.lineY=0,s.textMatrix=M.IDENTITY_MATRIX,s.lineMatrix=M.IDENTITY_MATRIX,s.textMatrixScale=1,s.tspan=this.svgFactory.createElement("svg:tspan"),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtgrp=this.svgFactory.createElement("svg:g"),s.xcoords=[],s.ycoords=[]}moveText(s,l){const p=this.current;p.x=p.lineX+=s,p.y=p.lineY+=l,p.xcoords=[],p.ycoords=[],p.tspan=this.svgFactory.createElement("svg:tspan"),p.tspan.setAttributeNS(null,"font-family",p.fontFamily),p.tspan.setAttributeNS(null,"font-size",`${t(p.fontSize)}px`),p.tspan.setAttributeNS(null,"y",t(-p.y))}showText(s){const l=this.current,p=l.font,x=l.fontSize;if(x===0)return;const w=l.fontSizeScale,F=l.charSpacing,P=l.wordSpacing,U=l.fontDirection,J=l.textHScale*U,V=p.vertical,I=V?1:-1,n=p.defaultVMetrics,a=x*l.fontMatrix[0];let g=0;for(const D of s){if(D===null){g+=U*P;continue}if(typeof D=="number"){g+=I*D*x/1e3;continue}const R=(D.isSpace?P:0)+F,L=D.fontChar;let j,B,$,o=D.width;if(V){let b;const f=D.vmetric||n;b=D.vmetric?f[1]:.5*o,b=-b*a;const k=f[2]*a;o=f?-f[0]:o,j=b/w,B=(g+k)/w}else j=g/w,B=0;(D.isInFont||p.missingFile)&&(l.xcoords.push(l.x+j),V&&l.ycoords.push(-l.y+B),l.tspan.textContent+=L),$=V?o*a-R*U:o*a+R*U,g+=$}l.tspan.setAttributeNS(null,"x",l.xcoords.map(t).join(" ")),V?l.tspan.setAttributeNS(null,"y",l.ycoords.map(t).join(" ")):l.tspan.setAttributeNS(null,"y",t(-l.y)),V?l.y-=g:l.x+=g*J,l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${t(l.fontSize)}px`),l.fontStyle!==N.fontStyle&&l.tspan.setAttributeNS(null,"font-style",l.fontStyle),l.fontWeight!==N.fontWeight&&l.tspan.setAttributeNS(null,"font-weight",l.fontWeight);const S=l.textRenderingMode&M.TextRenderingMode.FILL_STROKE_MASK;if(S===M.TextRenderingMode.FILL||S===M.TextRenderingMode.FILL_STROKE?(l.fillColor!==N.fillColor&&l.tspan.setAttributeNS(null,"fill",l.fillColor),l.fillAlpha<1&&l.tspan.setAttributeNS(null,"fill-opacity",l.fillAlpha)):l.textRenderingMode===M.TextRenderingMode.ADD_TO_PATH?l.tspan.setAttributeNS(null,"fill","transparent"):l.tspan.setAttributeNS(null,"fill","none"),S===M.TextRenderingMode.STROKE||S===M.TextRenderingMode.FILL_STROKE){const D=1/(l.textMatrixScale||1);this._setStrokeAttributes(l.tspan,D)}let T=l.textMatrix;l.textRise!==0&&(T=T.slice(),T[5]+=l.textRise),l.txtElement.setAttributeNS(null,"transform",`${e(T)} scale(${t(J)}, -1)`),l.txtElement.setAttributeNS(u,"xml:space","preserve"),l.txtElement.append(l.tspan),l.txtgrp.append(l.txtElement),this._ensureTransformGroup().append(l.txtElement)}setLeadingMoveText(s,l){this.setLeading(-l),this.moveText(s,l)}addFontStyle(s){if(!s.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const l=E(s.data,s.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${s.loadedName}"; src: url(${l}); }
`}setFont(s){const l=this.current,p=this.commonObjs.get(s[0]);let x=s[1];l.font=p,this.embedFonts&&!p.missingFile&&!this.embeddedFonts[p.loadedName]&&(this.addFontStyle(p),this.embeddedFonts[p.loadedName]=p),l.fontMatrix=p.fontMatrix||M.FONT_IDENTITY_MATRIX;let w="normal";p.black?w="900":p.bold&&(w="bold");const F=p.italic?"italic":"normal";x<0?(x=-x,l.fontDirection=-1):l.fontDirection=1,l.fontSize=x,l.fontFamily=p.loadedName,l.fontWeight=w,l.fontStyle=F,l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"y",t(-l.y)),l.xcoords=[],l.ycoords=[]}endText(){var l;const s=this.current;s.textRenderingMode&M.TextRenderingMode.ADD_TO_PATH_FLAG&&((l=s.txtElement)==null?void 0:l.hasChildNodes())&&(s.element=s.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(s){s>0&&(this.current.lineWidth=s)}setLineCap(s){this.current.lineCap=v[s]}setLineJoin(s){this.current.lineJoin=y[s]}setMiterLimit(s){this.current.miterLimit=s}setStrokeAlpha(s){this.current.strokeAlpha=s}setStrokeRGBColor(s,l,p){this.current.strokeColor=M.Util.makeHexColor(s,l,p)}setFillAlpha(s){this.current.fillAlpha=s}setFillRGBColor(s,l,p){this.current.fillColor=M.Util.makeHexColor(s,l,p),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(s){this.current.strokeColor=this._makeColorN_Pattern(s)}setFillColorN(s){this.current.fillColor=this._makeColorN_Pattern(s)}shadingFill(s){const l=this.viewport.width,p=this.viewport.height,x=M.Util.inverseTransform(this.transformMatrix),w=M.Util.applyTransform([0,0],x),F=M.Util.applyTransform([0,p],x),P=M.Util.applyTransform([l,0],x),U=M.Util.applyTransform([l,p],x),J=Math.min(w[0],F[0],P[0],U[0]),V=Math.min(w[1],F[1],P[1],U[1]),I=Math.max(w[0],F[0],P[0],U[0]),n=Math.max(w[1],F[1],P[1],U[1]),a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x",J),a.setAttributeNS(null,"y",V),a.setAttributeNS(null,"width",I-J),a.setAttributeNS(null,"height",n-V),a.setAttributeNS(null,"fill",this._makeShadingPattern(s)),this.current.fillAlpha<1&&a.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(a)}_makeColorN_Pattern(s){return s[0]==="TilingPattern"?this._makeTilingPattern(s):this._makeShadingPattern(s)}_makeTilingPattern(s){const l=s[1],p=s[2],x=s[3]||M.IDENTITY_MATRIX,[w,F,P,U]=s[4],J=s[5],V=s[6],I=s[7],n="shading"+h++,[a,g,S,T]=M.Util.normalizeRect([...M.Util.applyTransform([w,F],x),...M.Util.applyTransform([P,U],x)]),[D,R]=M.Util.singularValueDecompose2dScale(x),L=J*D,j=V*R,B=this.svgFactory.createElement("svg:pattern");B.setAttributeNS(null,"id",n),B.setAttributeNS(null,"patternUnits","userSpaceOnUse"),B.setAttributeNS(null,"width",L),B.setAttributeNS(null,"height",j),B.setAttributeNS(null,"x",`${a}`),B.setAttributeNS(null,"y",`${g}`);const $=this.svg,o=this.transformMatrix,b=this.current.fillColor,f=this.current.strokeColor,k=this.svgFactory.create(S-a,T-g);if(this.svg=k,this.transformMatrix=x,I===2){const O=M.Util.makeHexColor(...l);this.current.fillColor=O,this.current.strokeColor=O}return this.executeOpTree(this.convertOpList(p)),this.svg=$,this.transformMatrix=o,this.current.fillColor=b,this.current.strokeColor=f,B.append(k.childNodes[0]),this.defs.append(B),`url(#${n})`}_makeShadingPattern(s){switch(typeof s=="string"&&(s=this.objs.get(s)),s[0]){case"RadialAxial":const l="shading"+h++,p=s[3];let x;switch(s[1]){case"axial":const w=s[4],F=s[5];x=this.svgFactory.createElement("svg:linearGradient"),x.setAttributeNS(null,"id",l),x.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),x.setAttributeNS(null,"x1",w[0]),x.setAttributeNS(null,"y1",w[1]),x.setAttributeNS(null,"x2",F[0]),x.setAttributeNS(null,"y2",F[1]);break;case"radial":const P=s[4],U=s[5],J=s[6],V=s[7];x=this.svgFactory.createElement("svg:radialGradient"),x.setAttributeNS(null,"id",l),x.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),x.setAttributeNS(null,"cx",U[0]),x.setAttributeNS(null,"cy",U[1]),x.setAttributeNS(null,"r",V),x.setAttributeNS(null,"fx",P[0]),x.setAttributeNS(null,"fy",P[1]),x.setAttributeNS(null,"fr",J);break;default:throw new Error(`Unknown RadialAxial type: ${s[1]}`)}for(const w of p){const F=this.svgFactory.createElement("svg:stop");F.setAttributeNS(null,"offset",w[0]),F.setAttributeNS(null,"stop-color",w[1]),x.append(F)}return this.defs.append(x),`url(#${l})`;case"Mesh":return(0,M.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${s[0]}`)}}setDash(s,l){this.current.dashArray=s,this.current.dashPhase=l}constructPath(s,l){const p=this.current;let x=p.x,w=p.y,F=[],P=0;for(const U of s)switch(0|U){case M.OPS.rectangle:x=l[P++],w=l[P++];const J=x+l[P++],V=w+l[P++];F.push("M",t(x),t(w),"L",t(J),t(w),"L",t(J),t(V),"L",t(x),t(V),"Z");break;case M.OPS.moveTo:x=l[P++],w=l[P++],F.push("M",t(x),t(w));break;case M.OPS.lineTo:x=l[P++],w=l[P++],F.push("L",t(x),t(w));break;case M.OPS.curveTo:x=l[P+4],w=l[P+5],F.push("C",t(l[P]),t(l[P+1]),t(l[P+2]),t(l[P+3]),t(x),t(w)),P+=6;break;case M.OPS.curveTo2:F.push("C",t(x),t(w),t(l[P]),t(l[P+1]),t(l[P+2]),t(l[P+3])),x=l[P+2],w=l[P+3],P+=4;break;case M.OPS.curveTo3:x=l[P+2],w=l[P+3],F.push("C",t(l[P]),t(l[P+1]),t(x),t(w),t(x),t(w)),P+=4;break;case M.OPS.closePath:F.push("Z")}F=F.join(" "),p.path&&s.length>0&&s[0]!==M.OPS.rectangle&&s[0]!==M.OPS.moveTo?F=p.path.getAttributeNS(null,"d")+F:(p.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(p.path)),p.path.setAttributeNS(null,"d",F),p.path.setAttributeNS(null,"fill","none"),p.element=p.path,p.setCurrentPoint(x,w)}endPath(){const s=this.current;if(s.path=null,!this.pendingClip)return;if(!s.element){this.pendingClip=null;return}const l="clippath"+r++,p=this.svgFactory.createElement("svg:clipPath");p.setAttributeNS(null,"id",l),p.setAttributeNS(null,"transform",e(this.transformMatrix));const x=s.element.cloneNode(!0);if(this.pendingClip==="evenodd"?x.setAttributeNS(null,"clip-rule","evenodd"):x.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,p.append(x),this.defs.append(p),s.activeClipUrl){s.clipGroup=null;for(const w of this.extraStack)w.clipGroup=null;p.setAttributeNS(null,"clip-path",s.activeClipUrl)}s.activeClipUrl=`url(#${l})`,this.tgrp=null}clip(s){this.pendingClip=s}closePath(){const s=this.current;if(s.path){const l=`${s.path.getAttributeNS(null,"d")}Z`;s.path.setAttributeNS(null,"d",l)}}setLeading(s){this.current.leading=-s}setTextRise(s){this.current.textRise=s}setTextRenderingMode(s){this.current.textRenderingMode=s}setHScale(s){this.current.textHScale=s/100}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[l,p]of s)switch(l){case"LW":this.setLineWidth(p);break;case"LC":this.setLineCap(p);break;case"LJ":this.setLineJoin(p);break;case"ML":this.setMiterLimit(p);break;case"D":this.setDash(p[0],p[1]);break;case"RI":this.setRenderingIntent(p);break;case"FL":this.setFlatness(p);break;case"Font":this.setFont(p);break;case"CA":this.setStrokeAlpha(p);break;case"ca":this.setFillAlpha(p);break;default:(0,M.warn)(`Unimplemented graphic state operator ${l}`)}}fill(){const s=this.current;s.element&&(s.element.setAttributeNS(null,"fill",s.fillColor),s.element.setAttributeNS(null,"fill-opacity",s.fillAlpha),this.endPath())}stroke(){const s=this.current;s.element&&(this._setStrokeAttributes(s.element),s.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(s,l=1){const p=this.current;let x=p.dashArray;l!==1&&x.length>0&&(x=x.map(function(w){return l*w})),s.setAttributeNS(null,"stroke",p.strokeColor),s.setAttributeNS(null,"stroke-opacity",p.strokeAlpha),s.setAttributeNS(null,"stroke-miterlimit",t(p.miterLimit)),s.setAttributeNS(null,"stroke-linecap",p.lineCap),s.setAttributeNS(null,"stroke-linejoin",p.lineJoin),s.setAttributeNS(null,"stroke-width",t(l*p.lineWidth)+"px"),s.setAttributeNS(null,"stroke-dasharray",x.map(t).join(" ")),s.setAttributeNS(null,"stroke-dashoffset",t(l*p.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width","1px"),s.setAttributeNS(null,"height","1px"),s.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(s)}paintImageXObject(s){const l=s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s);l?this.paintInlineImageXObject(l):(0,M.warn)(`Dependent image with object ID ${s} is not ready yet`)}paintInlineImageXObject(s,l){const p=s.width,x=s.height,w=W(s,this.forceDataSchema,!!l),F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",t(p)),F.setAttributeNS(null,"height",t(x)),this.current.element=F,this.clip("nonzero");const P=this.svgFactory.createElement("svg:image");P.setAttributeNS(d,"xlink:href",w),P.setAttributeNS(null,"x","0"),P.setAttributeNS(null,"y",t(-x)),P.setAttributeNS(null,"width",t(p)+"px"),P.setAttributeNS(null,"height",t(x)+"px"),P.setAttributeNS(null,"transform",`scale(${t(1/p)} ${t(-1/x)})`),l?l.append(P):this._ensureTransformGroup().append(P)}paintImageMaskXObject(s){const l=this.current,p=s.width,x=s.height,w=l.fillColor;l.maskId="mask"+c++;const F=this.svgFactory.createElement("svg:mask");F.setAttributeNS(null,"id",l.maskId);const P=this.svgFactory.createElement("svg:rect");P.setAttributeNS(null,"x","0"),P.setAttributeNS(null,"y","0"),P.setAttributeNS(null,"width",t(p)),P.setAttributeNS(null,"height",t(x)),P.setAttributeNS(null,"fill",w),P.setAttributeNS(null,"mask",`url(#${l.maskId})`),this.defs.append(F),this._ensureTransformGroup().append(P),this.paintInlineImageXObject(s,F)}paintFormXObjectBegin(s,l){if(Array.isArray(s)&&s.length===6&&this.transform(s[0],s[1],s[2],s[3],s[4],s[5]),l){const p=l[2]-l[0],x=l[3]-l[1],w=this.svgFactory.createElement("svg:rect");w.setAttributeNS(null,"x",l[0]),w.setAttributeNS(null,"y",l[1]),w.setAttributeNS(null,"width",t(p)),w.setAttributeNS(null,"height",t(x)),this.current.element=w,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(s){const l=this.svgFactory.create(s.width,s.height),p=this.svgFactory.createElement("svg:defs");l.append(p),this.defs=p;const x=this.svgFactory.createElement("svg:g");return x.setAttributeNS(null,"transform",e(s.transform)),l.append(x),this.svg=x,l}_ensureClipGroup(){if(!this.current.clipGroup){const s=this.svgFactory.createElement("svg:g");s.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(s),this.current.clipGroup=s}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",e(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFNodeStream=void 0;var _=Y(1),M=Y(33);const q=require$$5,K=require$$5,N=require$$5,u=require$$5,d=/^file:\/\/\/[a-zA-Z]:\//;A.PDFNodeStream=class{constructor(r){this.source=r,this.url=function(h){const s=u.parse(h);return s.protocol==="file:"||s.host?s:/^[a-z]:[/\\]/i.test(h)?u.parse(`file:///${h}`):(s.host||(s.protocol="file:"),s)}(r.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&r.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var r,c;return(c=(r=this._fullRequestReader)==null?void 0:r._loaded)!=null?c:0}getFullReader(){return(0,_.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new i(this):new W(this),this._fullRequestReader}getRangeReader(r,c){if(c<=this._progressiveDataLength)return null;const h=this.isFsUrl?new t(this,r,c):new m(this,r,c);return this._rangeRequestReaders.push(h),h}cancelAllRequests(r){this._fullRequestReader&&this._fullRequestReader.cancel(r);for(const c of this._rangeRequestReaders.slice(0))c.cancel(r)}};class v{constructor(r){this._url=r.url,this._done=!1,this._storedError=null,this.onProgress=null;const c=r.source;this._contentLength=c.length,this._loaded=0,this._filename=null,this._disableRange=c.disableRange||!1,this._rangeChunkSize=c.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!c.disableStream,this._isRangeSupported=!c.disableRange,this._readableStream=null,this._readCapability=(0,_.createPromiseCapability)(),this._headersCapability=(0,_.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const r=this._readableStream.read();return r===null?(this._readCapability=(0,_.createPromiseCapability)(),this.read()):(this._loaded+=r.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(r).buffer,done:!1})}cancel(r){this._readableStream?this._readableStream.destroy(r):this._error(r)}_error(r){this._storedError=r,this._readCapability.resolve()}_setReadableStream(r){this._readableStream=r,r.on("readable",()=>{this._readCapability.resolve()}),r.on("end",()=>{r.destroy(),this._done=!0,this._readCapability.resolve()}),r.on("error",c=>{this._error(c)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new _.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class y{constructor(r){this._url=r.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,_.createPromiseCapability)();const c=r.source;this._isStreamingSupported=!c.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const r=this._readableStream.read();return r===null?(this._readCapability=(0,_.createPromiseCapability)(),this.read()):(this._loaded+=r.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(r).buffer,done:!1})}cancel(r){this._readableStream?this._readableStream.destroy(r):this._error(r)}_error(r){this._storedError=r,this._readCapability.resolve()}_setReadableStream(r){this._readableStream=r,r.on("readable",()=>{this._readCapability.resolve()}),r.on("end",()=>{r.destroy(),this._done=!0,this._readCapability.resolve()}),r.on("error",c=>{this._error(c)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function E(e,r){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:r}}class W extends v{constructor(r){super(r);const c=h=>{if(h.statusCode===404){const x=new _.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=x,this._headersCapability.reject(x);return}this._headersCapability.resolve(),this._setReadableStream(h);const s=x=>this._readableStream.headers[x.toLowerCase()],{allowRangeRequests:l,suggestedLength:p}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:s,isHttp:r.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=p||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(s)};this._request=null,this._url.protocol==="http:"?this._request=K.request(E(this._url,r.httpHeaders),c):this._request=N.request(E(this._url,r.httpHeaders),c),this._request.on("error",h=>{this._storedError=h,this._headersCapability.reject(h)}),this._request.end()}}class m extends y{constructor(r,c,h){super(r),this._httpHeaders={};for(const l in r.httpHeaders){const p=r.httpHeaders[l];p!==void 0&&(this._httpHeaders[l]=p)}this._httpHeaders.Range=`bytes=${c}-${h-1}`;const s=l=>{if(l.statusCode!==404)this._setReadableStream(l);else{const p=new _.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=p}};this._request=null,this._url.protocol==="http:"?this._request=K.request(E(this._url,this._httpHeaders),s):this._request=N.request(E(this._url,this._httpHeaders),s),this._request.on("error",l=>{this._storedError=l}),this._request.end()}}class i extends v{constructor(r){super(r);let c=decodeURIComponent(this._url.path);d.test(this._url.href)&&(c=c.replace(/^\//,"")),q.lstat(c,(h,s)=>{h?(h.code==="ENOENT"&&(h=new _.MissingPDFException(`Missing PDF "${c}".`)),this._storedError=h,this._headersCapability.reject(h)):(this._contentLength=s.size,this._setReadableStream(q.createReadStream(c)),this._headersCapability.resolve())})}}class t extends y{constructor(r,c,h){super(r);let s=decodeURIComponent(this._url.path);d.test(this._url.href)&&(s=s.replace(/^\//,"")),this._setReadableStream(q.createReadStream(s,{start:c,end:h-1}))}}},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.createResponseStatusError=function(N,u){return N===404||N===0&&u.startsWith("file:")?new _.MissingPDFException('Missing PDF "'+u+'".'):new _.UnexpectedResponseException(`Unexpected server response (${N}) while retrieving PDF "${u}".`,N)},A.extractFilenameFromHeader=function(N){const u=N("Content-Disposition");if(u){let d=(0,M.getFilenameFromContentDispositionHeader)(u);if(d.includes("%"))try{d=decodeURIComponent(d)}catch{}if((0,q.isPdfFile)(d))return d}return null},A.validateRangeRequestCapabilities=function({getResponseHeader:N,isHttp:u,rangeChunkSize:d,disableRange:v}){const y={allowRangeRequests:!1,suggestedLength:void 0},E=parseInt(N("Content-Length"),10);return!Number.isInteger(E)||(y.suggestedLength=E,E<=2*d)||v||!u||N("Accept-Ranges")!=="bytes"||(N("Content-Encoding")||"identity")!=="identity"||(y.allowRangeRequests=!0),y},A.validateResponseStatus=function(N){return N===200||N===206};var _=Y(1),M=Y(34),q=Y(4)},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.getFilenameFromContentDispositionHeader=function(q){let K=!0,N=u("filename\\*","i").exec(q);if(N){N=N[1];let m=y(N);return m=unescape(m),m=E(m),m=W(m),v(m)}if(N=function(i){const t=[];let e;const r=u("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(e=r.exec(i))!==null;){let[,h,s,l]=e;if(h=parseInt(h,10),h in t){if(h===0)break}else t[h]=[s,l]}const c=[];for(let h=0;h<t.length&&h in t;++h){let[s,l]=t[h];l=y(l),s&&(l=unescape(l),h===0&&(l=E(l))),c.push(l)}return c.join("")}(q),N)return v(W(N));if(N=u("filename","i").exec(q),N){N=N[1];let m=y(N);return m=W(m),v(m)}function u(m,i){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',i)}function d(m,i){if(m){if(!/^[\x00-\xFF]+$/.test(i))return i;try{const t=new TextDecoder(m,{fatal:!0}),e=(0,_.stringToBytes)(i);i=t.decode(e),K=!1}catch{}}return i}function v(m){return K&&/[\x80-\xff]/.test(m)&&(m=d("utf-8",m),K&&(m=d("iso-8859-1",m))),m}function y(m){if(m.startsWith('"')){const i=m.slice(1).split('\\"');for(let t=0;t<i.length;++t){const e=i[t].indexOf('"');e!==-1&&(i[t]=i[t].slice(0,e),i.length=t+1),i[t]=i[t].replace(/\\(.)/g,"$1")}m=i.join('"')}return m}function E(m){const i=m.indexOf("'");return i===-1?m:d(m.slice(0,i),m.slice(i+1).replace(/^[^']*'/,""))}function W(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(i,t,e,r){if(e==="q"||e==="Q")return d(t,r=(r=r.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,function(c,h){return String.fromCharCode(parseInt(h,16))}));try{r=atob(r)}catch{}return d(t,r)})}return""};var _=Y(1)},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFNetworkStream=void 0;var _=Y(1),M=Y(33);class q{constructor(d,v={}){this.url=d,this.isHttp=/^https?:/i.test(d),this.httpHeaders=this.isHttp&&v.httpHeaders||Object.create(null),this.withCredentials=v.withCredentials||!1,this.getXhr=v.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(d,v,y){const E={begin:d,end:v};for(const W in y)E[W]=y[W];return this.request(E)}requestFull(d){return this.request(d)}request(d){const v=this.getXhr(),y=this.currXhrId++,E=this.pendingRequests[y]={xhr:v};v.open("GET",this.url),v.withCredentials=this.withCredentials;for(const W in this.httpHeaders){const m=this.httpHeaders[W];m!==void 0&&v.setRequestHeader(W,m)}return this.isHttp&&"begin"in d&&"end"in d?(v.setRequestHeader("Range",`bytes=${d.begin}-${d.end-1}`),E.expectedStatus=206):E.expectedStatus=200,v.responseType="arraybuffer",d.onError&&(v.onerror=function(W){d.onError(v.status)}),v.onreadystatechange=this.onStateChange.bind(this,y),v.onprogress=this.onProgress.bind(this,y),E.onHeadersReceived=d.onHeadersReceived,E.onDone=d.onDone,E.onError=d.onError,E.onProgress=d.onProgress,v.send(null),y}onProgress(d,v){var E;const y=this.pendingRequests[d];y&&((E=y.onProgress)==null||E.call(y,v))}onStateChange(d,v){var i,t,e;const y=this.pendingRequests[d];if(!y)return;const E=y.xhr;if(E.readyState>=2&&y.onHeadersReceived&&(y.onHeadersReceived(),delete y.onHeadersReceived),E.readyState!==4||!(d in this.pendingRequests))return;if(delete this.pendingRequests[d],E.status===0&&this.isHttp){(i=y.onError)==null||i.call(y,E.status);return}const W=E.status||200;if(!(W===200&&y.expectedStatus===206)&&W!==y.expectedStatus){(t=y.onError)==null||t.call(y,E.status);return}const m=function(c){const h=c.response;return typeof h!="string"?h:(0,_.stringToBytes)(h).buffer}(E);if(W===206){const r=E.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(r);y.onDone({begin:parseInt(c[1],10),chunk:m})}else m?y.onDone({begin:0,chunk:m}):(e=y.onError)==null||e.call(y,E.status)}getRequestXhr(d){return this.pendingRequests[d].xhr}isPendingRequest(d){return d in this.pendingRequests}abortRequest(d){const v=this.pendingRequests[d].xhr;delete this.pendingRequests[d],v.abort()}}A.PDFNetworkStream=class{constructor(d){this._source=d,this._manager=new q(d.url,{httpHeaders:d.httpHeaders,withCredentials:d.withCredentials}),this._rangeChunkSize=d.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(d){const v=this._rangeRequestReaders.indexOf(d);v>=0&&this._rangeRequestReaders.splice(v,1)}getFullReader(){return(0,_.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new K(this._manager,this._source),this._fullRequestReader}getRangeReader(d,v){const y=new N(this._manager,d,v);return y.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(y),y}cancelAllRequests(d){var v;(v=this._fullRequestReader)==null||v.cancel(d);for(const y of this._rangeRequestReaders.slice(0))y.cancel(d)}};class K{constructor(d,v){this._manager=d;const y={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=v.url,this._fullRequestId=d.requestFull(y),this._headersReceivedCapability=(0,_.createPromiseCapability)(),this._disableRange=v.disableRange||!1,this._contentLength=v.length,this._rangeChunkSize=v.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const d=this._fullRequestId,v=this._manager.getRequestXhr(d),y=m=>v.getResponseHeader(m),{allowRangeRequests:E,suggestedLength:W}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:y,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});E&&(this._isRangeSupported=!0),this._contentLength=W||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(y),this._isRangeSupported&&this._manager.abortRequest(d),this._headersReceivedCapability.resolve()}_onDone(d){if(d&&(this._requests.length>0?this._requests.shift().resolve({value:d.chunk,done:!1}):this._cachedChunks.push(d.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(d){this._storedError=(0,M.createResponseStatusError)(d,this._url),this._headersReceivedCapability.reject(this._storedError);for(const v of this._requests)v.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(d){var v;(v=this.onProgress)==null||v.call(this,{loaded:d.loaded,total:d.lengthComputable?d.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const d=(0,_.createPromiseCapability)();return this._requests.push(d),d.promise}cancel(d){this._done=!0,this._headersReceivedCapability.reject(d);for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class N{constructor(d,v,y){this._manager=d;const E={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=d.url,this._requestId=d.requestRange(v,y,E),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var d;(d=this.onClosed)==null||d.call(this,this)}_onDone(d){const v=d.chunk;this._requests.length>0?this._requests.shift().resolve({value:v,done:!1}):this._queuedChunk=v,this._done=!0;for(const y of this._requests)y.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(d){this._storedError=(0,M.createResponseStatusError)(d,this._url);for(const v of this._requests)v.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(d){var v;this.isStreamingSupported||((v=this.onProgress)==null||v.call(this,{loaded:d.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const v=this._queuedChunk;return this._queuedChunk=null,{value:v,done:!1}}if(this._done)return{value:void 0,done:!0};const d=(0,_.createPromiseCapability)();return this._requests.push(d),d.promise}cancel(d){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(st,A,Y)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFFetchStream=void 0;var _=Y(1),M=Y(33);function q(d,v,y){return{method:"GET",headers:d,signal:y==null?void 0:y.signal,mode:"cors",credentials:v?"include":"same-origin",redirect:"follow"}}function K(d){const v=new Headers;for(const y in d){const E=d[y];E!==void 0&&v.append(y,E)}return v}A.PDFFetchStream=class{constructor(v){this.source=v,this.isHttp=/^https?:/i.test(v.url),this.httpHeaders=this.isHttp&&v.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var v,y;return(y=(v=this._fullRequestReader)==null?void 0:v._loaded)!=null?y:0}getFullReader(){return(0,_.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new N(this),this._fullRequestReader}getRangeReader(v,y){if(y<=this._progressiveDataLength)return null;const E=new u(this,v,y);return this._rangeRequestReaders.push(E),E}cancelAllRequests(v){this._fullRequestReader&&this._fullRequestReader.cancel(v);for(const y of this._rangeRequestReaders.slice(0))y.cancel(v)}};class N{constructor(v){this._stream=v,this._reader=null,this._loaded=0,this._filename=null;const y=v.source;this._withCredentials=y.withCredentials||!1,this._contentLength=y.length,this._headersCapability=(0,_.createPromiseCapability)(),this._disableRange=y.disableRange||!1,this._rangeChunkSize=y.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),typeof AbortController<"u"&&(this._abortController=new AbortController),this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._headers=K(this._stream.httpHeaders);const E=y.url;fetch(E,q(this._headers,this._withCredentials,this._abortController)).then(W=>{if(!(0,M.validateResponseStatus)(W.status))throw(0,M.createResponseStatusError)(W.status,E);this._reader=W.body.getReader(),this._headersCapability.resolve();const m=e=>W.headers.get(e),{allowRangeRequests:i,suggestedLength:t}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:m,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=t||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(m),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new _.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:v,done:y}=await this._reader.read();return y?{value:v,done:y}:(this._loaded+=v.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){this._reader&&this._reader.cancel(v),this._abortController&&this._abortController.abort()}}class u{constructor(v,y,E){this._stream=v,this._reader=null,this._loaded=0;const W=v.source;this._withCredentials=W.withCredentials||!1,this._readCapability=(0,_.createPromiseCapability)(),this._isStreamingSupported=!W.disableStream,typeof AbortController<"u"&&(this._abortController=new AbortController),this._headers=K(this._stream.httpHeaders),this._headers.append("Range",`bytes=${y}-${E-1}`);const m=W.url;fetch(m,q(this._headers,this._withCredentials,this._abortController)).then(i=>{if(!(0,M.validateResponseStatus)(i.status))throw(0,M.createResponseStatusError)(i.status,m);this._readCapability.resolve(),this._reader=i.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:v,done:y}=await this._reader.read();return y?{value:v,done:y}:(this._loaded+=v.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){this._reader&&this._reader.cancel(v),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(st){var A=__webpack_module_cache__[st];if(A!==void 0)return A.exports;var Y=__webpack_module_cache__[st]={exports:{}};return __webpack_modules__[st](Y,Y.exports,__w_pdfjs_require__),Y.exports}var __webpack_exports__={};return(()=>{var st=__webpack_exports__;Object.defineProperty(st,"__esModule",{value:!0}),Object.defineProperty(st,"AnnotationEditorLayer",{enumerable:!0,get:function(){return M.AnnotationEditorLayer}}),Object.defineProperty(st,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return A.AnnotationEditorParamsType}}),Object.defineProperty(st,"AnnotationEditorType",{enumerable:!0,get:function(){return A.AnnotationEditorType}}),Object.defineProperty(st,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return q.AnnotationEditorUIManager}}),Object.defineProperty(st,"AnnotationLayer",{enumerable:!0,get:function(){return K.AnnotationLayer}}),Object.defineProperty(st,"AnnotationMode",{enumerable:!0,get:function(){return A.AnnotationMode}}),Object.defineProperty(st,"CMapCompressionType",{enumerable:!0,get:function(){return A.CMapCompressionType}}),Object.defineProperty(st,"GlobalWorkerOptions",{enumerable:!0,get:function(){return N.GlobalWorkerOptions}}),Object.defineProperty(st,"InvalidPDFException",{enumerable:!0,get:function(){return A.InvalidPDFException}}),Object.defineProperty(st,"LoopbackPort",{enumerable:!0,get:function(){return _.LoopbackPort}}),Object.defineProperty(st,"MissingPDFException",{enumerable:!0,get:function(){return A.MissingPDFException}}),Object.defineProperty(st,"OPS",{enumerable:!0,get:function(){return A.OPS}}),Object.defineProperty(st,"PDFDataRangeTransport",{enumerable:!0,get:function(){return _.PDFDataRangeTransport}}),Object.defineProperty(st,"PDFDateString",{enumerable:!0,get:function(){return Y.PDFDateString}}),Object.defineProperty(st,"PDFWorker",{enumerable:!0,get:function(){return _.PDFWorker}}),Object.defineProperty(st,"PasswordResponses",{enumerable:!0,get:function(){return A.PasswordResponses}}),Object.defineProperty(st,"PermissionFlag",{enumerable:!0,get:function(){return A.PermissionFlag}}),Object.defineProperty(st,"PixelsPerInch",{enumerable:!0,get:function(){return Y.PixelsPerInch}}),Object.defineProperty(st,"RenderingCancelledException",{enumerable:!0,get:function(){return Y.RenderingCancelledException}}),Object.defineProperty(st,"SVGGraphics",{enumerable:!0,get:function(){return v.SVGGraphics}}),Object.defineProperty(st,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return A.UNSUPPORTED_FEATURES}}),Object.defineProperty(st,"UnexpectedResponseException",{enumerable:!0,get:function(){return A.UnexpectedResponseException}}),Object.defineProperty(st,"Util",{enumerable:!0,get:function(){return A.Util}}),Object.defineProperty(st,"VerbosityLevel",{enumerable:!0,get:function(){return A.VerbosityLevel}}),Object.defineProperty(st,"XfaLayer",{enumerable:!0,get:function(){return y.XfaLayer}}),Object.defineProperty(st,"binarySearchFirstItem",{enumerable:!0,get:function(){return Y.binarySearchFirstItem}}),Object.defineProperty(st,"build",{enumerable:!0,get:function(){return _.build}}),Object.defineProperty(st,"createPromiseCapability",{enumerable:!0,get:function(){return A.createPromiseCapability}}),Object.defineProperty(st,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return A.createValidAbsoluteUrl}}),Object.defineProperty(st,"getDocument",{enumerable:!0,get:function(){return _.getDocument}}),Object.defineProperty(st,"getFilenameFromUrl",{enumerable:!0,get:function(){return Y.getFilenameFromUrl}}),Object.defineProperty(st,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return Y.getPdfFilenameFromUrl}}),Object.defineProperty(st,"getXfaPageViewport",{enumerable:!0,get:function(){return Y.getXfaPageViewport}}),Object.defineProperty(st,"isPdfFile",{enumerable:!0,get:function(){return Y.isPdfFile}}),Object.defineProperty(st,"loadScript",{enumerable:!0,get:function(){return Y.loadScript}}),Object.defineProperty(st,"renderTextLayer",{enumerable:!0,get:function(){return d.renderTextLayer}}),Object.defineProperty(st,"shadow",{enumerable:!0,get:function(){return A.shadow}}),Object.defineProperty(st,"version",{enumerable:!0,get:function(){return _.version}});var A=__w_pdfjs_require__(1),Y=__w_pdfjs_require__(4),_=__w_pdfjs_require__(6),M=__w_pdfjs_require__(22),q=__w_pdfjs_require__(9),K=__w_pdfjs_require__(27),N=__w_pdfjs_require__(15),u=__w_pdfjs_require__(3),d=__w_pdfjs_require__(30),v=__w_pdfjs_require__(31),y=__w_pdfjs_require__(29);if(u.isNodeJS){const{PDFNodeStream:E}=__w_pdfjs_require__(32);(0,_.setPDFNetworkStreamFactory)(W=>new E(W))}else{const{PDFNetworkStream:E}=__w_pdfjs_require__(35),{PDFFetchStream:W}=__w_pdfjs_require__(36);(0,_.setPDFNetworkStreamFactory)(m=>(0,Y.isValidFetchUrl)(m.url)?new W(m):new E(m))}})(),__webpack_exports__})())})(pdf_min);const getSubmission=()=>html`
    <div>
      <style>
        ${submissionStyle}
      </style>
      <div class="submission-btns">
        <button type="button" class="btn" id="btnOpen">
          ${constantsMap.open}
        </button>
        <button type="button" class="btn" id="btnDownload">
          ${constantsMap.download}
        </button>
      </div>
      <div class="row justify-content-center mt-5">
        <div id="pdfCanvasContainer">
          <div id="zoom_controls" class="position-absolute m-3">
            <button type="button" class="btn btn-dark btn-sm" id="zoom_in">
              +
            </button>
            <button type="button" class="btn btn-dark btn-sm" id="zoom_out">
              -
            </button>
          </div>
          <canvas id="pdfViewer"></canvas>
        </div>
      </div>
    </div>
  `;function handleDownload(){pdfDownload(getState().submissionContent,getState().identificationData.selectedRequirement.concat("-",getState().identificationData.idNumber))}function handleOpen(){pdfOpen(getState().submissionContent)}async function base64Callback(st){let A=window.atob(st);pdfjsLib.GlobalWorkerOptions.workerSrc=await __vitePreload(()=>import("./pdf.worker.min.8af3a3ba.js").then(_=>_.p),["assets/pdf.worker.min.8af3a3ba.js","assets/pdfGen.e108e65c.js","assets/index.0c0a265e.js","assets/index.db96860a.css"]),pdfjsLib.getDocument({data:A}).promise.then(_=>{_.getPage(1).then(M=>{const K=M.getViewport({scale:1}),N=getElement("canvas#pdfViewer"),u=N.getContext("2d");N.height=K.height,N.width=K.width;const d={canvasContext:u,viewport:K};M.render(d)})})}const submission=()=>{getElement("#app").appendChild(createNode(getSubmission())),pdfBase64Data(getState().submissionContent,base64Callback),getElement("#btnOpen").onclick=handleOpen,getElement("#btnDownload").onclick=handleDownload};export{submission as default};
