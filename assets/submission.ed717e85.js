var Ge=Object.defineProperty;var Xe=(at,_,Q)=>_ in at?Ge(at,_,{enumerable:!0,configurable:!0,writable:!0,value:Q}):at[_]=Q;var Nt=(at,_,Q)=>(Xe(at,typeof _!="symbol"?_+"":_,Q),Q),ae=(at,_,Q)=>{if(!_.has(at))throw TypeError("Cannot "+Q)};var S=(at,_,Q)=>(ae(at,_,"read from private field"),Q?Q.call(at):_.get(at)),rt=(at,_,Q)=>{if(_.has(at))throw TypeError("Cannot add the same private member more than once");_ instanceof WeakSet?_.add(at):_.set(at,Q)},ut=(at,_,Q,b)=>(ae(at,_,"write to private field"),b?b.call(at,Q):_.set(at,Q),Q),oe=(at,_,Q,b)=>({set _(L){ut(at,_,L,Q)},get _(){return S(at,_,b)}}),lt=(at,_,Q)=>(ae(at,_,"access private method"),Q);import{g as getAugmentedNamespace,p as pdfUrlData,a as pdfDownload,b as pdfOpen}from"./pdfGen.b4d644a6.js";import{g as getElement,c as createNode,a as getState}from"./index.319ece6f.js";import require$$1 from"canvas";const submissionStyle=`.submission-btns{display:flex;flex-wrap:wrap;justify-content:center;gap:18px}.submission-btns>button,.submission-btns>button:focus{color:#fff;background-color:#182439;border-color:#182439;opacity:.8;width:150px}.submission-btns>button:hover{opacity:1;color:#fff;background-color:#182439;border-color:#182439}div#iframeContainer{padding:20px;display:flex;flex-wrap:wrap;justify-content:center}div#pdfViewerContainer{background:#333;text-align:center;border:solid 3px;width:100%;height:550px}div#canvasContainer{overflow:auto;width:100%;height:510px}canvas#pdfViewer{max-height:500px}
`,open="Abrir PDF",download="Descarregar PDF",constantsMap={open,download};function commonjsRequire(at){throw new Error('Could not dynamically require "'+at+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(_,Q){module.exports=Q()})(globalThis,()=>(()=>{var __webpack_modules__=[,(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.VerbosityLevel=_.Util=_.UnknownErrorException=_.UnexpectedResponseException=_.UNSUPPORTED_FEATURES=_.TextRenderingMode=_.StreamType=_.RenderingIntentFlag=_.PermissionFlag=_.PasswordResponses=_.PasswordException=_.PageActionEventType=_.OPS=_.MissingPDFException=_.LINE_FACTOR=_.LINE_DESCENT_FACTOR=_.InvalidPDFException=_.ImageKind=_.IDENTITY_MATRIX=_.FormatError=_.FontType=_.FeatureTest=_.FONT_IDENTITY_MATRIX=_.DocumentActionEventType=_.CMapCompressionType=_.BaseException=_.AnnotationType=_.AnnotationStateModelType=_.AnnotationReviewState=_.AnnotationReplyType=_.AnnotationMode=_.AnnotationMarkedState=_.AnnotationFlag=_.AnnotationFieldFlag=_.AnnotationEditorType=_.AnnotationEditorPrefix=_.AnnotationEditorParamsType=_.AnnotationBorderStyleType=_.AnnotationActionEventType=_.AbortException=void 0,_.arrayByteLength=K,_.arraysToBytes=G,_.assert=_t,_.bytesToString=z,_.createPromiseCapability=ct,_.createValidAbsoluteUrl=d,_.escapeString=St,_.getModificationDate=tt,_.getVerbosityLevel=it,_.info=ot,_.isArrayBuffer=$t,_.isArrayEqual=Ot,_.isAscii=kt,_.objectFromMap=pt,_.objectSize=ft,_.setVerbosityLevel=O,_.shadow=o,_.string32=Z,_.stringToBytes=B,_.stringToPDFString=xt,_.stringToUTF16BEString=Rt,_.stringToUTF8String=jt,_.unreachable=mt,_.utf8StringToString=wt,_.warn=ht,Q(2);const b=[1,0,0,1,0,0];_.IDENTITY_MATRIX=b;const L=[.001,0,0,.001,0,0];_.FONT_IDENTITY_MATRIX=L;const Y=1.35;_.LINE_FACTOR=Y;const H=.35;_.LINE_DESCENT_FACTOR=H;const st={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};_.RenderingIntentFlag=st;const j={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};_.AnnotationMode=j;const A="pdfjs_internal_editor_";_.AnnotationEditorPrefix=A;const w={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};_.AnnotationEditorType=w;const F={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};_.AnnotationEditorParamsType=F;const v={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};_.PermissionFlag=v;const C={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};_.TextRenderingMode=C;const c={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};_.ImageKind=c;const t={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};_.AnnotationType=t;const s={MARKED:"Marked",REVIEW:"Review"};_.AnnotationStateModelType=s;const i={MARKED:"Marked",UNMARKED:"Unmarked"};_.AnnotationMarkedState=i;const E={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};_.AnnotationReviewState=E;const p={GROUP:"Group",REPLY:"R"};_.AnnotationReplyType=p;const h={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};_.AnnotationFlag=h;const n={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};_.AnnotationFieldFlag=n;const a={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};_.AnnotationBorderStyleType=a;const f={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};_.AnnotationActionEventType=f;const x={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};_.DocumentActionEventType=x;const T={O:"PageOpen",C:"PageClose"};_.PageActionEventType=T;const P={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};_.StreamType=P;const D={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};_.FontType=D;const J={ERRORS:0,WARNINGS:1,INFOS:5};_.VerbosityLevel=J;const V={NONE:0,BINARY:1,STREAM:2};_.CMapCompressionType=V;const k={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};_.OPS=k;const q={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};_.UNSUPPORTED_FEATURES=q;const y={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};_.PasswordResponses=y;let N=J.WARNINGS;function O($){Number.isInteger($)&&(N=$)}function it(){return N}function ot($){N>=J.INFOS&&console.log(`Info: ${$}`)}function ht($){N>=J.WARNINGS&&console.log(`Warning: ${$}`)}function mt($){throw new Error($)}function _t($,U){$||mt(U)}function R($){if(!$)return!1;switch($.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function d($,U=null,W=null){if(!$)return null;try{if(W&&typeof $=="string"){if(W.addDefaultProtocol&&$.startsWith("www.")){const gt=$.match(/\./g);gt&&gt.length>=2&&($=`http://${$}`)}if(W.tryConvertEncoding)try{$=jt($)}catch{}}const dt=U?new URL($,U):new URL($);if(R(dt))return dt}catch{}return null}function o($,U,W){return Object.defineProperty($,U,{value:W,enumerable:!0,configurable:!0,writable:!1}),W}const m=function(){function U(W,dt){this.constructor===U&&mt("Cannot initialize BaseException."),this.message=W,this.name=dt}return U.prototype=new Error,U.constructor=U,U}();_.BaseException=m;class e extends m{constructor(U,W){super(U,"PasswordException"),this.code=W}}_.PasswordException=e;class r extends m{constructor(U,W){super(U,"UnknownErrorException"),this.details=W}}_.UnknownErrorException=r;class l extends m{constructor(U){super(U,"InvalidPDFException")}}_.InvalidPDFException=l;class u extends m{constructor(U){super(U,"MissingPDFException")}}_.MissingPDFException=u;class g extends m{constructor(U,W){super(U,"UnexpectedResponseException"),this.status=W}}_.UnexpectedResponseException=g;class M extends m{constructor(U){super(U,"FormatError")}}_.FormatError=M;class I extends m{constructor(U){super(U,"AbortException")}}_.AbortException=I;function z($){(typeof $!="object"||$===null||$.length===void 0)&&mt("Invalid argument for bytesToString");const U=$.length,W=8192;if(U<W)return String.fromCharCode.apply(null,$);const dt=[];for(let gt=0;gt<U;gt+=W){const bt=Math.min(gt+W,U),Et=$.subarray(gt,bt);dt.push(String.fromCharCode.apply(null,Et))}return dt.join("")}function B($){typeof $!="string"&&mt("Invalid argument for stringToBytes");const U=$.length,W=new Uint8Array(U);for(let dt=0;dt<U;++dt)W[dt]=$.charCodeAt(dt)&255;return W}function K($){if($.length!==void 0)return $.length;if($.byteLength!==void 0)return $.byteLength;mt("Invalid argument for arrayByteLength")}function G($){const U=$.length;if(U===1&&$[0]instanceof Uint8Array)return $[0];let W=0;for(let bt=0;bt<U;bt++)W+=K($[bt]);let dt=0;const gt=new Uint8Array(W);for(let bt=0;bt<U;bt++){let Et=$[bt];Et instanceof Uint8Array||(typeof Et=="string"?Et=B(Et):Et=new Uint8Array(Et));const Tt=Et.byteLength;gt.set(Et,dt),dt+=Tt}return gt}function Z($){return String.fromCharCode($>>24&255,$>>16&255,$>>8&255,$&255)}function ft($){return Object.keys($).length}function pt($){const U=Object.create(null);for(const[W,dt]of $)U[W]=dt;return U}function At(){const $=new Uint8Array(4);return $[0]=1,new Uint32Array($.buffer,0,1)[0]===1}function nt(){try{return new Function(""),!0}catch{return!1}}class yt{static get isLittleEndian(){return o(this,"isLittleEndian",At())}static get isEvalSupported(){return o(this,"isEvalSupported",nt())}static get isOffscreenCanvasSupported(){return o(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}_.FeatureTest=yt;const X=[...Array(256).keys()].map($=>$.toString(16).padStart(2,"0"));class et{static makeHexColor(U,W,dt){return`#${X[U]}${X[W]}${X[dt]}`}static scaleMinMax(U,W){let dt;U[0]?(U[0]<0&&(dt=W[0],W[0]=W[1],W[1]=dt),W[0]*=U[0],W[1]*=U[0],U[3]<0&&(dt=W[2],W[2]=W[3],W[3]=dt),W[2]*=U[3],W[3]*=U[3]):(dt=W[0],W[0]=W[2],W[2]=dt,dt=W[1],W[1]=W[3],W[3]=dt,U[1]<0&&(dt=W[2],W[2]=W[3],W[3]=dt),W[2]*=U[1],W[3]*=U[1],U[2]<0&&(dt=W[0],W[0]=W[1],W[1]=dt),W[0]*=U[2],W[1]*=U[2]),W[0]+=U[4],W[1]+=U[4],W[2]+=U[5],W[3]+=U[5]}static transform(U,W){return[U[0]*W[0]+U[2]*W[1],U[1]*W[0]+U[3]*W[1],U[0]*W[2]+U[2]*W[3],U[1]*W[2]+U[3]*W[3],U[0]*W[4]+U[2]*W[5]+U[4],U[1]*W[4]+U[3]*W[5]+U[5]]}static applyTransform(U,W){const dt=U[0]*W[0]+U[1]*W[2]+W[4],gt=U[0]*W[1]+U[1]*W[3]+W[5];return[dt,gt]}static applyInverseTransform(U,W){const dt=W[0]*W[3]-W[1]*W[2],gt=(U[0]*W[3]-U[1]*W[2]+W[2]*W[5]-W[4]*W[3])/dt,bt=(-U[0]*W[1]+U[1]*W[0]+W[4]*W[1]-W[5]*W[0])/dt;return[gt,bt]}static getAxialAlignedBoundingBox(U,W){const dt=et.applyTransform(U,W),gt=et.applyTransform(U.slice(2,4),W),bt=et.applyTransform([U[0],U[3]],W),Et=et.applyTransform([U[2],U[1]],W);return[Math.min(dt[0],gt[0],bt[0],Et[0]),Math.min(dt[1],gt[1],bt[1],Et[1]),Math.max(dt[0],gt[0],bt[0],Et[0]),Math.max(dt[1],gt[1],bt[1],Et[1])]}static inverseTransform(U){const W=U[0]*U[3]-U[1]*U[2];return[U[3]/W,-U[1]/W,-U[2]/W,U[0]/W,(U[2]*U[5]-U[4]*U[3])/W,(U[4]*U[1]-U[5]*U[0])/W]}static apply3dTransform(U,W){return[U[0]*W[0]+U[1]*W[1]+U[2]*W[2],U[3]*W[0]+U[4]*W[1]+U[5]*W[2],U[6]*W[0]+U[7]*W[1]+U[8]*W[2]]}static singularValueDecompose2dScale(U){const W=[U[0],U[2],U[1],U[3]],dt=U[0]*W[0]+U[1]*W[2],gt=U[0]*W[1]+U[1]*W[3],bt=U[2]*W[0]+U[3]*W[2],Et=U[2]*W[1]+U[3]*W[3],Tt=(dt+Et)/2,Mt=Math.sqrt((dt+Et)**2-4*(dt*Et-bt*gt))/2,Ft=Tt+Mt||1,Ct=Tt-Mt||1;return[Math.sqrt(Ft),Math.sqrt(Ct)]}static normalizeRect(U){const W=U.slice(0);return U[0]>U[2]&&(W[0]=U[2],W[2]=U[0]),U[1]>U[3]&&(W[1]=U[3],W[3]=U[1]),W}static intersect(U,W){const dt=Math.max(Math.min(U[0],U[2]),Math.min(W[0],W[2])),gt=Math.min(Math.max(U[0],U[2]),Math.max(W[0],W[2]));if(dt>gt)return null;const bt=Math.max(Math.min(U[1],U[3]),Math.min(W[1],W[3])),Et=Math.min(Math.max(U[1],U[3]),Math.max(W[1],W[3]));return bt>Et?null:[dt,bt,gt,Et]}static bezierBoundingBox(U,W,dt,gt,bt,Et,Tt,Mt){const Ft=[],Ct=[[],[]];let It,Dt,Bt,Pt,Lt,qt,Xt,Vt;for(let Yt=0;Yt<2;++Yt){if(Yt===0?(Dt=6*U-12*dt+6*bt,It=-3*U+9*dt-9*bt+3*Tt,Bt=3*dt-3*U):(Dt=6*W-12*gt+6*Et,It=-3*W+9*gt-9*Et+3*Mt,Bt=3*gt-3*W),Math.abs(It)<1e-12){if(Math.abs(Dt)<1e-12)continue;Pt=-Bt/Dt,0<Pt&&Pt<1&&Ft.push(Pt);continue}Xt=Dt*Dt-4*Bt*It,Vt=Math.sqrt(Xt),!(Xt<0)&&(Lt=(-Dt+Vt)/(2*It),0<Lt&&Lt<1&&Ft.push(Lt),qt=(-Dt-Vt)/(2*It),0<qt&&qt<1&&Ft.push(qt))}let zt=Ft.length,Ut;const Ht=zt;for(;zt--;)Pt=Ft[zt],Ut=1-Pt,Ct[0][zt]=Ut*Ut*Ut*U+3*Ut*Ut*Pt*dt+3*Ut*Pt*Pt*bt+Pt*Pt*Pt*Tt,Ct[1][zt]=Ut*Ut*Ut*W+3*Ut*Ut*Pt*gt+3*Ut*Pt*Pt*Et+Pt*Pt*Pt*Mt;return Ct[0][Ht]=U,Ct[1][Ht]=W,Ct[0][Ht+1]=Tt,Ct[1][Ht+1]=Mt,Ct[0].length=Ct[1].length=Ht+2,[Math.min(...Ct[0]),Math.min(...Ct[1]),Math.max(...Ct[0]),Math.max(...Ct[1])]}}_.Util=et;const vt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function xt($){if($[0]>="\xEF"){let W;if($[0]==="\xFE"&&$[1]==="\xFF"?W="utf-16be":$[0]==="\xFF"&&$[1]==="\xFE"?W="utf-16le":$[0]==="\xEF"&&$[1]==="\xBB"&&$[2]==="\xBF"&&(W="utf-8"),W)try{const dt=new TextDecoder(W,{fatal:!0}),gt=B($);return dt.decode(gt)}catch(dt){ht(`stringToPDFString: "${dt}".`)}}const U=[];for(let W=0,dt=$.length;W<dt;W++){const gt=vt[$.charCodeAt(W)];U.push(gt?String.fromCharCode(gt):$.charAt(W))}return U.join("")}function St($){return $.replace(/([()\\\n\r])/g,U=>U===`
`?"\\n":U==="\r"?"\\r":`\\${U}`)}function kt($){return/^[\x00-\x7F]*$/.test($)}function Rt($){const U=["\xFE\xFF"];for(let W=0,dt=$.length;W<dt;W++){const gt=$.charCodeAt(W);U.push(String.fromCharCode(gt>>8&255),String.fromCharCode(gt&255))}return U.join("")}function jt($){return decodeURIComponent(escape($))}function wt($){return unescape(encodeURIComponent($))}function $t($){return typeof $=="object"&&$!==null&&$.byteLength!==void 0}function Ot($,U){if($.length!==U.length)return!1;for(let W=0,dt=$.length;W<dt;W++)if($[W]!==U[W])return!1;return!0}function tt($=new Date){return[$.getUTCFullYear().toString(),($.getUTCMonth()+1).toString().padStart(2,"0"),$.getUTCDate().toString().padStart(2,"0"),$.getUTCHours().toString().padStart(2,"0"),$.getUTCMinutes().toString().padStart(2,"0"),$.getUTCSeconds().toString().padStart(2,"0")].join("")}function ct(){const $=Object.create(null);let U=!1;return Object.defineProperty($,"settled",{get(){return U}}),$.promise=new Promise(function(W,dt){$.resolve=function(gt){U=!0,W(gt)},$.reject=function(gt){U=!0,dt(gt)}}),$}},(at,_,Q)=>{Q(3)},(at,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.isNodeJS=void 0;const Q=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");_.isNodeJS=Q},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.StatTimer=_.RenderingCancelledException=_.PixelsPerInch=_.PageViewport=_.PDFDateString=_.DOMStandardFontDataFactory=_.DOMSVGFactory=_.DOMCanvasFactory=_.DOMCMapReaderFactory=void 0,_.binarySearchFirstItem=D,_.deprecated=n,_.getColorValues=P,_.getFilenameFromUrl=s,_.getPdfFilenameFromUrl=i,_.getRGB=T,_.getXfaPageViewport=x,_.isDataScheme=c,_.isPdfFile=t,_.isValidFetchUrl=p,_.loadScript=h;var b=Q(5),L=Q(1);const Y="http://www.w3.org/2000/svg",J=class{};let H=J;Nt(H,"CSS",96),Nt(H,"PDF",72),Nt(H,"PDF_TO_CSS_UNITS",J.CSS/J.PDF),_.PixelsPerInch=H;class st extends b.BaseCanvasFactory{constructor({ownerDocument:k=globalThis.document}={}){super(),this._document=k}_createCanvas(k,q){const y=this._document.createElement("canvas");return y.width=k,y.height=q,y}}_.DOMCanvasFactory=st;async function j(V,k=!1){if(p(V,document.baseURI)){const q=await fetch(V);if(!q.ok)throw new Error(q.statusText);return k?new Uint8Array(await q.arrayBuffer()):(0,L.stringToBytes)(await q.text())}return new Promise((q,y)=>{const N=new XMLHttpRequest;N.open("GET",V,!0),k&&(N.responseType="arraybuffer"),N.onreadystatechange=()=>{if(N.readyState===XMLHttpRequest.DONE){if(N.status===200||N.status===0){let O;if(k&&N.response?O=new Uint8Array(N.response):!k&&N.responseText&&(O=(0,L.stringToBytes)(N.responseText)),O){q(O);return}}y(new Error(N.statusText))}},N.send(null)})}class A extends b.BaseCMapReaderFactory{_fetchData(k,q){return j(k,this.isCompressed).then(y=>({cMapData:y,compressionType:q}))}}_.DOMCMapReaderFactory=A;class w extends b.BaseStandardFontDataFactory{_fetchData(k){return j(k,!0)}}_.DOMStandardFontDataFactory=w;class F extends b.BaseSVGFactory{_createSVG(k){return document.createElementNS(Y,k)}}_.DOMSVGFactory=F;class v{constructor({viewBox:k,scale:q,rotation:y,offsetX:N=0,offsetY:O=0,dontFlip:it=!1}){this.viewBox=k,this.scale=q,this.rotation=y,this.offsetX=N,this.offsetY=O;const ot=(k[2]+k[0])/2,ht=(k[3]+k[1])/2;let mt,_t,R,d;switch(y%=360,y<0&&(y+=360),y){case 180:mt=-1,_t=0,R=0,d=1;break;case 90:mt=0,_t=1,R=1,d=0;break;case 270:mt=0,_t=-1,R=-1,d=0;break;case 0:mt=1,_t=0,R=0,d=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}it&&(R=-R,d=-d);let o,m,e,r;mt===0?(o=Math.abs(ht-k[1])*q+N,m=Math.abs(ot-k[0])*q+O,e=Math.abs(k[3]-k[1])*q,r=Math.abs(k[2]-k[0])*q):(o=Math.abs(ot-k[0])*q+N,m=Math.abs(ht-k[1])*q+O,e=Math.abs(k[2]-k[0])*q,r=Math.abs(k[3]-k[1])*q),this.transform=[mt*q,_t*q,R*q,d*q,o-mt*q*ot-R*q*ht,m-_t*q*ot-d*q*ht],this.width=e,this.height=r}clone({scale:k=this.scale,rotation:q=this.rotation,offsetX:y=this.offsetX,offsetY:N=this.offsetY,dontFlip:O=!1}={}){return new v({viewBox:this.viewBox.slice(),scale:k,rotation:q,offsetX:y,offsetY:N,dontFlip:O})}convertToViewportPoint(k,q){return L.Util.applyTransform([k,q],this.transform)}convertToViewportRectangle(k){const q=L.Util.applyTransform([k[0],k[1]],this.transform),y=L.Util.applyTransform([k[2],k[3]],this.transform);return[q[0],q[1],y[0],y[1]]}convertToPdfPoint(k,q){return L.Util.applyInverseTransform([k,q],this.transform)}}_.PageViewport=v;class C extends L.BaseException{constructor(k,q){super(k,"RenderingCancelledException"),this.type=q}}_.RenderingCancelledException=C;function c(V){const k=V.length;let q=0;for(;q<k&&V[q].trim()==="";)q++;return V.substring(q,q+5).toLowerCase()==="data:"}function t(V){return typeof V=="string"&&/\.pdf$/i.test(V)}function s(V){const k=V.indexOf("#"),q=V.indexOf("?"),y=Math.min(k>0?k:V.length,q>0?q:V.length);return V.substring(V.lastIndexOf("/",y)+1,y)}function i(V,k="document.pdf"){if(typeof V!="string")return k;if(c(V))return(0,L.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),k;const q=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,y=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,N=q.exec(V);let O=y.exec(N[1])||y.exec(N[2])||y.exec(N[3]);if(O&&(O=O[0],O.includes("%")))try{O=y.exec(decodeURIComponent(O))[0]}catch{}return O||k}class E{constructor(){this.started=Object.create(null),this.times=[]}time(k){k in this.started&&(0,L.warn)(`Timer is already running for ${k}`),this.started[k]=Date.now()}timeEnd(k){k in this.started||(0,L.warn)(`Timer has not been started for ${k}`),this.times.push({name:k,start:this.started[k],end:Date.now()}),delete this.started[k]}toString(){const k=[];let q=0;for(const y of this.times){const N=y.name;N.length>q&&(q=N.length)}for(const y of this.times){const N=y.end-y.start;k.push(`${y.name.padEnd(q)} ${N}ms
`)}return k.join("")}}_.StatTimer=E;function p(V,k){try{const{protocol:q}=k?new URL(V,k):new URL(V);return q==="http:"||q==="https:"}catch{return!1}}function h(V,k=!1){return new Promise((q,y)=>{const N=document.createElement("script");N.src=V,N.onload=function(O){k&&N.remove(),q(O)},N.onerror=function(){y(new Error(`Cannot load script at: ${N.src}`))},(document.head||document.documentElement).append(N)})}function n(V){console.log("Deprecated API usage: "+V)}let a;class f{static toDateObject(k){if(!k||typeof k!="string")return null;a||(a=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const q=a.exec(k);if(!q)return null;const y=parseInt(q[1],10);let N=parseInt(q[2],10);N=N>=1&&N<=12?N-1:0;let O=parseInt(q[3],10);O=O>=1&&O<=31?O:1;let it=parseInt(q[4],10);it=it>=0&&it<=23?it:0;let ot=parseInt(q[5],10);ot=ot>=0&&ot<=59?ot:0;let ht=parseInt(q[6],10);ht=ht>=0&&ht<=59?ht:0;const mt=q[7]||"Z";let _t=parseInt(q[8],10);_t=_t>=0&&_t<=23?_t:0;let R=parseInt(q[9],10)||0;return R=R>=0&&R<=59?R:0,mt==="-"?(it+=_t,ot+=R):mt==="+"&&(it-=_t,ot-=R),new Date(Date.UTC(y,N,O,it,ot,ht))}}_.PDFDateString=f;function x(V,{scale:k=1,rotation:q=0}){const{width:y,height:N}=V.attributes.style,O=[0,0,parseInt(y),parseInt(N)];return new v({viewBox:O,scale:k,rotation:q})}function T(V){if(V.startsWith("#")){const k=parseInt(V.slice(1),16);return[(k&16711680)>>16,(k&65280)>>8,k&255]}return V.startsWith("rgb(")?V.slice(4,-1).split(",").map(k=>parseInt(k)):V.startsWith("rgba(")?V.slice(5,-1).split(",").map(k=>parseInt(k)).slice(0,3):((0,L.warn)(`Not a valid color format: "${V}"`),[0,0,0])}function P(V){const k=document.createElement("span");k.style.visibility="hidden",document.body.append(k);for(const q of V.keys()){k.style.color=q;const y=window.getComputedStyle(k).color;V.set(q,T(y))}k.remove()}function D(V,k,q=0){let y=q,N=V.length-1;if(N<0||!k(V[N]))return V.length;if(k(V[y]))return y;for(;y<N;){const O=y+N>>1,it=V[O];k(it)?N=O:y=O+1}return y}},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.BaseStandardFontDataFactory=_.BaseSVGFactory=_.BaseCanvasFactory=_.BaseCMapReaderFactory=void 0;var b=Q(1);class L{constructor(){this.constructor===L&&(0,b.unreachable)("Cannot initialize BaseCanvasFactory.")}create(A,w){if(A<=0||w<=0)throw new Error("Invalid canvas size");const F=this._createCanvas(A,w);return{canvas:F,context:F.getContext("2d")}}reset(A,w,F){if(!A.canvas)throw new Error("Canvas is not specified");if(w<=0||F<=0)throw new Error("Invalid canvas size");A.canvas.width=w,A.canvas.height=F}destroy(A){if(!A.canvas)throw new Error("Canvas is not specified");A.canvas.width=0,A.canvas.height=0,A.canvas=null,A.context=null}_createCanvas(A,w){(0,b.unreachable)("Abstract method `_createCanvas` called.")}}_.BaseCanvasFactory=L;class Y{constructor({baseUrl:A=null,isCompressed:w=!1}){this.constructor===Y&&(0,b.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=A,this.isCompressed=w}async fetch({name:A}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!A)throw new Error("CMap name must be specified.");const w=this.baseUrl+A+(this.isCompressed?".bcmap":""),F=this.isCompressed?b.CMapCompressionType.BINARY:b.CMapCompressionType.NONE;return this._fetchData(w,F).catch(v=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${w}`)})}_fetchData(A,w){(0,b.unreachable)("Abstract method `_fetchData` called.")}}_.BaseCMapReaderFactory=Y;class H{constructor({baseUrl:A=null}){this.constructor===H&&(0,b.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=A}async fetch({filename:A}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!A)throw new Error("Font filename must be specified.");const w=`${this.baseUrl}${A}`;return this._fetchData(w).catch(F=>{throw new Error(`Unable to load font data at: ${w}`)})}_fetchData(A){(0,b.unreachable)("Abstract method `_fetchData` called.")}}_.BaseStandardFontDataFactory=H;class st{constructor(){this.constructor===st&&(0,b.unreachable)("Cannot initialize BaseSVGFactory.")}create(A,w,F=!1){if(A<=0||w<=0)throw new Error("Invalid SVG dimensions");const v=this._createSVG("svg:svg");return v.setAttribute("version","1.1"),F||(v.setAttribute("width",`${A}px`),v.setAttribute("height",`${w}px`)),v.setAttribute("preserveAspectRatio","none"),v.setAttribute("viewBox",`0 0 ${A} ${w}`),v}createElement(A){if(typeof A!="string")throw new Error("Invalid SVG element type");return this._createSVG(A)}_createSVG(A){(0,b.unreachable)("Abstract method `_createSVG` called.")}}_.BaseSVGFactory=st},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var at,Q,b,L,Y,H,st,j,A,le,F,v;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(7),_display_utils=__w_pdfjs_require__(4),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:c,NodeCMapReaderFactory:t,NodeStandardFontDataFactory:s}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=c,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=t,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=s}let createPDFNetworkStream;function setPDFNetworkStreamFactory(c){createPDFNetworkStream=c}function getDocument(c){const t=new PDFDocumentLoadingTask;let s;if(typeof c=="string"||c instanceof URL)s={url:c};else if((0,_util.isArrayBuffer)(c))s={data:c};else if(c instanceof PDFDataRangeTransport)s={range:c};else{if(typeof c!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!c.url&&!c.data&&!c.range)throw new Error("Invalid parameter object: need either .data, .range or .url");s=c}const i=Object.create(null);let E=null,p=null;for(const n in s){const a=s[n];switch(n){case"url":if(typeof window<"u")try{i[n]=new URL(a,window.location).href;continue}catch(f){(0,_util.warn)(`Cannot create valid URL: "${f}".`)}else if(typeof a=="string"||a instanceof URL){i[n]=a.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":E=a;continue;case"worker":p=a;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&a instanceof Buffer)i[n]=new Uint8Array(a);else{if(a instanceof Uint8Array)break;if(typeof a=="string")i[n]=(0,_util.stringToBytes)(a);else if(typeof a=="object"&&a!==null&&!isNaN(a.length))i[n]=new Uint8Array(a);else if((0,_util.isArrayBuffer)(a))i[n]=new Uint8Array(a);else throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.")}continue}i[n]=a}if(i.CMapReaderFactory=i.CMapReaderFactory||DefaultCMapReaderFactory,i.StandardFontDataFactory=i.StandardFontDataFactory||DefaultStandardFontDataFactory,i.ignoreErrors=i.stopAtErrors!==!0,i.fontExtraProperties=i.fontExtraProperties===!0,i.pdfBug=i.pdfBug===!0,i.enableXfa=i.enableXfa===!0,(!Number.isInteger(i.rangeChunkSize)||i.rangeChunkSize<1)&&(i.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof i.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(i.docBaseUrl))&&(i.docBaseUrl=null),(!Number.isInteger(i.maxImageSize)||i.maxImageSize<-1)&&(i.maxImageSize=-1),typeof i.cMapUrl!="string"&&(i.cMapUrl=null),typeof i.standardFontDataUrl!="string"&&(i.standardFontDataUrl=null),typeof i.useWorkerFetch!="boolean"&&(i.useWorkerFetch=i.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&i.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof i.isEvalSupported!="boolean"&&(i.isEvalSupported=!0),typeof i.disableFontFace!="boolean"&&(i.disableFontFace=_is_node.isNodeJS),typeof i.useSystemFonts!="boolean"&&(i.useSystemFonts=!_is_node.isNodeJS&&!i.disableFontFace),(typeof i.ownerDocument!="object"||i.ownerDocument===null)&&(i.ownerDocument=globalThis.document),typeof i.disableRange!="boolean"&&(i.disableRange=!1),typeof i.disableStream!="boolean"&&(i.disableStream=!1),typeof i.disableAutoFetch!="boolean"&&(i.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(i.verbosity),!p){const n={verbosity:i.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};p=n.port?PDFWorker.fromPort(n):new PDFWorker(n),t._worker=p}const h=t.docId;return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const n=_fetchDocument(p,i,E,h),a=new Promise(function(f){let x;E?x=new _transport_stream.PDFDataTransportStream({length:i.length,initialData:i.initialData,progressiveDone:i.progressiveDone,contentDispositionFilename:i.contentDispositionFilename,disableRange:i.disableRange,disableStream:i.disableStream},E):i.data||(x=createPDFNetworkStream({url:i.url,length:i.length,httpHeaders:i.httpHeaders,withCredentials:i.withCredentials,rangeChunkSize:i.rangeChunkSize,disableRange:i.disableRange,disableStream:i.disableStream})),f(x)});return Promise.all([n,a]).then(function([f,x]){if(t.destroyed)throw new Error("Loading aborted");const T=new _message_handler.MessageHandler(h,f,p.port),P=new WorkerTransport(T,t,x,i);t._transport=P,T.send("Ready",null)})}).catch(t._capability.reject),t}async function _fetchDocument(c,t,s,i){if(c.destroyed)throw new Error("Worker was destroyed");s&&(t.length=s.length,t.initialData=s.initialData,t.progressiveDone=s.progressiveDone,t.contentDispositionFilename=s.contentDispositionFilename);const E=await c.messageHandler.sendWithPromise("GetDocRequest",{docId:i,apiVersion:"2.15.349",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,docBaseUrl:t.docBaseUrl,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported,fontExtraProperties:t.fontExtraProperties,enableXfa:t.enableXfa,useSystemFonts:t.useSystemFonts,cMapUrl:t.useWorkerFetch?t.cMapUrl:null,standardFontDataUrl:t.useWorkerFetch?t.standardFontDataUrl:null});if(t.data&&(t.data=null),c.destroyed)throw new Error("Worker was destroyed");return E}const _=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${oe(_,at)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var t;this.destroyed=!0,await((t=this._transport)==null?void 0:t.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=_;at=new WeakMap,rt(PDFDocumentLoadingTask,at,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,s,i=!1,E=null){this.length=t,this.initialData=s,this.progressiveDone=i,this.contentDispositionFilename=E,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,s){for(const i of this._rangeListeners)i(t,s)}onDataProgress(t,s){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(t,s)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const s of this._progressiveReadListeners)s(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,s){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,s){this._pdfInfo=t,this._transport=s,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(t,s,i,E,p=!1){this._pageIndex=t,this._pageInfo=s,this._ownerDocument=E,this._transport=i,this._stats=p?new _display_utils.StatTimer:null,this._pdfBug=p,this.commonObjs=i.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:s=this.rotate,offsetX:i=0,offsetY:E=0,dontFlip:p=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:s,offsetX:i,offsetY:E,dontFlip:p})}getAnnotations({intent:t="display"}={}){const s=this._transport.getRenderingIntent(t);let i=this._annotationPromises.get(s.cacheKey);return i||(i=this._transport.getAnnotations(this._pageIndex,s.renderingIntent),this._annotationPromises.set(s.cacheKey,i),i=i.then(E=>{for(const p of E)p.titleObj!==void 0&&Object.defineProperty(p,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),p.titleObj.str}}),p.contentsObj!==void 0&&Object.defineProperty(p,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),p.contentsObj.str}});return E})),i}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:s,intent:i="display",annotationMode:E=_util.AnnotationMode.ENABLE,transform:p=null,imageLayer:h=null,canvasFactory:n=null,background:a=null,optionalContentConfigPromise:f=null,annotationCanvasMap:x=null,pageColors:T=null,printAnnotationStorage:P=null}){var O,it;((O=arguments[0])==null?void 0:O.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&E===_util.AnnotationMode.ENABLE&&(E=_util.AnnotationMode.ENABLE_FORMS)),((it=arguments[0])==null?void 0:it.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&E===_util.AnnotationMode.ENABLE&&(E=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const D=this._transport.getRenderingIntent(i,E,P);this.pendingCleanup=!1,f||(f=this._transport.getOptionalContentConfig());let J=this._intentStates.get(D.cacheKey);J||(J=Object.create(null),this._intentStates.set(D.cacheKey,J)),J.streamReaderCancelTimeout&&(clearTimeout(J.streamReaderCancelTimeout),J.streamReaderCancelTimeout=null);const V=n||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),k=!!(D.renderingIntent&_util.RenderingIntentFlag.PRINT);J.displayReadyCapability||(J.displayReadyCapability=(0,_util.createPromiseCapability)(),J.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(D));const q=ot=>{J.renderTasks.delete(y),(this.cleanupAfterRender||k)&&(this.pendingCleanup=!0),this._tryCleanup(),ot?(y.capability.reject(ot),this._abortOperatorList({intentState:J,reason:ot instanceof Error?ot:new Error(ot)})):y.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},y=new InternalRenderTask({callback:q,params:{canvasContext:t,viewport:s,transform:p,imageLayer:h,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:x,operatorList:J.operatorList,pageIndex:this._pageIndex,canvasFactory:V,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:T});(J.renderTasks||(J.renderTasks=new Set)).add(y);const N=y.task;return Promise.all([J.displayReadyCapability.promise,f]).then(([ot,ht])=>{if(this.pendingCleanup){q();return}this._stats&&this._stats.time("Rendering"),y.initializeGraphics({transparency:ot,optionalContentConfig:ht}),y.operatorListChanged()}).catch(q),N}getOperatorList({intent:t="display",annotationMode:s=_util.AnnotationMode.ENABLE,printAnnotationStorage:i=null}={}){function E(){h.operatorList.lastChunk&&(h.opListReadCapability.resolve(h.operatorList),h.renderTasks.delete(n))}const p=this._transport.getRenderingIntent(t,s,i,!0);let h=this._intentStates.get(p.cacheKey);h||(h=Object.create(null),this._intentStates.set(p.cacheKey,h));let n;return h.opListReadCapability||(n=Object.create(null),n.operatorListChanged=E,h.opListReadCapability=(0,_util.createPromiseCapability)(),(h.renderTasks||(h.renderTasks=new Set)).add(n),h.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(p)),h.opListReadCapability.promise}streamTextContent({disableCombineTextItems:t=!1,includeMarkedContent:s=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:t!==!0,includeMarkedContent:s===!0},{highWaterMark:100,size(E){return E.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>_xfa_text.XfaText.textContent(i));const s=this.streamTextContent(t);return new Promise(function(i,E){function p(){h.read().then(function({value:a,done:f}){if(f){i(n);return}Object.assign(n.styles,a.styles),n.items.push(...a.items),p()},E)}const h=s.getReader(),n={items:[],styles:Object.create(null)};p()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const t=[];for(const s of this._intentStates.values())if(this._abortOperatorList({intentState:s,reason:new Error("Page was destroyed."),force:!0}),!s.opListReadCapability)for(const i of s.renderTasks)t.push(i.completed),i.cancel();this.objs.clear();for(const s of this._bitmaps)s.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(t)}cleanup(t=!1){return this.pendingCleanup=!0,this._tryCleanup(t)}_tryCleanup(t=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:s,operatorList:i}of this._intentStates.values())if(s.size>0||!i.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,t&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const s of this._bitmaps)s.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(t,s){const i=this._intentStates.get(s);!i||(this._stats&&this._stats.timeEnd("Page Request"),i.displayReadyCapability&&i.displayReadyCapability.resolve(t))}_renderPageChunk(t,s){for(let i=0,E=t.length;i<E;i++)s.operatorList.fnArray.push(t.fnArray[i]),s.operatorList.argsArray.push(t.argsArray[i]);s.operatorList.lastChunk=t.lastChunk,s.operatorList.separateAnnots=t.separateAnnots;for(const i of s.renderTasks)i.operatorListChanged();t.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:t,cacheKey:s,annotationStorageMap:i}){const p=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:s,annotationStorage:i}).getReader(),h=this._intentStates.get(s);h.streamReader=p;const n=()=>{p.read().then(({value:a,done:f})=>{if(f){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(a,h),n())},a=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const f of h.renderTasks)f.operatorListChanged();this._tryCleanup()}if(h.displayReadyCapability)h.displayReadyCapability.reject(a);else if(h.opListReadCapability)h.opListReadCapability.reject(a);else throw a}})};n()}_abortOperatorList({intentState:t,reason:s,force:i=!1}){if(!!t.streamReader){if(!i){if(t.renderTasks.size>0)return;if(s instanceof _display_utils.RenderingCancelledException){t.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:t,reason:s,force:!0}),t.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(t.streamReader.cancel(new _util.AbortException(s.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[E,p]of this._intentStates)if(p===t){this._intentStates.delete(E);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(t,s){const i={data:structuredClone(t,s)};this._deferred.then(()=>{for(const E of this._listeners)E.call(this,i)})}addEventListener(t,s){this._listeners.push(s)}removeEventListener(t,s){const i=this._listeners.indexOf(s);this._listeners.splice(i,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const c=(Q=document==null?void 0:document.currentScript)==null?void 0:Q.src;c&&(PDFWorkerUtil.fallbackWorkerSrc=c.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(c,t){let s;try{if(s=new URL(c),!s.origin||s.origin==="null")return!1}catch{return!1}const i=new URL(t,s);return s.origin===i.origin},PDFWorkerUtil.createCDNWrapper=function(c){const t=`importScripts("${c}");`;return URL.createObjectURL(new Blob([t]))}}const _PDFWorker=class{constructor({name:c=null,port:t=null,verbosity:s=(0,_util.getVerbosityLevel)()}={}){if(t&&S(_PDFWorker,b).has(t))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=c,this.destroyed=!1,this.verbosity=s,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t){S(_PDFWorker,b).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(c){this._port=c,this._messageHandler=new _message_handler.MessageHandler("main","worker",c),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(typeof Worker<"u"&&!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let c=_PDFWorker.workerSrc;try{PDFWorkerUtil.isSameOrigin(window.location.href,c)||(c=PDFWorkerUtil.createCDNWrapper(new URL(c,window.location).href));const t=new Worker(c),s=new _message_handler.MessageHandler("main","worker",t),i=()=>{t.removeEventListener("error",E),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},E=()=>{this._webWorker||i()};t.addEventListener("error",E),s.on("test",h=>{if(t.removeEventListener("error",E),this.destroyed){i();return}h?(this._messageHandler=s,this._port=t,this._webWorker=t,this._readyCapability.resolve(),s.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),s.destroy(),t.terminate())}),s.on("ready",h=>{if(t.removeEventListener("error",E),this.destroyed){i();return}try{p()}catch{this._setupFakeWorker()}});const p=()=>{const h=new Uint8Array;s.send("test",h,[h.buffer])};p();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(c=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const s=`fake${PDFWorkerUtil.fakeWorkerId++}`,i=new _message_handler.MessageHandler(s+"_worker",s,t);c.setup(i,t);const E=new _message_handler.MessageHandler(s,s+"_worker",t);this._messageHandler=E,this._readyCapability.resolve(),E.send("configure",{verbosity:this.verbosity})}).catch(c=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${c.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),S(_PDFWorker,b).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(c){if(!(c!=null&&c.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return S(this,b).has(c.port)?S(this,b).get(c.port):new _PDFWorker(c)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var c;try{return((c=globalThis.pdfjsWorker)==null?void 0:c.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;b=new WeakMap,rt(PDFWorker,b,new WeakMap),exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(t,s,i,E){rt(this,L,null);rt(this,Y,new Map);rt(this,H,new Map);rt(this,st,null);this.messageHandler=t,this.loadingTask=s,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:s.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:E.ownerDocument,styleElement:E.styleElement}),this._params=E,E.useWorkerFetch||(this.CMapReaderFactory=new E.CMapReaderFactory({baseUrl:E.cMapUrl,isCompressed:E.cMapPacked}),this.StandardFontDataFactory=new E.StandardFontDataFactory({baseUrl:E.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return S(this,L)}getRenderingIntent(t,s=_util.AnnotationMode.ENABLE,i=null,E=!1){let p=_util.RenderingIntentFlag.DISPLAY,h=null;switch(t){case"any":p=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":p=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(s){case _util.AnnotationMode.DISABLE:p+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:p+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:p+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,h=(p&_util.RenderingIntentFlag.PRINT&&i instanceof _annotation_storage.PrintAnnotationStorage?i:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${s}`)}return E&&(p+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:p,cacheKey:`${p}_${_annotation_storage.AnnotationStorage.getHash(h)}`,annotationStorageMap:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of S(this,Y).values())t.push(i._destroy());S(this,Y).clear(),S(this,H).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const s=this.messageHandler.sendWithPromise("Terminate",null);return t.push(s),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),ut(this,st,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:s}=this;t.on("GetReader",(i,E)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=p=>{this._lastProgress={loaded:p.loaded,total:p.total}},E.onPull=()=>{this._fullReader.read().then(function({value:p,done:h}){if(h){E.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(p),"GetReader - expected an ArrayBuffer."),E.enqueue(new Uint8Array(p),1,[p])}).catch(p=>{E.error(p)})},E.onCancel=p=>{this._fullReader.cancel(p),E.ready.catch(h=>{if(!this.destroyed)throw h})}}),t.on("ReaderHeadersReady",i=>{const E=(0,_util.createPromiseCapability)(),p=this._fullReader;return p.headersReady.then(()=>{var h;(!p.isStreamingSupported||!p.isRangeSupported)&&(this._lastProgress&&((h=s.onProgress)==null||h.call(s,this._lastProgress)),p.onProgress=n=>{var a;(a=s.onProgress)==null||a.call(s,{loaded:n.loaded,total:n.total})}),E.resolve({isStreamingSupported:p.isStreamingSupported,isRangeSupported:p.isRangeSupported,contentLength:p.contentLength})},E.reject),E.promise}),t.on("GetRangeReader",(i,E)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const p=this._networkStream.getRangeReader(i.begin,i.end);if(!p){E.close();return}E.onPull=()=>{p.read().then(function({value:h,done:n}){if(n){E.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(h),"GetRangeReader - expected an ArrayBuffer."),E.enqueue(new Uint8Array(h),1,[h])}).catch(h=>{E.error(h)})},E.onCancel=h=>{p.cancel(h),E.ready.catch(n=>{if(!this.destroyed)throw n})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,s._capability.resolve(new PDFDocumentProxy(i,this))}),t.on("DocException",function(i){let E;switch(i.name){case"PasswordException":E=new _util.PasswordException(i.message,i.code);break;case"InvalidPDFException":E=new _util.InvalidPDFException(i.message);break;case"MissingPDFException":E=new _util.MissingPDFException(i.message);break;case"UnexpectedResponseException":E=new _util.UnexpectedResponseException(i.message,i.status);break;case"UnknownErrorException":E=new _util.UnknownErrorException(i.message,i.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}s._capability.reject(E)}),t.on("PasswordRequest",i=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),s.onPassword){const E=p=>{p instanceof Error?this._passwordCapability.reject(p):this._passwordCapability.resolve({password:p})};try{s.onPassword(E,i.code)}catch(p){this._passwordCapability.reject(p)}}else this._passwordCapability.reject(new _util.PasswordException(i.message,i.code));return this._passwordCapability.promise}),t.on("DataLoaded",i=>{var E;(E=s.onProgress)==null||E.call(s,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;S(this,Y).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,E,p])=>{var h;if(!this.destroyed&&!this.commonObjs.has(i))switch(E){case"Font":const n=this._params;if("error"in p){const x=p.error;(0,_util.warn)(`Error during font loading: ${x}`),this.commonObjs.resolve(i,x);break}let a=null;n.pdfBug&&((h=globalThis.FontInspector)==null?void 0:h.enabled)&&(a={registerFont(x,T){globalThis.FontInspector.fontAdded(x,T)}});const f=new _font_loader.FontFaceObject(p,{isEvalSupported:n.isEvalSupported,disableFontFace:n.disableFontFace,ignoreErrors:n.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:a});this.fontLoader.bind(f).catch(x=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!n.fontExtraProperties&&f.data&&(f.data=null),this.commonObjs.resolve(i,f)});break;case"FontPath":case"Image":this.commonObjs.resolve(i,p);break;default:throw new Error(`Got unknown common object type ${E}`)}}),t.on("obj",([i,E,p,h])=>{var a;if(this.destroyed)return;const n=S(this,Y).get(E);if(!n.objs.has(i))switch(p){case"Image":n.objs.resolve(i,h);const f=8e6;if(h){let x;if(h.bitmap){const{bitmap:T,width:P,height:D}=h;x=P*D*4,n._bitmaps.add(T)}else x=((a=h.data)==null?void 0:a.length)||0;x>f&&(n.cleanupAfterRender=!0)}break;case"Pattern":n.objs.resolve(i,h);break;default:throw new Error(`Got unknown object type ${p}`)}}),t.on("DocProgress",i=>{var E;this.destroyed||(E=s.onProgress)==null||E.call(s,{loaded:i.loaded,total:i.total})}),t.on("DocStats",i=>{this.destroyed||ut(this,L,Object.freeze({streamTypes:Object.freeze(i.streamTypes),fontTypes:Object.freeze(i.fontTypes)}))}),t.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),t.on("FetchBuiltInCMap",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(i):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(i):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:t}){var s,i;this.destroyed||(i=(s=this.loadingTask).onUnsupportedFeature)==null||i.call(s,t)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const s=t-1,i=S(this,H).get(s);if(i)return i;const E=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(p=>{if(this.destroyed)throw new Error("Transport destroyed");const h=new PDFPageProxy(s,p,this,this._params.ownerDocument,this._params.pdfBug);return S(this,Y).set(s,h),h});return S(this,H).set(s,E),E}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,s){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:s})}saveDocument(){var t,s;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:(s=(t=this._fullReader)==null?void 0:t.filename)!=null?s:null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new _optional_content_config.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return S(this,st)||ut(this,st,this.messageHandler.sendWithPromise("GetMetadata",null).then(t=>{var s,i,E,p;return{info:t[0],metadata:t[1]?new _metadata.Metadata(t[1]):null,contentDispositionFilename:(i=(s=this._fullReader)==null?void 0:s.filename)!=null?i:null,contentLength:(p=(E=this._fullReader)==null?void 0:E.contentLength)!=null?p:null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const s of S(this,Y).values())if(!s.cleanup())throw new Error(`startCleanup: Page ${s.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),ut(this,st,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const t=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t.disableAutoFetch,enableXfa:t.enableXfa})}}L=new WeakMap,Y=new WeakMap,H=new WeakMap,st=new WeakMap;class PDFObjects{constructor(){rt(this,A);rt(this,j,Object.create(null))}get(t,s=null){if(s){const E=lt(this,A,le).call(this,t);return E.capability.promise.then(()=>s(E.data)),null}const i=S(this,j)[t];if(!(i!=null&&i.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const s=S(this,j)[t];return(s==null?void 0:s.capability.settled)||!1}resolve(t,s=null){const i=lt(this,A,le).call(this,t);i.data=s,i.capability.resolve()}clear(){ut(this,j,Object.create(null))}}j=new WeakMap,A=new WeakSet,le=function(t){const s=S(this,j)[t];return s||(S(this,j)[t]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(t){rt(this,F,null);ut(this,F,t),this.onContinue=null}get promise(){return S(this,F).capability.promise}cancel(){S(this,F).cancel()}get separateAnnots(){const{separateAnnots:t}=S(this,F).operatorList;if(!t)return!1;const{annotationCanvasMap:s}=S(this,F);return t.form||t.canvas&&(s==null?void 0:s.size)>0}}F=new WeakMap,exports.RenderTask=RenderTask;const C=class{constructor({callback:t,params:s,objs:i,commonObjs:E,annotationCanvasMap:p,operatorList:h,pageIndex:n,canvasFactory:a,useRequestAnimationFrame:f=!1,pdfBug:x=!1,pageColors:T=null}){this.callback=t,this.params=s,this.objs=i,this.commonObjs=E,this.annotationCanvasMap=p,this.operatorListIdx=null,this.operatorList=h,this._pageIndex=n,this.canvasFactory=a,this._pdfBug=x,this.pageColors=T,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=s.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:s}){var a;if(this.cancelled)return;if(this._canvas){if(S(C,v).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");S(C,v).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)==null?void 0:a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:E,transform:p,imageLayer:h,background:n}=this.params;this.gfx=new _canvas.CanvasGraphics(i,this.commonObjs,this.objs,this.canvasFactory,h,s,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:p,viewport:E,transparency:t,background:n}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(t=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&S(C,v).delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&S(C,v).delete(this._canvas),this.callback())))}};let InternalRenderTask=C;v=new WeakMap,rt(InternalRenderTask,v,new WeakSet);const version="2.15.349";exports.version=version;const build="b8aa9c622";exports.build=build},(at,_,Q)=>{var j,Te,w;Object.defineProperty(_,"__esModule",{value:!0}),_.PrintAnnotationStorage=_.AnnotationStorage=void 0;var b=Q(1),L=Q(8),Y=Q(10);class H{constructor(){rt(this,j);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(v,C){const c=this._storage.get(v);return c===void 0?C:Object.assign(C,c)}getRawValue(v){return this._storage.get(v)}removeKey(v){this._storage.delete(v),this._storage.size===0&&this.resetModified()}setValue(v,C){const c=this._storage.get(v);let t=!1;if(c!==void 0)for(const[s,i]of Object.entries(C))c[s]!==i&&(t=!0,c[s]=i);else t=!0,this._storage.set(v,C);t&&lt(this,j,Te).call(this)}has(v){return this._storage.has(v)}getAll(){return this._storage.size>0?(0,b.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new st(this)}get serializable(){if(this._storage.size===0)return null;const v=new Map;for(const[C,c]of this._storage){const t=c instanceof L.AnnotationEditor?c.serialize():c;t&&v.set(C,t)}return v}static getHash(v){if(!v)return"";const C=new Y.MurmurHash3_64;for(const[c,t]of v)C.update(`${c}:${JSON.stringify(t)}`);return C.hexdigest()}}j=new WeakSet,Te=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},_.AnnotationStorage=H;class st extends H{constructor(C){super();rt(this,w,null);ut(this,w,structuredClone(C.serializable))}get print(){(0,b.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return S(this,w)}}w=new WeakMap,_.PrintAnnotationStorage=st},(at,_,Q)=>{var H,st,j,A,w,F;Object.defineProperty(_,"__esModule",{value:!0}),_.AnnotationEditor=void 0;var b=Q(9),L=Q(1);const v=class{constructor(c){rt(this,H,this.focusin.bind(this));rt(this,st,this.focusout.bind(this));rt(this,j,!1);rt(this,A,!1);rt(this,w,!1);rt(this,F,v._zIndex++);this.constructor===v&&(0,L.unreachable)("Cannot initialize AnnotationEditor."),this.parent=c.parent,this.id=c.id,this.width=this.height=null,this.pageIndex=c.parent.pageIndex,this.name=c.name,this.div=null;const[t,s]=this.parent.viewportBaseDimensions;this.x=c.x/t,this.y=c.y/s,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,L.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=S(this,F)}focusin(c){S(this,j)?ut(this,j,!1):this.parent.setSelected(this)}focusout(c){if(!this.isAttachedToDOM)return;const t=c.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(c.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(c){const t=this.parent.div.getBoundingClientRect();this.startX=c.clientX-t.x,this.startY=c.clientY-t.y,c.dataTransfer.setData("text/plain",this.id),c.dataTransfer.effectAllowed="move"}setAt(c,t,s,i){const[E,p]=this.parent.viewportBaseDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(c+s)/E,this.y=(t+i)/p,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(c,t){const[s,i]=this.parent.viewportBaseDimensions;[c,t]=this.screenToPageTranslation(c,t),this.x+=c/s,this.y+=t/i,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(c,t){const{rotation:s}=this.parent.viewport;switch(s){case 90:return[t,-c];case 180:return[-c,-t];case 270:return[-t,c];default:return[c,t]}}setDims(c,t){const[s,i]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*c/s}%`,this.div.style.height=`${100*t/i}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",S(this,H)),this.div.addEventListener("focusout",S(this,st));const[c,t]=this.getInitialTranslation();return this.translate(c,t),(0,b.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(c){const t=b.KeyboardManager.platform.isMac;if(c.button!==0||c.ctrlKey&&t){c.preventDefault();return}c.ctrlKey&&!t||c.shiftKey||c.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this),ut(this,j,!0)}getRect(c,t){const[s,i]=this.parent.viewportBaseDimensions,[E,p]=this.parent.pageDimensions,h=E*c/s,n=p*t/i,a=this.x*E,f=this.y*p,x=this.width*E,T=this.height*p;switch(this.rotation){case 0:return[a+h,p-f-n-T,a+h+x,p-f-n];case 90:return[a+n,p-f+h,a+n+T,p-f+h+x];case 180:return[a-h-x,p-f+n,a-h,p-f+n+T];case 270:return[a-n-T,p-f-h-x,a-n,p-f-h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(c,t){const[s,i,E,p]=c,h=E-s,n=p-i;switch(this.rotation){case 0:return[s,t-p,h,n];case 90:return[s,t-i,n,h];case 180:return[E,t-i,h,n];case 270:return[E,t-p,n,h];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ut(this,w,!0)}disableEditMode(){ut(this,w,!1)}isInEditMode(){return S(this,w)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var c;(c=this.div)==null||c.addEventListener("focusin",S(this,H))}serialize(){(0,L.unreachable)("An editor must be serializable")}static deserialize(c,t){const s=new this.prototype.constructor({parent:t,id:t.getNextId()});s.rotation=c.rotation;const[i,E]=t.pageDimensions,[p,h,n,a]=s.getRectInCurrentCoords(c.rect,E);return s.x=p/i,s.y=h/E,s.width=n/i,s.height=a/E,s}remove(){this.div.removeEventListener("focusin",S(this,H)),this.div.removeEventListener("focusout",S(this,st)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var c;(c=this.div)==null||c.classList.add("selectedEditor")}unselect(){var c;(c=this.div)==null||c.classList.remove("selectedEditor")}updateParams(c,t){}disableEditing(){}enableEditing(){}getIdForTextLayer(){return this.id}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return S(this,A)}set isEditing(c){ut(this,A,c),c?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let Y=v;H=new WeakMap,st=new WeakMap,j=new WeakMap,A=new WeakMap,w=new WeakMap,F=new WeakMap,Nt(Y,"_colorManager",new b.ColorManager),Nt(Y,"_zIndex",1),_.AnnotationEditor=Y},(at,_,Q)=>{var C,c,t,s,i,E,xe,n,f,x,T,P,D,J,V,k,q,y,N,O,it,ot,ht,mt,_t,R,d,we,m,ce,r,Wt,u,Qt,M,Pe,z,ke,K,he,Z,Zt,pt,te;Object.defineProperty(_,"__esModule",{value:!0}),_.KeyboardManager=_.CommandManager=_.ColorManager=_.AnnotationEditorUIManager=void 0,_.bindEvents=Y,_.opacityToHex=H;var b=Q(1),L=Q(4);function Y(yt,X,et){for(const vt of et)X.addEventListener(vt,yt[vt].bind(yt))}function H(yt){return Math.round(Math.min(255,Math.max(1,255*yt))).toString(16).padStart(2,"0")}class st{constructor(){rt(this,C,0)}getId(){return`${b.AnnotationEditorPrefix}${oe(this,C)._++}`}}C=new WeakMap;class j{constructor(X=128){rt(this,c,[]);rt(this,t,!1);rt(this,s,void 0);rt(this,i,-1);ut(this,s,X)}add({cmd:X,undo:et,mustExec:vt,type:xt=NaN,overwriteIfSameType:St=!1,keepUndo:kt=!1}){if(vt&&X(),S(this,t))return;const Rt={cmd:X,undo:et,type:xt};if(S(this,i)===-1){S(this,c).length>0&&(S(this,c).length=0),ut(this,i,0),S(this,c).push(Rt);return}if(St&&S(this,c)[S(this,i)].type===xt){kt&&(Rt.undo=S(this,c)[S(this,i)].undo),S(this,c)[S(this,i)]=Rt;return}const jt=S(this,i)+1;jt===S(this,s)?S(this,c).splice(0,1):(ut(this,i,jt),jt<S(this,c).length&&S(this,c).splice(jt)),S(this,c).push(Rt)}undo(){S(this,i)!==-1&&(ut(this,t,!0),S(this,c)[S(this,i)].undo(),ut(this,t,!1),ut(this,i,S(this,i)-1))}redo(){S(this,i)<S(this,c).length-1&&(ut(this,i,S(this,i)+1),ut(this,t,!0),S(this,c)[S(this,i)].cmd(),ut(this,t,!1))}hasSomethingToUndo(){return S(this,i)!==-1}hasSomethingToRedo(){return S(this,i)<S(this,c).length-1}destroy(){ut(this,c,null)}}c=new WeakMap,t=new WeakMap,s=new WeakMap,i=new WeakMap,_.CommandManager=j;const h=class{constructor(X){rt(this,E);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const et=h.platform.isMac;for(const[vt,xt]of X)for(const St of vt){const kt=St.startsWith("mac+");et&&kt?(this.callbacks.set(St.slice(4),xt),this.allKeys.add(St.split("+").at(-1))):!et&&!kt&&(this.callbacks.set(St,xt),this.allKeys.add(St.split("+").at(-1)))}}static get platform(){const X=typeof navigator<"u"?navigator.platform:"";return(0,b.shadow)(this,"platform",{isWin:X.includes("Win"),isMac:X.includes("Mac")})}exec(X,et){if(!this.allKeys.has(et.key))return;const vt=this.callbacks.get(lt(this,E,xe).call(this,et));!vt||(vt.bind(X)(),et.stopPropagation(),et.preventDefault())}};let A=h;E=new WeakSet,xe=function(X){X.altKey&&this.buffer.push("alt"),X.ctrlKey&&this.buffer.push("ctrl"),X.metaKey&&this.buffer.push("meta"),X.shiftKey&&this.buffer.push("shift"),this.buffer.push(X.key);const et=this.buffer.join("+");return this.buffer.length=0,et},_.KeyboardManager=A;class w{constructor(){rt(this,n,null)}copy(X){!X||(Array.isArray(X)?ut(this,n,X.map(et=>et.serialize())):ut(this,n,[X.serialize()]),ut(this,n,S(this,n).filter(et=>!!et)),S(this,n).length===0&&ut(this,n,null))}paste(){return S(this,n)}isEmpty(){return S(this,n)===null}destroy(){ut(this,n,null)}}n=new WeakMap;const a=class{get _colors(){const X=new Map([["CanvasText",null],["Canvas",null]]);return(0,L.getColorValues)(X),(0,b.shadow)(this,"_colors",X)}convert(X){const et=(0,L.getRGB)(X);if(!window.matchMedia("(forced-colors: active)").matches)return et;for(const[vt,xt]of this._colors)if(xt.every((St,kt)=>St===et[kt]))return a._colorsMapping.get(vt);return et}getHexCode(X){const et=this._colors.get(X);return et?b.Util.makeHexColor(...et):X}};let F=a;Nt(F,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),_.ColorManager=F;const nt=class{constructor(X,et){rt(this,d);rt(this,m);rt(this,r);rt(this,u);rt(this,M);rt(this,z);rt(this,K);rt(this,Z);rt(this,pt);rt(this,f,null);rt(this,x,new Map);rt(this,T,new Map);rt(this,P,new w);rt(this,D,new j);rt(this,J,0);rt(this,V,null);rt(this,k,null);rt(this,q,new st);rt(this,y,!1);rt(this,N,b.AnnotationEditorType.NONE);rt(this,O,new Set);rt(this,it,this.keydown.bind(this));rt(this,ot,this.onEditingAction.bind(this));rt(this,ht,this.onPageChanging.bind(this));rt(this,mt,this.onTextLayerRendered.bind(this));rt(this,_t,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});rt(this,R,null);ut(this,R,X),ut(this,k,et),S(this,k)._on("editingaction",S(this,ot)),S(this,k)._on("pagechanging",S(this,ht)),S(this,k)._on("textlayerrendered",S(this,mt))}destroy(){lt(this,m,ce).call(this),S(this,k)._off("editingaction",S(this,ot)),S(this,k)._off("pagechanging",S(this,ht)),S(this,k)._off("textlayerrendered",S(this,mt));for(const X of S(this,T).values())X.destroy();S(this,T).clear(),S(this,x).clear(),ut(this,f,null),S(this,O).clear(),S(this,P).destroy(),S(this,D).destroy()}onPageChanging({pageNumber:X}){ut(this,J,X-1)}onTextLayerRendered({pageNumber:X}){const et=X-1,vt=S(this,T).get(et);vt==null||vt.onTextLayerRendered()}focusMainContainer(){S(this,R).focus()}keydown(X){var et;(et=this.getActive())!=null&&et.shouldGetKeyboardEvents()||nt._keyboardManager.exec(this,X)}onEditingAction(X){["undo","redo","cut","copy","paste","delete","selectAll"].includes(X.name)&&this[X.name]()}setEditingState(X){X?(lt(this,d,we).call(this),lt(this,r,Wt).call(this,{isEditing:S(this,N)!==b.AnnotationEditorType.NONE,isEmpty:lt(this,Z,Zt).call(this),hasSomethingToUndo:S(this,D).hasSomethingToUndo(),hasSomethingToRedo:S(this,D).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:S(this,P).isEmpty()})):(lt(this,m,ce).call(this),lt(this,r,Wt).call(this,{isEditing:!1}))}registerEditorTypes(X){ut(this,V,X);for(const et of S(this,V))lt(this,u,Qt).call(this,et.defaultPropertiesToUpdate)}getId(){return S(this,q).getId()}addLayer(X){S(this,T).set(X.pageIndex,X),S(this,y)?X.enable():X.disable()}removeLayer(X){S(this,T).delete(X.pageIndex)}updateMode(X){if(ut(this,N,X),X===b.AnnotationEditorType.NONE)this.setEditingState(!1),lt(this,z,ke).call(this);else{this.setEditingState(!0),lt(this,M,Pe).call(this);for(const et of S(this,T).values())et.updateMode(X)}}updateToolbar(X){X!==S(this,N)&&S(this,k).dispatch("switchannotationeditormode",{source:this,mode:X})}updateParams(X,et){for(const vt of S(this,O))vt.updateParams(X,et);for(const vt of S(this,V))vt.updateDefaultParams(X,et)}getEditors(X){const et=[];for(const vt of S(this,x).values())vt.pageIndex===X&&et.push(vt);return et}getEditor(X){return S(this,x).get(X)}addEditor(X){S(this,x).set(X.id,X)}removeEditor(X){S(this,x).delete(X.id),this.unselect(X)}setActiveEditor(X){S(this,f)!==X&&(ut(this,f,X),X&&lt(this,u,Qt).call(this,X.propertiesToUpdate))}toggleSelected(X){if(S(this,O).has(X)){S(this,O).delete(X),X.unselect(),lt(this,r,Wt).call(this,{hasSelectedEditor:this.hasSelection});return}S(this,O).add(X),X.select(),lt(this,u,Qt).call(this,X.propertiesToUpdate),lt(this,r,Wt).call(this,{hasSelectedEditor:!0})}setSelected(X){for(const et of S(this,O))et!==X&&et.unselect();S(this,O).clear(),S(this,O).add(X),X.select(),lt(this,u,Qt).call(this,X.propertiesToUpdate),lt(this,r,Wt).call(this,{hasSelectedEditor:!0})}isSelected(X){return S(this,O).has(X)}unselect(X){X.unselect(),S(this,O).delete(X),lt(this,r,Wt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return S(this,O).size!==0}undo(){S(this,D).undo(),lt(this,r,Wt).call(this,{hasSomethingToUndo:S(this,D).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:lt(this,Z,Zt).call(this)})}redo(){S(this,D).redo(),lt(this,r,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:S(this,D).hasSomethingToRedo(),isEmpty:lt(this,Z,Zt).call(this)})}addCommands(X){S(this,D).add(X),lt(this,r,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:lt(this,Z,Zt).call(this)})}delete(){if(S(this,f)&&S(this,f).commitOrRemove(),!this.hasSelection)return;const X=[...S(this,O)],et=()=>{for(const xt of X)xt.remove()},vt=()=>{for(const xt of X)lt(this,K,he).call(this,xt)};this.addCommands({cmd:et,undo:vt,mustExec:!0})}copy(){if(S(this,f)&&S(this,f).commitOrRemove(),this.hasSelection){const X=[];for(const et of S(this,O))et.isEmpty()||X.push(et);if(X.length===0)return;S(this,P).copy(X),lt(this,r,Wt).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(S(this,P).isEmpty())return;this.unselectAll();const X=S(this,T).get(S(this,J)),et=S(this,P).paste().map(St=>X.deserialize(St)),vt=()=>{for(const St of et)lt(this,K,he).call(this,St);lt(this,pt,te).call(this,et)},xt=()=>{for(const St of et)St.remove()};this.addCommands({cmd:vt,undo:xt,mustExec:!0})}selectAll(){for(const X of S(this,O))X.commit();lt(this,pt,te).call(this,S(this,x).values())}unselectAll(){if(S(this,f)){S(this,f).commitOrRemove();return}if(lt(this,pt,te).size!==0){for(const X of S(this,O))X.unselect();S(this,O).clear(),lt(this,r,Wt).call(this,{hasSelectedEditor:!1})}}isActive(X){return S(this,f)===X}getActive(){return S(this,f)}getMode(){return S(this,N)}};let v=nt;f=new WeakMap,x=new WeakMap,T=new WeakMap,P=new WeakMap,D=new WeakMap,J=new WeakMap,V=new WeakMap,k=new WeakMap,q=new WeakMap,y=new WeakMap,N=new WeakMap,O=new WeakMap,it=new WeakMap,ot=new WeakMap,ht=new WeakMap,mt=new WeakMap,_t=new WeakMap,R=new WeakMap,d=new WeakSet,we=function(){S(this,R).addEventListener("keydown",S(this,it))},m=new WeakSet,ce=function(){S(this,R).removeEventListener("keydown",S(this,it))},r=new WeakSet,Wt=function(X){Object.entries(X).some(([vt,xt])=>S(this,_t)[vt]!==xt)&&S(this,k).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(S(this,_t),X)})},u=new WeakSet,Qt=function(X){S(this,k).dispatch("annotationeditorparamschanged",{source:this,details:X})},M=new WeakSet,Pe=function(){if(!S(this,y)){ut(this,y,!0);for(const X of S(this,T).values())X.enable()}},z=new WeakSet,ke=function(){if(this.unselectAll(),S(this,y)){ut(this,y,!1);for(const X of S(this,T).values())X.disable()}},K=new WeakSet,he=function(X){const et=S(this,T).get(X.pageIndex);et?et.addOrRebuild(X):this.addEditor(X)},Z=new WeakSet,Zt=function(){if(S(this,x).size===0)return!0;if(S(this,x).size===1)for(const X of S(this,x).values())return X.isEmpty();return!1},pt=new WeakSet,te=function(X){S(this,O).clear();for(const et of X)et.isEmpty()||(S(this,O).add(et),et.select());lt(this,r,Wt).call(this,{hasSelectedEditor:!0})},Nt(v,"_keyboardManager",new A([[["ctrl+a","mac+meta+a"],nt.prototype.selectAll],[["ctrl+c","mac+meta+c"],nt.prototype.copy],[["ctrl+v","mac+meta+v"],nt.prototype.paste],[["ctrl+x","mac+meta+x"],nt.prototype.cut],[["ctrl+z","mac+meta+z"],nt.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],nt.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],nt.prototype.delete],[["Escape","mac+Escape"],nt.prototype.unselectAll]])),_.AnnotationEditorUIManager=v},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.MurmurHash3_64=void 0;var b=Q(1);const L=3285377520,Y=4294901760,H=65535;class st{constructor(A){this.h1=A?A&4294967295:L,this.h2=A?A&4294967295:L}update(A){let w,F;if(typeof A=="string"){w=new Uint8Array(A.length*2),F=0;for(let f=0,x=A.length;f<x;f++){const T=A.charCodeAt(f);T<=255?w[F++]=T:(w[F++]=T>>>8,w[F++]=T&255)}}else if((0,b.isArrayBuffer)(A))w=A.slice(),F=w.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const v=F>>2,C=F-v*4,c=new Uint32Array(w.buffer,0,v);let t=0,s=0,i=this.h1,E=this.h2;const p=3432918353,h=461845907,n=p&H,a=h&H;for(let f=0;f<v;f++)f&1?(t=c[f],t=t*p&Y|t*n&H,t=t<<15|t>>>17,t=t*h&Y|t*a&H,i^=t,i=i<<13|i>>>19,i=i*5+3864292196):(s=c[f],s=s*p&Y|s*n&H,s=s<<15|s>>>17,s=s*h&Y|s*a&H,E^=s,E=E<<13|E>>>19,E=E*5+3864292196);switch(t=0,C){case 3:t^=w[v*4+2]<<16;case 2:t^=w[v*4+1]<<8;case 1:t^=w[v*4],t=t*p&Y|t*n&H,t=t<<15|t>>>17,t=t*h&Y|t*a&H,v&1?i^=t:E^=t}this.h1=i,this.h2=E}hexdigest(){let A=this.h1,w=this.h2;A^=w>>>1,A=A*3981806797&Y|A*36045&H,w=w*4283543511&Y|((w<<16|A>>>16)*2950163797&Y)>>>16,A^=w>>>1,A=A*444984403&Y|A*60499&H,w=w*3301882366&Y|((w<<16|A>>>16)*3120437893&Y)>>>16,A^=w>>>1;const F=(A>>>0).toString(16),v=(w>>>0).toString(16);return F.padStart(8,"0")+v.padStart(8,"0")}}_.MurmurHash3_64=st},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.FontLoader=_.FontFaceObject=void 0;var b=Q(1);class L{constructor({docId:j,onUnsupportedFeature:A,ownerDocument:w=globalThis.document,styleElement:F=null}){this.constructor===L&&(0,b.unreachable)("Cannot initialize BaseFontLoader."),this.docId=j,this._onUnsupportedFeature=A,this._document=w,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(j){this.nativeFontFaces.push(j),this._document.fonts.add(j)}insertRule(j){let A=this.styleElement;A||(A=this.styleElement=this._document.createElement("style"),A.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(A));const w=A.sheet;w.insertRule(j,w.cssRules.length)}clear(){for(const j of this.nativeFontFaces)this._document.fonts.delete(j);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(j){if(j.attached||j.missingFile)return;if(j.attached=!0,this.isFontLoadingAPISupported){const w=j.createNativeFontFace();if(w){this.addNativeFontFace(w);try{await w.loaded}catch(F){throw this._onUnsupportedFeature({featureId:b.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,b.warn)(`Failed to load font '${w.family}': '${F}'.`),j.disableFontFace=!0,F}}return}const A=j.createFontFaceRule();if(A){if(this.insertRule(A),this.isSyncFontLoadingSupported)return;await new Promise(w=>{const F=this._queueLoadingCallback(w);this._prepareFontLoadEvent([A],[j],F)})}}_queueLoadingCallback(j){(0,b.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var A;const j=!!((A=this._document)!=null&&A.fonts);return(0,b.shadow)(this,"isFontLoadingAPISupported",j)}get isSyncFontLoadingSupported(){(0,b.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,b.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(j,A,w){(0,b.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let Y;_.FontLoader=Y,_.FontLoader=Y=class extends L{constructor(j){super(j),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let j=!1;if(typeof navigator>"u")j=!0;else{const A=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(A==null?void 0:A[1])>=14&&(j=!0)}return(0,b.shadow)(this,"isSyncFontLoadingSupported",j)}_queueLoadingCallback(j){function A(){for((0,b.assert)(!F.done,"completeRequest() cannot be called twice."),F.done=!0;w.requests.length>0&&w.requests[0].done;){const v=w.requests.shift();setTimeout(v.callback,0)}}const w=this.loadingContext,F={id:`pdfjs-font-loading-${w.nextRequestId++}`,done:!1,complete:A,callback:j};return w.requests.push(F),F}get _loadTestFont(){const j=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,b.shadow)(this,"_loadTestFont",j())}_prepareFontLoadEvent(j,A,w){function F(V,k){return V.charCodeAt(k)<<24|V.charCodeAt(k+1)<<16|V.charCodeAt(k+2)<<8|V.charCodeAt(k+3)&255}function v(V,k,q,y){const N=V.substring(0,k),O=V.substring(k+q);return N+y+O}let C,c;const t=this._document.createElement("canvas");t.width=1,t.height=1;const s=t.getContext("2d");let i=0;function E(V,k){if(i++,i>30){(0,b.warn)("Load test font never loaded."),k();return}if(s.font="30px "+V,s.fillText(".",0,20),s.getImageData(0,0,1,1).data[3]>0){k();return}setTimeout(E.bind(null,V,k))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=v(h,976,p.length,p);const a=16,f=1482184792;let x=F(h,a);for(C=0,c=p.length-3;C<c;C+=4)x=x-f+F(p,C)|0;C<p.length&&(x=x-f+F(p+"XXX",C)|0),h=v(h,a,4,(0,b.string32)(x));const T=`url(data:font/opentype;base64,${btoa(h)});`,P=`@font-face {font-family:"${p}";src:${T}}`;this.insertRule(P);const D=[];for(const V of A)D.push(V.loadedName);D.push(p);const J=this._document.createElement("div");J.style.visibility="hidden",J.style.width=J.style.height="10px",J.style.position="absolute",J.style.top=J.style.left="0px";for(const V of D){const k=this._document.createElement("span");k.textContent="Hi",k.style.fontFamily=V,J.append(k)}this._document.body.append(J),E(p,()=>{J.remove(),w.complete()})}};class H{constructor(j,{isEvalSupported:A=!0,disableFontFace:w=!1,ignoreErrors:F=!1,onUnsupportedFeature:v,fontRegistry:C=null}){this.compiledGlyphs=Object.create(null);for(const c in j)this[c]=j[c];this.isEvalSupported=A!==!1,this.disableFontFace=w===!0,this.ignoreErrors=F===!0,this._onUnsupportedFeature=v,this.fontRegistry=C}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let j;if(!this.cssFontInfo)j=new FontFace(this.loadedName,this.data,{});else{const A={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(A.style=`oblique ${this.cssFontInfo.italicAngle}deg`),j=new FontFace(this.cssFontInfo.fontFamily,this.data,A)}return this.fontRegistry&&this.fontRegistry.registerFont(this),j}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const j=(0,b.bytesToString)(this.data),A=`url(data:${this.mimetype};base64,${btoa(j)});`;let w;if(!this.cssFontInfo)w=`@font-face {font-family:"${this.loadedName}";src:${A}}`;else{let F=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(F+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),w=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${F}src:${A}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,A),w}getPathGenerator(j,A){if(this.compiledGlyphs[A]!==void 0)return this.compiledGlyphs[A];let w;try{w=j.get(this.loadedName+"_path_"+A)}catch(F){if(!this.ignoreErrors)throw F;return this._onUnsupportedFeature({featureId:b.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,b.warn)(`getPathGenerator - ignoring character: "${F}".`),this.compiledGlyphs[A]=function(v,C){}}if(this.isEvalSupported&&b.FeatureTest.isEvalSupported){const F=[];for(const v of w){const C=v.args!==void 0?v.args.join(","):"";F.push("c.",v.cmd,"(",C,`);
`)}return this.compiledGlyphs[A]=new Function("c","size",F.join(""))}return this.compiledGlyphs[A]=function(F,v){for(const C of w)C.cmd==="scale"&&(C.args=[v,-v]),F[C.cmd].apply(F,C.args)}}}_.FontFaceObject=H},(at,_,Q)=>{var ht,de;Object.defineProperty(_,"__esModule",{value:!0}),_.CanvasGraphics=void 0;var b=Q(1),L=Q(4),Y=Q(13),H=Q(14),st=Q(3);const j=16,A=100,w=4096,F=15,v=10,C=1e3,c=16,t=1.000001;function s(R,d){if(R._removeMirroring)throw new Error("Context is already forwarding operations.");R.__originalSave=R.save,R.__originalRestore=R.restore,R.__originalRotate=R.rotate,R.__originalScale=R.scale,R.__originalTranslate=R.translate,R.__originalTransform=R.transform,R.__originalSetTransform=R.setTransform,R.__originalResetTransform=R.resetTransform,R.__originalClip=R.clip,R.__originalMoveTo=R.moveTo,R.__originalLineTo=R.lineTo,R.__originalBezierCurveTo=R.bezierCurveTo,R.__originalRect=R.rect,R.__originalClosePath=R.closePath,R.__originalBeginPath=R.beginPath,R._removeMirroring=()=>{R.save=R.__originalSave,R.restore=R.__originalRestore,R.rotate=R.__originalRotate,R.scale=R.__originalScale,R.translate=R.__originalTranslate,R.transform=R.__originalTransform,R.setTransform=R.__originalSetTransform,R.resetTransform=R.__originalResetTransform,R.clip=R.__originalClip,R.moveTo=R.__originalMoveTo,R.lineTo=R.__originalLineTo,R.bezierCurveTo=R.__originalBezierCurveTo,R.rect=R.__originalRect,R.closePath=R.__originalClosePath,R.beginPath=R.__originalBeginPath,delete R._removeMirroring},R.save=function(){d.save(),this.__originalSave()},R.restore=function(){d.restore(),this.__originalRestore()},R.translate=function(m,e){d.translate(m,e),this.__originalTranslate(m,e)},R.scale=function(m,e){d.scale(m,e),this.__originalScale(m,e)},R.transform=function(m,e,r,l,u,g){d.transform(m,e,r,l,u,g),this.__originalTransform(m,e,r,l,u,g)},R.setTransform=function(m,e,r,l,u,g){d.setTransform(m,e,r,l,u,g),this.__originalSetTransform(m,e,r,l,u,g)},R.resetTransform=function(){d.resetTransform(),this.__originalResetTransform()},R.rotate=function(m){d.rotate(m),this.__originalRotate(m)},R.clip=function(m){d.clip(m),this.__originalClip(m)},R.moveTo=function(o,m){d.moveTo(o,m),this.__originalMoveTo(o,m)},R.lineTo=function(o,m){d.lineTo(o,m),this.__originalLineTo(o,m)},R.bezierCurveTo=function(o,m,e,r,l,u){d.bezierCurveTo(o,m,e,r,l,u),this.__originalBezierCurveTo(o,m,e,r,l,u)},R.rect=function(o,m,e,r){d.rect(o,m,e,r),this.__originalRect(o,m,e,r)},R.closePath=function(){d.closePath(),this.__originalClosePath()},R.beginPath=function(){d.beginPath(),this.__originalBeginPath()}}function i(R){if(R._transformStack&&(R._transformStack=[]),!R.mozCurrentTransform){R._originalSave=R.save,R._originalRestore=R.restore,R._originalRotate=R.rotate,R._originalScale=R.scale,R._originalTranslate=R.translate,R._originalTransform=R.transform,R._originalSetTransform=R.setTransform,R._originalResetTransform=R.resetTransform,R._transformMatrix=R._transformMatrix||[1,0,0,1,0,0],R._transformStack=[];try{const d=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(R),"lineWidth");R._setLineWidth=d.set,R._getLineWidth=d.get,Object.defineProperty(R,"lineWidth",{set:function(m){this._setLineWidth(m*t)},get:function(){return this._getLineWidth()}})}catch{}Object.defineProperty(R,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(R,"mozCurrentTransformInverse",{get:function(){const[o,m,e,r,l,u]=this._transformMatrix,g=o*r-m*e,M=m*e-o*r;return[r/g,m/M,e/M,o/g,(r*l-e*u)/M,(m*l-o*u)/g]}}),R.save=function(){const o=this._transformMatrix;this._transformStack.push(o),this._transformMatrix=o.slice(0,6),this._originalSave()},R.restore=function(){this._transformStack.length===0&&(0,b.warn)("Tried to restore a ctx when the stack was already empty.");const o=this._transformStack.pop();o&&(this._transformMatrix=o,this._originalRestore())},R.translate=function(o,m){const e=this._transformMatrix;e[4]=e[0]*o+e[2]*m+e[4],e[5]=e[1]*o+e[3]*m+e[5],this._originalTranslate(o,m)},R.scale=function(o,m){const e=this._transformMatrix;e[0]*=o,e[1]*=o,e[2]*=m,e[3]*=m,this._originalScale(o,m)},R.transform=function(o,m,e,r,l,u){const g=this._transformMatrix;this._transformMatrix=[g[0]*o+g[2]*m,g[1]*o+g[3]*m,g[0]*e+g[2]*r,g[1]*e+g[3]*r,g[0]*l+g[2]*u+g[4],g[1]*l+g[3]*u+g[5]],R._originalTransform(o,m,e,r,l,u)},R.setTransform=function(o,m,e,r,l,u){this._transformMatrix=[o,m,e,r,l,u],R._originalSetTransform(o,m,e,r,l,u)},R.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0],R._originalResetTransform()},R.rotate=function(o){const m=Math.cos(o),e=Math.sin(o),r=this._transformMatrix;this._transformMatrix=[r[0]*m+r[2]*e,r[1]*m+r[3]*e,r[0]*-e+r[2]*m,r[1]*-e+r[3]*m,r[4],r[5]],this._originalRotate(o)}}}class E{constructor(d){this.canvasFactory=d,this.cache=Object.create(null)}getCanvas(d,o,m,e){let r;return this.cache[d]!==void 0?(r=this.cache[d],this.canvasFactory.reset(r,o,m),r.context.setTransform(1,0,0,1,0,0)):(r=this.canvasFactory.create(o,m),this.cache[d]=r),e&&i(r.context),r}delete(d){delete this.cache[d]}clear(){for(const d in this.cache){const o=this.cache[d];this.canvasFactory.destroy(o),delete this.cache[d]}}}function p(R,d,o,m,e,r,l,u,g,M){const[I,z,B,K,G,Z]=R.mozCurrentTransform;if(z===0&&B===0){const At=l*I+G,nt=Math.round(At),yt=u*K+Z,X=Math.round(yt),et=(l+g)*I+G,vt=Math.abs(Math.round(et)-nt)||1,xt=(u+M)*K+Z,St=Math.abs(Math.round(xt)-X)||1;return R.setTransform(Math.sign(I),0,0,Math.sign(K),nt,X),R.drawImage(d,o,m,e,r,0,0,vt,St),R.setTransform(I,z,B,K,G,Z),[vt,St]}if(I===0&&K===0){const At=u*B+G,nt=Math.round(At),yt=l*z+Z,X=Math.round(yt),et=(u+M)*B+G,vt=Math.abs(Math.round(et)-nt)||1,xt=(l+g)*z+Z,St=Math.abs(Math.round(xt)-X)||1;return R.setTransform(0,Math.sign(z),Math.sign(B),0,nt,X),R.drawImage(d,o,m,e,r,0,0,St,vt),R.setTransform(I,z,B,K,G,Z),[St,vt]}R.drawImage(d,o,m,e,r,l,u,g,M);const ft=Math.hypot(I,z),pt=Math.hypot(B,K);return[ft*g,pt*M]}function h(R){const{width:d,height:o}=R;if(d>C||o>C)return null;const m=1e3,e=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=d+1;let l=new Uint8Array(r*(o+1)),u,g,M;const I=d+7&-8;let z=new Uint8Array(I*o),B=0;for(const nt of R.data){let yt=128;for(;yt>0;)z[B++]=nt&yt?0:255,yt>>=1}let K=0;for(B=0,z[B]!==0&&(l[0]=1,++K),g=1;g<d;g++)z[B]!==z[B+1]&&(l[g]=z[B]?2:1,++K),B++;for(z[B]!==0&&(l[g]=2,++K),u=1;u<o;u++){B=u*I,M=u*r,z[B-I]!==z[B]&&(l[M]=z[B]?1:8,++K);let nt=(z[B]?4:0)+(z[B-I]?8:0);for(g=1;g<d;g++)nt=(nt>>2)+(z[B+1]?4:0)+(z[B-I+1]?8:0),e[nt]&&(l[M+g]=e[nt],++K),B++;if(z[B-I]!==z[B]&&(l[M+g]=z[B]?2:4,++K),K>m)return null}for(B=I*(o-1),M=u*r,z[B]!==0&&(l[M]=8,++K),g=1;g<d;g++)z[B]!==z[B+1]&&(l[M+g]=z[B]?4:8,++K),B++;if(z[B]!==0&&(l[M+g]=4,++K),K>m)return null;const G=new Int32Array([0,r,-1,0,-r,0,0,0,1]);let Z,ft,pt;for(st.isNodeJS?ft=[]:Z=new Path2D,u=0;K&&u<=o;u++){let nt=u*r;const yt=nt+d;for(;nt<yt&&!l[nt];)nt++;if(nt===yt)continue;Z?Z.moveTo(nt%r,u):pt=[nt%r,u];const X=nt;let et=l[nt];do{const vt=G[et];do nt+=vt;while(!l[nt]);const xt=l[nt];xt!==5&&xt!==10?(et=xt,l[nt]=0):(et=xt&51*et>>4,l[nt]&=et>>2|et<<2),Z?Z.lineTo(nt%r,nt/r|0):pt.push(nt%r,nt/r|0),l[nt]||--K}while(X!==nt);Z||ft.push(pt),--u}return z=null,l=null,function(nt){if(nt.save(),nt.scale(1/d,-1/o),nt.translate(0,-o),Z)nt.fill(Z);else{nt.beginPath();for(const yt of ft){nt.moveTo(yt[0],yt[1]);for(let X=2,et=yt.length;X<et;X+=2)nt.lineTo(yt[X],yt[X+1])}nt.fill()}nt.beginPath(),nt.restore()}}class n{constructor(d,o){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=b.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=b.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=b.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,d,o])}clone(){const d=Object.create(this);return d.clipBox=this.clipBox.slice(),d}setCurrentPoint(d,o){this.x=d,this.y=o}updatePathMinMax(d,o,m){[o,m]=b.Util.applyTransform([o,m],d),this.minX=Math.min(this.minX,o),this.minY=Math.min(this.minY,m),this.maxX=Math.max(this.maxX,o),this.maxY=Math.max(this.maxY,m)}updateRectMinMax(d,o){const m=b.Util.applyTransform(o,d),e=b.Util.applyTransform(o.slice(2),d);this.minX=Math.min(this.minX,m[0],e[0]),this.minY=Math.min(this.minY,m[1],e[1]),this.maxX=Math.max(this.maxX,m[0],e[0]),this.maxY=Math.max(this.maxY,m[1],e[1])}updateScalingPathMinMax(d,o){b.Util.scaleMinMax(d,o),this.minX=Math.min(this.minX,o[0]),this.maxX=Math.max(this.maxX,o[1]),this.minY=Math.min(this.minY,o[2]),this.maxY=Math.max(this.maxY,o[3])}updateCurvePathMinMax(d,o,m,e,r,l,u,g,M,I){const z=b.Util.bezierBoundingBox(o,m,e,r,l,u,g,M);if(I){I[0]=Math.min(I[0],z[0],z[2]),I[1]=Math.max(I[1],z[0],z[2]),I[2]=Math.min(I[2],z[1],z[3]),I[3]=Math.max(I[3],z[1],z[3]);return}this.updateRectMinMax(d,z)}getPathBoundingBox(d=Y.PathType.FILL,o=null){const m=[this.minX,this.minY,this.maxX,this.maxY];if(d===Y.PathType.STROKE){o||(0,b.unreachable)("Stroke bounding box must include transform.");const e=b.Util.singularValueDecompose2dScale(o),r=e[0]*this.lineWidth/2,l=e[1]*this.lineWidth/2;m[0]-=r,m[1]-=l,m[2]+=r,m[3]+=l}return m}updateClipFromPath(){const d=b.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(d||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(d){this.clipBox=d,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(d=Y.PathType.FILL,o=null){return b.Util.intersect(this.clipBox,this.getPathBoundingBox(d,o))}}function a(R,d,o=null){if(typeof ImageData<"u"&&d instanceof ImageData){R.putImageData(d,0,0);return}const m=d.height,e=d.width,r=m%c,l=(m-r)/c,u=r===0?l:l+1,g=R.createImageData(e,c);let M=0,I;const z=d.data,B=g.data;let K,G,Z,ft,pt,At,nt,yt;if(o)switch(o.length){case 1:pt=o[0],At=o[0],nt=o[0],yt=o[0];break;case 4:pt=o[0],At=o[1],nt=o[2],yt=o[3];break}if(d.kind===b.ImageKind.GRAYSCALE_1BPP){const X=z.byteLength,et=new Uint32Array(B.buffer,0,B.byteLength>>2),vt=et.length,xt=e+7>>3;let St=4294967295,kt=b.FeatureTest.isLittleEndian?4278190080:255;for(yt&&yt[0]===255&&yt[255]===0&&([St,kt]=[kt,St]),K=0;K<u;K++){for(Z=K<l?c:r,I=0,G=0;G<Z;G++){const Rt=X-M;let jt=0;const wt=Rt>xt?e:Rt*8-7,$t=wt&-8;let Ot=0,tt=0;for(;jt<$t;jt+=8)tt=z[M++],et[I++]=tt&128?St:kt,et[I++]=tt&64?St:kt,et[I++]=tt&32?St:kt,et[I++]=tt&16?St:kt,et[I++]=tt&8?St:kt,et[I++]=tt&4?St:kt,et[I++]=tt&2?St:kt,et[I++]=tt&1?St:kt;for(;jt<wt;jt++)Ot===0&&(tt=z[M++],Ot=128),et[I++]=tt&Ot?St:kt,Ot>>=1}for(;I<vt;)et[I++]=0;R.putImageData(g,0,K*c)}}else if(d.kind===b.ImageKind.RGBA_32BPP){const X=!!(pt||At||nt);for(G=0,ft=e*c*4,K=0;K<l;K++){if(B.set(z.subarray(M,M+ft)),M+=ft,X)for(let et=0;et<ft;et+=4)pt&&(B[et+0]=pt[B[et+0]]),At&&(B[et+1]=At[B[et+1]]),nt&&(B[et+2]=nt[B[et+2]]);R.putImageData(g,0,G),G+=c}if(K<u){if(ft=e*r*4,B.set(z.subarray(M,M+ft)),X)for(let et=0;et<ft;et+=4)pt&&(B[et+0]=pt[B[et+0]]),At&&(B[et+1]=At[B[et+1]]),nt&&(B[et+2]=nt[B[et+2]]);R.putImageData(g,0,G)}}else if(d.kind===b.ImageKind.RGB_24BPP){const X=!!(pt||At||nt);for(Z=c,ft=e*Z,K=0;K<u;K++){for(K>=l&&(Z=r,ft=e*Z),I=0,G=ft;G--;)B[I++]=z[M++],B[I++]=z[M++],B[I++]=z[M++],B[I++]=255;if(X)for(let et=0;et<I;et+=4)pt&&(B[et+0]=pt[B[et+0]]),At&&(B[et+1]=At[B[et+1]]),nt&&(B[et+2]=nt[B[et+2]]);R.putImageData(g,0,K*c)}}else throw new Error(`bad image kind: ${d.kind}`)}function f(R,d){if(d.bitmap){R.drawImage(d.bitmap,0,0);return}const o=d.height,m=d.width,e=o%c,r=(o-e)/c,l=e===0?r:r+1,u=R.createImageData(m,c);let g=0;const M=d.data,I=u.data;for(let z=0;z<l;z++){const B=z<r?c:e;({srcPos:g}=(0,H.applyMaskImageData)({src:M,srcPos:g,dest:I,width:m,height:B})),R.putImageData(u,0,z*c)}}function x(R,d){const o=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let m=0,e=o.length;m<e;m++){const r=o[m];R[r]!==void 0&&(d[r]=R[r])}R.setLineDash!==void 0&&(d.setLineDash(R.getLineDash()),d.lineDashOffset=R.lineDashOffset)}function T(R,d){R.strokeStyle=R.fillStyle=d||"#000000",R.fillRule="nonzero",R.globalAlpha=1,R.lineWidth=1,R.lineCap="butt",R.lineJoin="miter",R.miterLimit=10,R.globalCompositeOperation="source-over",R.font="10px sans-serif",R.setLineDash!==void 0&&(R.setLineDash([]),R.lineDashOffset=0)}function P(R,d,o,m){const e=R.length;for(let r=3;r<e;r+=4){const l=R[r];if(l===0)R[r-3]=d,R[r-2]=o,R[r-1]=m;else if(l<255){const u=255-l;R[r-3]=R[r-3]*l+d*u>>8,R[r-2]=R[r-2]*l+o*u>>8,R[r-1]=R[r-1]*l+m*u>>8}}}function D(R,d,o){const m=R.length,e=1/255;for(let r=3;r<m;r+=4){const l=o?o[R[r]]:R[r];d[r]=d[r]*l*e|0}}function J(R,d,o){const m=R.length;for(let e=3;e<m;e+=4){const r=R[e-3]*77+R[e-2]*152+R[e-1]*28;d[e]=o?d[e]*o[r>>8]>>8:d[e]*r>>16}}function V(R,d,o,m,e,r,l,u,g,M,I){const z=!!r,B=z?r[0]:0,K=z?r[1]:0,G=z?r[2]:0;let Z;e==="Luminosity"?Z=J:Z=D;const pt=Math.min(m,Math.ceil(1048576/o));for(let At=0;At<m;At+=pt){const nt=Math.min(pt,m-At),yt=R.getImageData(u-M,At+(g-I),o,nt),X=d.getImageData(u,At+g,o,nt);z&&P(yt.data,B,K,G),Z(yt.data,X.data,l),d.putImageData(X,u,At+g)}}function k(R,d,o,m){const e=m[0],r=m[1],l=m[2]-e,u=m[3]-r;l===0||u===0||(V(d.context,o,l,u,d.subtype,d.backdrop,d.transferMap,e,r,d.offsetX,d.offsetY),R.save(),R.globalAlpha=1,R.globalCompositeOperation="source-over",R.setTransform(1,0,0,1,0,0),R.drawImage(o.canvas,0,0),R.restore())}function q(R,d){const o=b.Util.singularValueDecompose2dScale(R);o[0]=Math.fround(o[0]),o[1]=Math.fround(o[1]);const m=Math.fround((globalThis.devicePixelRatio||1)*L.PixelsPerInch.PDF_TO_CSS_UNITS);return d!==void 0?d:o[0]<=m||o[1]<=m}const y=["butt","round","square"],N=["miter","round","bevel"],O={},it={},_t=class{constructor(d,o,m,e,r,l,u,g){rt(this,ht);this.ctx=d,this.current=new n(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=o,this.objs=m,this.canvasFactory=e,this.imageLayer=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=l,this.cachedCanvases=new E(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=u,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(g==null?void 0:g.background)||null,this.foregroundColor=(g==null?void 0:g.foreground)||null,d&&i(d),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(d,o=null){return typeof d=="string"?d.startsWith("g_")?this.commonObjs.get(d):this.objs.get(d):o}beginDrawing({transform:d,viewport:o,transparency:m=!1,background:e=null}){const r=this.ctx.canvas.width,l=this.ctx.canvas.height,u=e||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const g=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const M=this.backgroundColor=this.ctx.fillStyle;let I=!0,z=u;if(this.ctx.fillStyle=u,z=this.ctx.fillStyle,I=typeof z=="string"&&/^#[0-9A-Fa-f]{6}$/.test(z),g==="#000000"&&M==="#ffffff"||g===M||!I)this.foregroundColor=this.backgroundColor=null;else{const[B,K,G]=(0,L.getRGB)(z),Z=pt=>(pt/=255,pt<=.03928?pt/12.92:((pt+.055)/1.055)**2.4),ft=Math.round(.2126*Z(B)+.7152*Z(K)+.0722*Z(G));this.selectColor=(pt,At,nt)=>{const yt=.2126*Z(pt)+.7152*Z(At)+.0722*Z(nt);return Math.round(yt)===ft?M:g}}}if(this.ctx.fillStyle=this.backgroundColor||u,this.ctx.fillRect(0,0,r,l),this.ctx.restore(),m){const g=this.cachedCanvases.getCanvas("transparent",r,l,!0);this.compositeCtx=this.ctx,this.transparentCanvas=g.canvas,this.ctx=g.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),T(this.ctx,this.foregroundColor),d&&(this.ctx.transform.apply(this.ctx,d),this.outputScaleX=d[0],this.outputScaleY=d[0]),this.ctx.transform.apply(this.ctx,o.transform),this.viewportScale=o.scale,this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()}executeOperatorList(d,o,m,e){const r=d.argsArray,l=d.fnArray;let u=o||0;const g=r.length;if(g===u)return u;const M=g-u>v&&typeof m=="function",I=M?Date.now()+F:0;let z=0;const B=this.commonObjs,K=this.objs;let G;for(;;){if(e!==void 0&&u===e.nextBreakPoint)return e.breakIt(u,m),u;if(G=l[u],G!==b.OPS.dependency)this[G].apply(this,r[u]);else for(const Z of r[u]){const ft=Z.startsWith("g_")?B:K;if(!ft.has(Z))return ft.get(Z,m),u}if(u++,u===g)return u;if(M&&++z>v){if(Date.now()>I)return m(),u;z=0}}}endDrawing(){lt(this,ht,de).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const d of this._cachedBitmapsMap.values()){for(const o of d.values())typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement&&(o.width=o.height=0);d.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(d,o){const m=d.width,e=d.height;let r=Math.max(Math.hypot(o[0],o[1]),1),l=Math.max(Math.hypot(o[2],o[3]),1),u=m,g=e,M="prescale1",I,z;for(;r>2&&u>1||l>2&&g>1;){let B=u,K=g;r>2&&u>1&&(B=Math.ceil(u/2),r/=u/B),l>2&&g>1&&(K=Math.ceil(g/2),l/=g/K),I=this.cachedCanvases.getCanvas(M,B,K,!1),z=I.context,z.clearRect(0,0,B,K),z.drawImage(d,0,0,u,g,0,0,B,K),d=I.canvas,u=B,g=K,M=M==="prescale1"?"prescale2":"prescale1"}return{img:d,paintWidth:u,paintHeight:g}}_createMaskCanvas(d){const o=this.ctx,{width:m,height:e}=d,r=this.current.fillColor,l=this.current.patternFill,u=o.mozCurrentTransform;let g,M,I,z;if((d.bitmap||d.data)&&d.count>1){const vt=d.bitmap||d.data.buffer,xt=u.slice(0,4);M=JSON.stringify(l?xt:[xt,r]),g=this._cachedBitmapsMap.get(vt),g||(g=new Map,this._cachedBitmapsMap.set(vt,g));const St=g.get(M);if(St&&!l){const kt=Math.round(Math.min(u[0],u[2])+u[4]),Rt=Math.round(Math.min(u[1],u[3])+u[5]);return{canvas:St,offsetX:kt,offsetY:Rt}}I=St}I||(z=this.cachedCanvases.getCanvas("maskCanvas",m,e,!1),f(z.context,d));let B=b.Util.transform(u,[1/m,0,0,-1/e,0,0]);B=b.Util.transform(B,[1,0,0,1,0,-e]);const K=b.Util.applyTransform([0,0],B),G=b.Util.applyTransform([m,e],B),Z=b.Util.normalizeRect([K[0],K[1],G[0],G[1]]),ft=Math.round(Z[2]-Z[0])||1,pt=Math.round(Z[3]-Z[1])||1,At=this.cachedCanvases.getCanvas("fillCanvas",ft,pt,!0),nt=At.context,yt=Math.min(K[0],G[0]),X=Math.min(K[1],G[1]);nt.translate(-yt,-X),nt.transform.apply(nt,B),I||(I=this._scaleImage(z.canvas,nt.mozCurrentTransformInverse),I=I.img,g&&l&&g.set(M,I)),nt.imageSmoothingEnabled=q(nt.mozCurrentTransform,d.interpolate),p(nt,I,0,0,I.width,I.height,0,0,m,e),nt.globalCompositeOperation="source-in";const et=b.Util.transform(nt.mozCurrentTransformInverse,[1,0,0,1,-yt,-X]);return nt.fillStyle=l?r.getPattern(o,this,et,Y.PathType.FILL):r,nt.fillRect(0,0,m,e),g&&!l&&(this.cachedCanvases.delete("fillCanvas"),g.set(M,At.canvas)),{canvas:At.canvas,offsetX:Math.round(yt),offsetY:Math.round(X)}}setLineWidth(d){d!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=d,this.ctx.lineWidth=d}setLineCap(d){this.ctx.lineCap=y[d]}setLineJoin(d){this.ctx.lineJoin=N[d]}setMiterLimit(d){this.ctx.miterLimit=d}setDash(d,o){const m=this.ctx;m.setLineDash!==void 0&&(m.setLineDash(d),m.lineDashOffset=o)}setRenderingIntent(d){}setFlatness(d){}setGState(d){for(let o=0,m=d.length;o<m;o++){const e=d[o],r=e[0],l=e[1];switch(r){case"LW":this.setLineWidth(l);break;case"LC":this.setLineCap(l);break;case"LJ":this.setLineJoin(l);break;case"ML":this.setMiterLimit(l);break;case"D":this.setDash(l[0],l[1]);break;case"RI":this.setRenderingIntent(l);break;case"FL":this.setFlatness(l);break;case"Font":this.setFont(l[0],l[1]);break;case"CA":this.current.strokeAlpha=e[1];break;case"ca":this.current.fillAlpha=e[1],this.ctx.globalAlpha=e[1];break;case"BM":this.ctx.globalCompositeOperation=l;break;case"SMask":this.current.activeSMask=l?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=l}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const d=this.inSMaskMode;this.current.activeSMask&&!d?this.beginSMaskMode():!this.current.activeSMask&&d&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const d=this.ctx.canvas.width,o=this.ctx.canvas.height,m="smaskGroupAt"+this.groupLevel,e=this.cachedCanvases.getCanvas(m,d,o,!0);this.suspendedCtx=this.ctx,this.ctx=e.context;const r=this.ctx;r.setTransform.apply(r,this.suspendedCtx.mozCurrentTransform),x(this.suspendedCtx,r),s(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),x(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(d){if(!this.current.activeSMask)return;d?(d[0]=Math.floor(d[0]),d[1]=Math.floor(d[1]),d[2]=Math.ceil(d[2]),d[3]=Math.ceil(d[3])):d=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const o=this.current.activeSMask,m=this.suspendedCtx;k(m,o,this.ctx,d),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(x(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const d=this.current;this.stateStack.push(d),this.current=d.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),x(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(d,o,m,e,r,l){this.ctx.transform(d,o,m,e,r,l),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(d,o,m){const e=this.ctx,r=this.current;let l=r.x,u=r.y,g,M;const I=e.mozCurrentTransform,z=I[0]===0&&I[3]===0||I[1]===0&&I[2]===0,B=z?m.slice(0):null;for(let K=0,G=0,Z=d.length;K<Z;K++)switch(d[K]|0){case b.OPS.rectangle:l=o[G++],u=o[G++];const ft=o[G++],pt=o[G++],At=l+ft,nt=u+pt;e.moveTo(l,u),ft===0||pt===0?e.lineTo(At,nt):(e.lineTo(At,u),e.lineTo(At,nt),e.lineTo(l,nt)),z||r.updateRectMinMax(I,[l,u,At,nt]),e.closePath();break;case b.OPS.moveTo:l=o[G++],u=o[G++],e.moveTo(l,u),z||r.updatePathMinMax(I,l,u);break;case b.OPS.lineTo:l=o[G++],u=o[G++],e.lineTo(l,u),z||r.updatePathMinMax(I,l,u);break;case b.OPS.curveTo:g=l,M=u,l=o[G+4],u=o[G+5],e.bezierCurveTo(o[G],o[G+1],o[G+2],o[G+3],l,u),r.updateCurvePathMinMax(I,g,M,o[G],o[G+1],o[G+2],o[G+3],l,u,B),G+=6;break;case b.OPS.curveTo2:g=l,M=u,e.bezierCurveTo(l,u,o[G],o[G+1],o[G+2],o[G+3]),r.updateCurvePathMinMax(I,g,M,l,u,o[G],o[G+1],o[G+2],o[G+3],B),l=o[G+2],u=o[G+3],G+=4;break;case b.OPS.curveTo3:g=l,M=u,l=o[G+2],u=o[G+3],e.bezierCurveTo(o[G],o[G+1],l,u,l,u),r.updateCurvePathMinMax(I,g,M,o[G],o[G+1],l,u,l,u,B),G+=4;break;case b.OPS.closePath:e.closePath();break}z&&r.updateScalingPathMinMax(I,B),r.setCurrentPoint(l,u)}closePath(){this.ctx.closePath()}stroke(d){d=typeof d<"u"?d:!0;const o=this.ctx,m=this.current.strokeColor;o.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof m=="object"&&(m==null?void 0:m.getPattern)?(o.save(),o.strokeStyle=m.getPattern(o,this,o.mozCurrentTransformInverse,Y.PathType.STROKE),this.rescaleAndStroke(!1),o.restore()):this.rescaleAndStroke(!0)),d&&this.consumePath(this.current.getClippedPathBoundingBox()),o.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(d){d=typeof d<"u"?d:!0;const o=this.ctx,m=this.current.fillColor,e=this.current.patternFill;let r=!1;e&&(o.save(),o.fillStyle=m.getPattern(o,this,o.mozCurrentTransformInverse,Y.PathType.FILL),r=!0);const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(o.fill("evenodd"),this.pendingEOFill=!1):o.fill()),r&&o.restore(),d&&this.consumePath(l)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=O}eoClip(){this.pendingClip=it}beginText(){this.current.textMatrix=b.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const d=this.pendingTextPaths,o=this.ctx;if(d===void 0){o.beginPath();return}o.save(),o.beginPath();for(const m of d)o.setTransform.apply(o,m.transform),o.translate(m.x,m.y),m.addToPath(o,m.fontSize);o.restore(),o.clip(),o.beginPath(),delete this.pendingTextPaths}setCharSpacing(d){this.current.charSpacing=d}setWordSpacing(d){this.current.wordSpacing=d}setHScale(d){this.current.textHScale=d/100}setLeading(d){this.current.leading=-d}setFont(d,o){const m=this.commonObjs.get(d),e=this.current;if(!m)throw new Error(`Can't find font for ${d}`);if(e.fontMatrix=m.fontMatrix||b.FONT_IDENTITY_MATRIX,(e.fontMatrix[0]===0||e.fontMatrix[3]===0)&&(0,b.warn)("Invalid font matrix for font "+d),o<0?(o=-o,e.fontDirection=-1):e.fontDirection=1,this.current.font=m,this.current.fontSize=o,m.isType3Font)return;const r=m.loadedName||"sans-serif";let l="normal";m.black?l="900":m.bold&&(l="bold");const u=m.italic?"italic":"normal",g=`"${r}", ${m.fallbackName}`;let M=o;o<j?M=j:o>A&&(M=A),this.current.fontSizeScale=o/M,this.ctx.font=`${u} ${l} ${M}px ${g}`}setTextRenderingMode(d){this.current.textRenderingMode=d}setTextRise(d){this.current.textRise=d}moveText(d,o){this.current.x=this.current.lineX+=d,this.current.y=this.current.lineY+=o}setLeadingMoveText(d,o){this.setLeading(-o),this.moveText(d,o)}setTextMatrix(d,o,m,e,r,l){this.current.textMatrix=[d,o,m,e,r,l],this.current.textMatrixScale=Math.hypot(d,o),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(d,o,m,e){const r=this.ctx,l=this.current,u=l.font,g=l.textRenderingMode,M=l.fontSize/l.fontSizeScale,I=g&b.TextRenderingMode.FILL_STROKE_MASK,z=!!(g&b.TextRenderingMode.ADD_TO_PATH_FLAG),B=l.patternFill&&!u.missingFile;let K;(u.disableFontFace||z||B)&&(K=u.getPathGenerator(this.commonObjs,d)),u.disableFontFace||B?(r.save(),r.translate(o,m),r.beginPath(),K(r,M),e&&r.setTransform.apply(r,e),(I===b.TextRenderingMode.FILL||I===b.TextRenderingMode.FILL_STROKE)&&r.fill(),(I===b.TextRenderingMode.STROKE||I===b.TextRenderingMode.FILL_STROKE)&&r.stroke(),r.restore()):((I===b.TextRenderingMode.FILL||I===b.TextRenderingMode.FILL_STROKE)&&r.fillText(d,o,m),(I===b.TextRenderingMode.STROKE||I===b.TextRenderingMode.FILL_STROKE)&&r.strokeText(d,o,m)),z&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:r.mozCurrentTransform,x:o,y:m,fontSize:M,addToPath:K})}get isFontSubpixelAAEnabled(){const{context:d}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10,!1);d.scale(1.5,1),d.fillText("I",0,10);const o=d.getImageData(0,0,10,10).data;let m=!1;for(let e=3;e<o.length;e+=4)if(o[e]>0&&o[e]<255){m=!0;break}return(0,b.shadow)(this,"isFontSubpixelAAEnabled",m)}showText(d){const o=this.current,m=o.font;if(m.isType3Font)return this.showType3Text(d);const e=o.fontSize;if(e===0)return;const r=this.ctx,l=o.fontSizeScale,u=o.charSpacing,g=o.wordSpacing,M=o.fontDirection,I=o.textHScale*M,z=d.length,B=m.vertical,K=B?1:-1,G=m.defaultVMetrics,Z=e*o.fontMatrix[0],ft=o.textRenderingMode===b.TextRenderingMode.FILL&&!m.disableFontFace&&!o.patternFill;r.save(),r.transform.apply(r,o.textMatrix),r.translate(o.x,o.y+o.textRise),M>0?r.scale(I,-1):r.scale(I,1);let pt;if(o.patternFill){r.save();const et=o.fillColor.getPattern(r,this,r.mozCurrentTransformInverse,Y.PathType.FILL);pt=r.mozCurrentTransform,r.restore(),r.fillStyle=et}let At=o.lineWidth;const nt=o.textMatrixScale;if(nt===0||At===0){const et=o.textRenderingMode&b.TextRenderingMode.FILL_STROKE_MASK;(et===b.TextRenderingMode.STROKE||et===b.TextRenderingMode.FILL_STROKE)&&(At=this.getSinglePixelWidth())}else At/=nt;l!==1&&(r.scale(l,l),At/=l),r.lineWidth=At;let yt=0,X;for(X=0;X<z;++X){const et=d[X];if(typeof et=="number"){yt+=K*et*e/1e3;continue}let vt=!1;const xt=(et.isSpace?g:0)+u,St=et.fontChar,kt=et.accent;let Rt,jt,wt=et.width;if(B){const Ot=et.vmetric||G,tt=-(et.vmetric?Ot[1]:wt*.5)*Z,ct=Ot[2]*Z;wt=Ot?-Ot[0]:wt,Rt=tt/l,jt=(yt+ct)/l}else Rt=yt/l,jt=0;if(m.remeasure&&wt>0){const Ot=r.measureText(St).width*1e3/e*l;if(wt<Ot&&this.isFontSubpixelAAEnabled){const tt=wt/Ot;vt=!0,r.save(),r.scale(tt,1),Rt/=tt}else wt!==Ot&&(Rt+=(wt-Ot)/2e3*e/l)}if(this.contentVisible&&(et.isInFont||m.missingFile)){if(ft&&!kt)r.fillText(St,Rt,jt);else if(this.paintChar(St,Rt,jt,pt),kt){const Ot=Rt+e*kt.offset.x/l,tt=jt-e*kt.offset.y/l;this.paintChar(kt.fontChar,Ot,tt,pt)}}let $t;B?$t=wt*Z-xt*M:$t=wt*Z+xt*M,yt+=$t,vt&&r.restore()}B?o.y-=yt:o.x+=yt*I,r.restore(),this.compose()}showType3Text(d){const o=this.ctx,m=this.current,e=m.font,r=m.fontSize,l=m.fontDirection,u=e.vertical?1:-1,g=m.charSpacing,M=m.wordSpacing,I=m.textHScale*l,z=m.fontMatrix||b.FONT_IDENTITY_MATRIX,B=d.length,K=m.textRenderingMode===b.TextRenderingMode.INVISIBLE;let G,Z,ft,pt;if(!(K||r===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,o.save(),o.transform.apply(o,m.textMatrix),o.translate(m.x,m.y),o.scale(I,l),G=0;G<B;++G){if(Z=d[G],typeof Z=="number"){pt=u*Z*r/1e3,this.ctx.translate(pt,0),m.x+=pt*I;continue}const At=(Z.isSpace?M:0)+g,nt=e.charProcOperatorList[Z.operatorListId];if(!nt){(0,b.warn)(`Type3 character "${Z.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Z,this.save(),o.scale(r,r),o.transform.apply(o,z),this.executeOperatorList(nt),this.restore()),ft=b.Util.applyTransform([Z.width,0],z)[0]*r+At,o.translate(ft,0),m.x+=ft*I}o.restore(),this.processingType3=null}}setCharWidth(d,o){}setCharWidthAndBounds(d,o,m,e,r,l){this.ctx.rect(m,e,r-m,l-e),this.ctx.clip(),this.endPath()}getColorN_Pattern(d){let o;if(d[0]==="TilingPattern"){const m=d[1],e=this.baseTransform||this.ctx.mozCurrentTransform.slice(),r={createCanvasGraphics:l=>new _t(l,this.commonObjs,this.objs,this.canvasFactory)};o=new Y.TilingPattern(d,m,this.ctx,r,e)}else o=this._getPattern(d[1],d[2]);return o}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(d,o,m){var r;const e=((r=this.selectColor)==null?void 0:r.call(this,d,o,m))||b.Util.makeHexColor(d,o,m);this.ctx.strokeStyle=e,this.current.strokeColor=e}setFillRGBColor(d,o,m){var r;const e=((r=this.selectColor)==null?void 0:r.call(this,d,o,m))||b.Util.makeHexColor(d,o,m);this.ctx.fillStyle=e,this.current.fillColor=e,this.current.patternFill=!1}_getPattern(d,o=null){let m;return this.cachedPatterns.has(d)?m=this.cachedPatterns.get(d):(m=(0,Y.getShadingPattern)(this.objs.get(d)),this.cachedPatterns.set(d,m)),o&&(m.matrix=o),m}shadingFill(d){if(!this.contentVisible)return;const o=this.ctx;this.save();const m=this._getPattern(d);o.fillStyle=m.getPattern(o,this,o.mozCurrentTransformInverse,Y.PathType.SHADING);const e=o.mozCurrentTransformInverse;if(e){const r=o.canvas,l=r.width,u=r.height,g=b.Util.applyTransform([0,0],e),M=b.Util.applyTransform([0,u],e),I=b.Util.applyTransform([l,0],e),z=b.Util.applyTransform([l,u],e),B=Math.min(g[0],M[0],I[0],z[0]),K=Math.min(g[1],M[1],I[1],z[1]),G=Math.max(g[0],M[0],I[0],z[0]),Z=Math.max(g[1],M[1],I[1],z[1]);this.ctx.fillRect(B,K,G-B,Z-K)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,b.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,b.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(d,o){if(!!this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(d)&&d.length===6&&this.transform.apply(this,d),this.baseTransform=this.ctx.mozCurrentTransform,o)){const m=o[2]-o[0],e=o[3]-o[1];this.ctx.rect(o[0],o[1],m,e),this.current.updateRectMinMax(this.ctx.mozCurrentTransform,o),this.clip(),this.endPath()}}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(d){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const o=this.ctx;d.isolated||(0,b.info)("TODO: Support non-isolated groups."),d.knockout&&(0,b.warn)("Knockout groups not supported.");const m=o.mozCurrentTransform;if(d.matrix&&o.transform.apply(o,d.matrix),!d.bbox)throw new Error("Bounding box is required.");let e=b.Util.getAxialAlignedBoundingBox(d.bbox,o.mozCurrentTransform);const r=[0,0,o.canvas.width,o.canvas.height];e=b.Util.intersect(e,r)||[0,0,0,0];const l=Math.floor(e[0]),u=Math.floor(e[1]);let g=Math.max(Math.ceil(e[2])-l,1),M=Math.max(Math.ceil(e[3])-u,1),I=1,z=1;g>w&&(I=g/w,g=w),M>w&&(z=M/w,M=w),this.current.startNewPathAndClipBox([0,0,g,M]);let B="groupAt"+this.groupLevel;d.smask&&(B+="_smask_"+this.smaskCounter++%2);const K=this.cachedCanvases.getCanvas(B,g,M,!0),G=K.context;G.scale(1/I,1/z),G.translate(-l,-u),G.transform.apply(G,m),d.smask?this.smaskStack.push({canvas:K.canvas,context:G,offsetX:l,offsetY:u,scaleX:I,scaleY:z,subtype:d.smask.subtype,backdrop:d.smask.backdrop,transferMap:d.smask.transferMap||null,startTransformInverse:null}):(o.setTransform(1,0,0,1,0,0),o.translate(l,u),o.scale(I,z),o.save()),x(o,G),this.ctx=G,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++}endGroup(d){if(!this.contentVisible)return;this.groupLevel--;const o=this.ctx,m=this.groupStack.pop();if(this.ctx=m,this.ctx.imageSmoothingEnabled=!1,d.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const e=this.ctx.mozCurrentTransform;this.restore(),this.ctx.save(),this.ctx.setTransform.apply(this.ctx,e);const r=b.Util.getAxialAlignedBoundingBox([0,0,o.canvas.width,o.canvas.height],e);this.ctx.drawImage(o.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(d,o,m,e,r){if(lt(this,ht,de).call(this),T(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform),Array.isArray(o)&&o.length===4){const l=o[2]-o[0],u=o[3]-o[1];if(r&&this.annotationCanvasMap){m=m.slice(),m[4]-=o[0],m[5]-=o[1],o=o.slice(),o[0]=o[1]=0,o[2]=l,o[3]=u;const[g,M]=b.Util.singularValueDecompose2dScale(this.ctx.mozCurrentTransform),{viewportScale:I}=this,z=Math.ceil(l*this.outputScaleX*I),B=Math.ceil(u*this.outputScaleY*I);this.annotationCanvas=this.canvasFactory.create(z,B);const{canvas:K,context:G}=this.annotationCanvas;this.annotationCanvasMap.set(d,K),this.annotationCanvas.savedCtx=this.ctx,this.ctx=G,i(this.ctx),this.ctx.setTransform(g,0,0,-M,0,u*M),T(this.ctx,this.foregroundColor)}else T(this.ctx,this.foregroundColor),this.ctx.rect(o[0],o[1],l,u),this.ctx.clip(),this.endPath()}this.current=new n(this.ctx.canvas.width,this.ctx.canvas.height),this.transform.apply(this,m),this.transform.apply(this,e)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(d){if(!this.contentVisible)return;const o=d.count;d=this.getObject(d.data,d),d.count=o;const m=this.ctx,e=this.processingType3;if(e&&(e.compiled===void 0&&(e.compiled=h(d)),e.compiled)){e.compiled(m);return}const r=this._createMaskCanvas(d),l=r.canvas;m.save(),m.setTransform(1,0,0,1,0,0),m.drawImage(l,r.offsetX,r.offsetY),m.restore(),this.compose()}paintImageMaskXObjectRepeat(d,o,m=0,e=0,r,l){if(!this.contentVisible)return;d=this.getObject(d.data,d);const u=this.ctx;u.save();const g=u.mozCurrentTransform;u.transform(o,m,e,r,0,0);const M=this._createMaskCanvas(d);u.setTransform(1,0,0,1,0,0);for(let I=0,z=l.length;I<z;I+=2){const B=b.Util.transform(g,[o,m,e,r,l[I],l[I+1]]),[K,G]=b.Util.applyTransform([0,0],B);u.drawImage(M.canvas,K,G)}u.restore(),this.compose()}paintImageMaskXObjectGroup(d){if(!this.contentVisible)return;const o=this.ctx,m=this.current.fillColor,e=this.current.patternFill;for(const r of d){const{data:l,width:u,height:g,transform:M}=r,I=this.cachedCanvases.getCanvas("maskCanvas",u,g,!1),z=I.context;z.save();const B=this.getObject(l,r);f(z,B),z.globalCompositeOperation="source-in",z.fillStyle=e?m.getPattern(z,this,o.mozCurrentTransformInverse,Y.PathType.FILL):m,z.fillRect(0,0,u,g),z.restore(),o.save(),o.transform.apply(o,M),o.scale(1,-1),p(o,I.canvas,0,0,u,g,0,-1,1,1),o.restore()}this.compose()}paintImageXObject(d){if(!this.contentVisible)return;const o=this.getObject(d);if(!o){(0,b.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(o)}paintImageXObjectRepeat(d,o,m,e){if(!this.contentVisible)return;const r=this.getObject(d);if(!r){(0,b.warn)("Dependent image isn't ready yet");return}const l=r.width,u=r.height,g=[];for(let M=0,I=e.length;M<I;M+=2)g.push({transform:[o,0,0,m,e[M],e[M+1]],x:0,y:0,w:l,h:u});this.paintInlineImageXObjectGroup(r,g)}paintInlineImageXObject(d){if(!this.contentVisible)return;const o=d.width,m=d.height,e=this.ctx;this.save(),e.scale(1/o,-1/m);let r;if(typeof HTMLElement=="function"&&d instanceof HTMLElement||!d.data)r=d;else{const M=this.cachedCanvases.getCanvas("inlineImage",o,m,!1),I=M.context;a(I,d,this.current.transferMaps),r=M.canvas}const l=this._scaleImage(r,e.mozCurrentTransformInverse);e.imageSmoothingEnabled=q(e.mozCurrentTransform,d.interpolate);const[u,g]=p(e,l.img,0,0,l.paintWidth,l.paintHeight,0,-m,o,m);if(this.imageLayer){const M=this.getCanvasPosition(0,-m);this.imageLayer.appendImage({imgData:d,left:M[0],top:M[1],width:u,height:g})}this.compose(),this.restore()}paintInlineImageXObjectGroup(d,o){if(!this.contentVisible)return;const m=this.ctx,e=d.width,r=d.height,l=this.cachedCanvases.getCanvas("inlineImage",e,r,!1),u=l.context;a(u,d,this.current.transferMaps);for(let g=0,M=o.length;g<M;g++){const I=o[g];if(m.save(),m.transform.apply(m,I.transform),m.scale(1,-1),p(m,l.canvas,I.x,I.y,I.w,I.h,0,-1,1,1),this.imageLayer){const z=this.getCanvasPosition(I.x,I.y);this.imageLayer.appendImage({imgData:d,left:z[0],top:z[1],width:e,height:r})}m.restore()}this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(d){}markPointProps(d,o){}beginMarkedContent(d){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(d,o){d==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(o)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(d){const o=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(d);const m=this.ctx;this.pendingClip&&(o||(this.pendingClip===it?m.clip("evenodd"):m.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),m.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const d=this.ctx.mozCurrentTransform;if(d[1]===0&&d[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(d[0]),Math.abs(d[3]));else{const o=Math.abs(d[0]*d[3]-d[2]*d[1]),m=Math.hypot(d[0],d[2]),e=Math.hypot(d[1],d[3]);this._cachedGetSinglePixelWidth=Math.max(m,e)/o}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:d}=this.current,o=this.ctx.mozCurrentTransform;let m,e;if(o[1]===0&&o[2]===0){const r=Math.abs(o[0]),l=Math.abs(o[3]);if(d===0)m=1/r,e=1/l;else{const u=r*d,g=l*d;m=u<1?1/u:1,e=g<1?1/g:1}}else{const r=Math.abs(o[0]*o[3]-o[2]*o[1]),l=Math.hypot(o[0],o[1]),u=Math.hypot(o[2],o[3]);if(d===0)m=u/r,e=l/r;else{const g=d*r;m=u>g?u/g:1,e=l>g?l/g:1}}this._cachedScaleForStroking=[m,e]}return this._cachedScaleForStroking}rescaleAndStroke(d){const{ctx:o}=this,{lineWidth:m}=this.current,[e,r]=this.getScaleForStroking();if(o.lineWidth=m||1,e===1&&r===1){o.stroke();return}let l,u,g;d&&(l=o.mozCurrentTransform.slice(),u=o.getLineDash().slice(),g=o.lineDashOffset),o.scale(e,r);const M=Math.max(e,r);o.setLineDash(o.getLineDash().map(I=>I/M)),o.lineDashOffset/=M,o.stroke(),d&&(o.setTransform(...l),o.setLineDash(u),o.lineDashOffset=g)}getCanvasPosition(d,o){const m=this.ctx.mozCurrentTransform;return[m[0]*d+m[2]*o+m[4],m[1]*d+m[3]*o+m[5]]}isContentVisible(){for(let d=this.markedContentStack.length-1;d>=0;d--)if(!this.markedContentStack[d].visible)return!1;return!0}};let ot=_t;ht=new WeakSet,de=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},_.CanvasGraphics=ot;for(const R in b.OPS)ot.prototype[R]!==void 0&&(ot.prototype[b.OPS[R]]=ot.prototype[R])},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.TilingPattern=_.PathType=void 0,_.getShadingPattern=C;var b=Q(1),L=Q(3);const Y={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};_.PathType=Y;function H(s,i){if(!i||L.isNodeJS)return;const E=i[2]-i[0],p=i[3]-i[1],h=new Path2D;h.rect(i[0],i[1],E,p),s.clip(h)}class st{constructor(){this.constructor===st&&(0,b.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,b.unreachable)("Abstract method `getPattern` called.")}}class j extends st{constructor(i){super(),this._type=i[1],this._bbox=i[2],this._colorStops=i[3],this._p0=i[4],this._p1=i[5],this._r0=i[6],this._r1=i[7],this.matrix=null}_createGradient(i){let E;this._type==="axial"?E=i.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(E=i.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const p of this._colorStops)E.addColorStop(p[0],p[1]);return E}getPattern(i,E,p,h){let n;if(h===Y.STROKE||h===Y.FILL){const a=E.current.getClippedPathBoundingBox(h,i.mozCurrentTransform)||[0,0,0,0],f=Math.ceil(a[2]-a[0])||1,x=Math.ceil(a[3]-a[1])||1,T=E.cachedCanvases.getCanvas("pattern",f,x,!0),P=T.context;P.clearRect(0,0,P.canvas.width,P.canvas.height),P.beginPath(),P.rect(0,0,P.canvas.width,P.canvas.height),P.translate(-a[0],-a[1]),p=b.Util.transform(p,[1,0,0,1,a[0],a[1]]),P.transform.apply(P,E.baseTransform),this.matrix&&P.transform.apply(P,this.matrix),H(P,this._bbox),P.fillStyle=this._createGradient(P),P.fill(),n=i.createPattern(T.canvas,"no-repeat");const D=new DOMMatrix(p);try{n.setTransform(D)}catch(J){(0,b.warn)(`RadialAxialShadingPattern.getPattern: "${J==null?void 0:J.message}".`)}}else H(i,this._bbox),n=this._createGradient(i);return n}}function A(s,i,E,p,h,n,a,f){const x=i.coords,T=i.colors,P=s.data,D=s.width*4;let J;x[E+1]>x[p+1]&&(J=E,E=p,p=J,J=n,n=a,a=J),x[p+1]>x[h+1]&&(J=p,p=h,h=J,J=a,a=f,f=J),x[E+1]>x[p+1]&&(J=E,E=p,p=J,J=n,n=a,a=J);const V=(x[E]+i.offsetX)*i.scaleX,k=(x[E+1]+i.offsetY)*i.scaleY,q=(x[p]+i.offsetX)*i.scaleX,y=(x[p+1]+i.offsetY)*i.scaleY,N=(x[h]+i.offsetX)*i.scaleX,O=(x[h+1]+i.offsetY)*i.scaleY;if(k>=O)return;const it=T[n],ot=T[n+1],ht=T[n+2],mt=T[a],_t=T[a+1],R=T[a+2],d=T[f],o=T[f+1],m=T[f+2],e=Math.round(k),r=Math.round(O);let l,u,g,M,I,z,B,K;for(let G=e;G<=r;G++){if(G<y){let nt;G<k?nt=0:nt=(k-G)/(k-y),l=V-(V-q)*nt,u=it-(it-mt)*nt,g=ot-(ot-_t)*nt,M=ht-(ht-R)*nt}else{let nt;G>O?nt=1:y===O?nt=0:nt=(y-G)/(y-O),l=q-(q-N)*nt,u=mt-(mt-d)*nt,g=_t-(_t-o)*nt,M=R-(R-m)*nt}let Z;G<k?Z=0:G>O?Z=1:Z=(k-G)/(k-O),I=V-(V-N)*Z,z=it-(it-d)*Z,B=ot-(ot-o)*Z,K=ht-(ht-m)*Z;const ft=Math.round(Math.min(l,I)),pt=Math.round(Math.max(l,I));let At=D*G+ft*4;for(let nt=ft;nt<=pt;nt++)Z=(l-nt)/(l-I),Z<0?Z=0:Z>1&&(Z=1),P[At++]=u-(u-z)*Z|0,P[At++]=g-(g-B)*Z|0,P[At++]=M-(M-K)*Z|0,P[At++]=255}}function w(s,i,E){const p=i.coords,h=i.colors;let n,a;switch(i.type){case"lattice":const f=i.verticesPerRow,x=Math.floor(p.length/f)-1,T=f-1;for(n=0;n<x;n++){let P=n*f;for(let D=0;D<T;D++,P++)A(s,E,p[P],p[P+1],p[P+f],h[P],h[P+1],h[P+f]),A(s,E,p[P+f+1],p[P+1],p[P+f],h[P+f+1],h[P+1],h[P+f])}break;case"triangles":for(n=0,a=p.length;n<a;n+=3)A(s,E,p[n],p[n+1],p[n+2],h[n],h[n+1],h[n+2]);break;default:throw new Error("illegal figure")}}class F extends st{constructor(i){super(),this._coords=i[2],this._colors=i[3],this._figures=i[4],this._bounds=i[5],this._bbox=i[7],this._background=i[8],this.matrix=null}_createMeshCanvas(i,E,p){const f=Math.floor(this._bounds[0]),x=Math.floor(this._bounds[1]),T=Math.ceil(this._bounds[2])-f,P=Math.ceil(this._bounds[3])-x,D=Math.min(Math.ceil(Math.abs(T*i[0]*1.1)),3e3),J=Math.min(Math.ceil(Math.abs(P*i[1]*1.1)),3e3),V=T/D,k=P/J,q={coords:this._coords,colors:this._colors,offsetX:-f,offsetY:-x,scaleX:1/V,scaleY:1/k},y=D+2*2,N=J+2*2,O=p.getCanvas("mesh",y,N,!1),it=O.context,ot=it.createImageData(D,J);if(E){const mt=ot.data;for(let _t=0,R=mt.length;_t<R;_t+=4)mt[_t]=E[0],mt[_t+1]=E[1],mt[_t+2]=E[2],mt[_t+3]=255}for(const mt of this._figures)w(ot,mt,q);return it.putImageData(ot,2,2),{canvas:O.canvas,offsetX:f-2*V,offsetY:x-2*k,scaleX:V,scaleY:k}}getPattern(i,E,p,h){H(i,this._bbox);let n;if(h===Y.SHADING)n=b.Util.singularValueDecompose2dScale(i.mozCurrentTransform);else if(n=b.Util.singularValueDecompose2dScale(E.baseTransform),this.matrix){const f=b.Util.singularValueDecompose2dScale(this.matrix);n=[n[0]*f[0],n[1]*f[1]]}const a=this._createMeshCanvas(n,h===Y.SHADING?null:this._background,E.cachedCanvases);return h!==Y.SHADING&&(i.setTransform.apply(i,E.baseTransform),this.matrix&&i.transform.apply(i,this.matrix)),i.translate(a.offsetX,a.offsetY),i.scale(a.scaleX,a.scaleY),i.createPattern(a.canvas,"no-repeat")}}class v extends st{getPattern(){return"hotpink"}}function C(s){switch(s[0]){case"RadialAxial":return new j(s);case"Mesh":return new F(s);case"Dummy":return new v}throw new Error(`Unknown IR type: ${s[0]}`)}const c={COLORED:1,UNCOLORED:2};class t{static get MAX_PATTERN_SIZE(){return(0,b.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(i,E,p,h,n){this.operatorList=i[2],this.matrix=i[3]||[1,0,0,1,0,0],this.bbox=i[4],this.xstep=i[5],this.ystep=i[6],this.paintType=i[7],this.tilingType=i[8],this.color=E,this.ctx=p,this.canvasGraphicsFactory=h,this.baseTransform=n}createPatternCanvas(i){const E=this.operatorList,p=this.bbox,h=this.xstep,n=this.ystep,a=this.paintType,f=this.tilingType,x=this.color,T=this.canvasGraphicsFactory;(0,b.info)("TilingType: "+f);const P=p[0],D=p[1],J=p[2],V=p[3],k=b.Util.singularValueDecompose2dScale(this.matrix),q=b.Util.singularValueDecompose2dScale(this.baseTransform),y=[k[0]*q[0],k[1]*q[1]],N=this.getSizeAndScale(h,this.ctx.canvas.width,y[0]),O=this.getSizeAndScale(n,this.ctx.canvas.height,y[1]),it=i.cachedCanvases.getCanvas("pattern",N.size,O.size,!0),ot=it.context,ht=T.createCanvasGraphics(ot);ht.groupLevel=i.groupLevel,this.setFillAndStrokeStyleToContext(ht,a,x);let mt=P,_t=D,R=J,d=V;return P<0&&(mt=0,R+=Math.abs(P)),D<0&&(_t=0,d+=Math.abs(D)),ot.translate(-(N.scale*mt),-(O.scale*_t)),ht.transform(N.scale,0,0,O.scale,0,0),ot.save(),this.clipBbox(ht,mt,_t,R,d),ht.baseTransform=ht.ctx.mozCurrentTransform.slice(),ht.executeOperatorList(E),ht.endDrawing(),{canvas:it.canvas,scaleX:N.scale,scaleY:O.scale,offsetX:mt,offsetY:_t}}getSizeAndScale(i,E,p){i=Math.abs(i);const h=Math.max(t.MAX_PATTERN_SIZE,E);let n=Math.ceil(i*p);return n>=h?n=h:p=n/i,{scale:p,size:n}}clipBbox(i,E,p,h,n){const a=h-E,f=n-p;i.ctx.rect(E,p,a,f),i.current.updateRectMinMax(i.ctx.mozCurrentTransform,[E,p,h,n]),i.clip(),i.endPath()}setFillAndStrokeStyleToContext(i,E,p){const h=i.ctx,n=i.current;switch(E){case c.COLORED:const a=this.ctx;h.fillStyle=a.fillStyle,h.strokeStyle=a.strokeStyle,n.fillColor=a.fillStyle,n.strokeColor=a.strokeStyle;break;case c.UNCOLORED:const f=b.Util.makeHexColor(p[0],p[1],p[2]);h.fillStyle=f,h.strokeStyle=f,n.fillColor=f,n.strokeColor=f;break;default:throw new b.FormatError(`Unsupported paint type: ${E}`)}}getPattern(i,E,p,h){let n=p;h!==Y.SHADING&&(n=b.Util.transform(n,E.baseTransform),this.matrix&&(n=b.Util.transform(n,this.matrix)));const a=this.createPatternCanvas(E);let f=new DOMMatrix(n);f=f.translate(a.offsetX,a.offsetY),f=f.scale(1/a.scaleX,1/a.scaleY);const x=i.createPattern(a.canvas,"repeat");try{x.setTransform(f)}catch(T){(0,b.warn)(`TilingPattern.getPattern: "${T==null?void 0:T.message}".`)}return x}}_.TilingPattern=t},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.applyMaskImageData=L;var b=Q(1);function L({src:Y,srcPos:H=0,dest:st,destPos:j=0,width:A,height:w,inverseDecode:F=!1}){const v=b.FeatureTest.isLittleEndian?4278190080:255,[C,c]=F?[0,v]:[v,0],t=A>>3,s=A&7,i=Y.length;st=new Uint32Array(st.buffer);for(let E=0;E<w;E++){for(const h=H+t;H<h;H++){const n=H<i?Y[H]:255;st[j++]=n&128?c:C,st[j++]=n&64?c:C,st[j++]=n&32?c:C,st[j++]=n&16?c:C,st[j++]=n&8?c:C,st[j++]=n&4?c:C,st[j++]=n&2?c:C,st[j++]=n&1?c:C}if(s===0)continue;const p=H<i?Y[H++]:255;for(let h=0;h<s;h++)st[j++]=p&1<<7-h?c:C}return{srcPos:H,destPos:j}}},(at,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.GlobalWorkerOptions=void 0;const Q=Object.create(null);_.GlobalWorkerOptions=Q,Q.workerPort=Q.workerPort===void 0?null:Q.workerPort,Q.workerSrc=Q.workerSrc===void 0?"":Q.workerSrc},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.MessageHandler=void 0;var b=Q(1);const L={UNKNOWN:0,DATA:1,ERROR:2},Y={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function H(j){switch(j instanceof Error||typeof j=="object"&&j!==null||(0,b.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),j.name){case"AbortException":return new b.AbortException(j.message);case"MissingPDFException":return new b.MissingPDFException(j.message);case"PasswordException":return new b.PasswordException(j.message,j.code);case"UnexpectedResponseException":return new b.UnexpectedResponseException(j.message,j.status);case"UnknownErrorException":return new b.UnknownErrorException(j.message,j.details);default:return new b.UnknownErrorException(j.message,j.toString())}}class st{constructor(A,w,F){this.sourceName=A,this.targetName=w,this.comObj=F,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=v=>{const C=v.data;if(C.targetName!==this.sourceName)return;if(C.stream){this._processStreamMessage(C);return}if(C.callback){const t=C.callbackId,s=this.callbackCapabilities[t];if(!s)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],C.callback===L.DATA)s.resolve(C.data);else if(C.callback===L.ERROR)s.reject(H(C.reason));else throw new Error("Unexpected callback case");return}const c=this.actionHandler[C.action];if(!c)throw new Error(`Unknown action from worker: ${C.action}`);if(C.callbackId){const t=this.sourceName,s=C.sourceName;new Promise(function(i){i(c(C.data))}).then(function(i){F.postMessage({sourceName:t,targetName:s,callback:L.DATA,callbackId:C.callbackId,data:i})},function(i){F.postMessage({sourceName:t,targetName:s,callback:L.ERROR,callbackId:C.callbackId,reason:H(i)})});return}if(C.streamId){this._createStreamSink(C);return}c(C.data)},F.addEventListener("message",this._onComObjOnMessage)}on(A,w){const F=this.actionHandler;if(F[A])throw new Error(`There is already an actionName called "${A}"`);F[A]=w}send(A,w,F){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,data:w},F)}sendWithPromise(A,w,F){const v=this.callbackId++,C=(0,b.createPromiseCapability)();this.callbackCapabilities[v]=C;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,callbackId:v,data:w},F)}catch(c){C.reject(c)}return C.promise}sendWithStream(A,w,F,v){const C=this.streamId++,c=this.sourceName,t=this.targetName,s=this.comObj;return new ReadableStream({start:i=>{const E=(0,b.createPromiseCapability)();return this.streamControllers[C]={controller:i,startCall:E,pullCall:null,cancelCall:null,isClosed:!1},s.postMessage({sourceName:c,targetName:t,action:A,streamId:C,data:w,desiredSize:i.desiredSize},v),E.promise},pull:i=>{const E=(0,b.createPromiseCapability)();return this.streamControllers[C].pullCall=E,s.postMessage({sourceName:c,targetName:t,stream:Y.PULL,streamId:C,desiredSize:i.desiredSize}),E.promise},cancel:i=>{(0,b.assert)(i instanceof Error,"cancel must have a valid reason");const E=(0,b.createPromiseCapability)();return this.streamControllers[C].cancelCall=E,this.streamControllers[C].isClosed=!0,s.postMessage({sourceName:c,targetName:t,stream:Y.CANCEL,streamId:C,reason:H(i)}),E.promise}},F)}_createStreamSink(A){const w=A.streamId,F=this.sourceName,v=A.sourceName,C=this.comObj,c=this,t=this.actionHandler[A.action],s={enqueue(i,E=1,p){if(this.isCancelled)return;const h=this.desiredSize;this.desiredSize-=E,h>0&&this.desiredSize<=0&&(this.sinkCapability=(0,b.createPromiseCapability)(),this.ready=this.sinkCapability.promise),C.postMessage({sourceName:F,targetName:v,stream:Y.ENQUEUE,streamId:w,chunk:i},p)},close(){this.isCancelled||(this.isCancelled=!0,C.postMessage({sourceName:F,targetName:v,stream:Y.CLOSE,streamId:w}),delete c.streamSinks[w])},error(i){(0,b.assert)(i instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,C.postMessage({sourceName:F,targetName:v,stream:Y.ERROR,streamId:w,reason:H(i)}))},sinkCapability:(0,b.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:A.desiredSize,ready:null};s.sinkCapability.resolve(),s.ready=s.sinkCapability.promise,this.streamSinks[w]=s,new Promise(function(i){i(t(A.data,s))}).then(function(){C.postMessage({sourceName:F,targetName:v,stream:Y.START_COMPLETE,streamId:w,success:!0})},function(i){C.postMessage({sourceName:F,targetName:v,stream:Y.START_COMPLETE,streamId:w,reason:H(i)})})}_processStreamMessage(A){const w=A.streamId,F=this.sourceName,v=A.sourceName,C=this.comObj,c=this.streamControllers[w],t=this.streamSinks[w];switch(A.stream){case Y.START_COMPLETE:A.success?c.startCall.resolve():c.startCall.reject(H(A.reason));break;case Y.PULL_COMPLETE:A.success?c.pullCall.resolve():c.pullCall.reject(H(A.reason));break;case Y.PULL:if(!t){C.postMessage({sourceName:F,targetName:v,stream:Y.PULL_COMPLETE,streamId:w,success:!0});break}t.desiredSize<=0&&A.desiredSize>0&&t.sinkCapability.resolve(),t.desiredSize=A.desiredSize,new Promise(function(s){s(t.onPull&&t.onPull())}).then(function(){C.postMessage({sourceName:F,targetName:v,stream:Y.PULL_COMPLETE,streamId:w,success:!0})},function(s){C.postMessage({sourceName:F,targetName:v,stream:Y.PULL_COMPLETE,streamId:w,reason:H(s)})});break;case Y.ENQUEUE:if((0,b.assert)(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(A.chunk);break;case Y.CLOSE:if((0,b.assert)(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this._deleteStreamController(c,w);break;case Y.ERROR:(0,b.assert)(c,"error should have stream controller"),c.controller.error(H(A.reason)),this._deleteStreamController(c,w);break;case Y.CANCEL_COMPLETE:A.success?c.cancelCall.resolve():c.cancelCall.reject(H(A.reason)),this._deleteStreamController(c,w);break;case Y.CANCEL:if(!t)break;new Promise(function(s){s(t.onCancel&&t.onCancel(H(A.reason)))}).then(function(){C.postMessage({sourceName:F,targetName:v,stream:Y.CANCEL_COMPLETE,streamId:w,success:!0})},function(s){C.postMessage({sourceName:F,targetName:v,stream:Y.CANCEL_COMPLETE,streamId:w,reason:H(s)})}),t.sinkCapability.reject(H(A.reason)),t.isCancelled=!0,delete this.streamSinks[w];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(A,w){await Promise.allSettled([A.startCall&&A.startCall.promise,A.pullCall&&A.pullCall.promise,A.cancelCall&&A.cancelCall.promise]),delete this.streamControllers[w]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}_.MessageHandler=st},(at,_,Q)=>{var Y,H;Object.defineProperty(_,"__esModule",{value:!0}),_.Metadata=void 0;var b=Q(1);class L{constructor({parsedData:j,rawData:A}){rt(this,Y,void 0);rt(this,H,void 0);ut(this,Y,j),ut(this,H,A)}getRaw(){return S(this,H)}get(j){var A;return(A=S(this,Y).get(j))!=null?A:null}getAll(){return(0,b.objectFromMap)(S(this,Y))}has(j){return S(this,Y).has(j)}}Y=new WeakMap,H=new WeakMap,_.Metadata=L},(at,_,Q)=>{var st,j,A,w,F,v,ue;Object.defineProperty(_,"__esModule",{value:!0}),_.OptionalContentConfig=void 0;var b=Q(1);const L=Symbol("INTERNAL");class Y{constructor(t,s){rt(this,st,!0);this.name=t,this.intent=s}get visible(){return S(this,st)}_setVisible(t,s){t!==L&&(0,b.unreachable)("Internal method `_setVisible` called."),ut(this,st,s)}}st=new WeakMap;class H{constructor(t){rt(this,v);rt(this,j,!0);rt(this,A,new Map);rt(this,w,null);rt(this,F,null);if(this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,ut(this,F,t.order);for(const s of t.groups)S(this,A).set(s.id,new Y(s.name,s.intent));if(t.baseState==="OFF")for(const s of S(this,A).values())s._setVisible(L,!1);for(const s of t.on)S(this,A).get(s)._setVisible(L,!0);for(const s of t.off)S(this,A).get(s)._setVisible(L,!1);ut(this,w,new Map);for(const[s,i]of S(this,A))S(this,w).set(s,i.visible)}}isVisible(t){if(S(this,A).size===0)return!0;if(!t)return(0,b.warn)("Optional content group not defined."),!0;if(t.type==="OCG")return S(this,A).has(t.id)?S(this,A).get(t.id).visible:((0,b.warn)(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return lt(this,v,ue).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const s of t.ids){if(!S(this,A).has(s))return(0,b.warn)(`Optional content group not found: ${s}`),!0;if(S(this,A).get(s).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const s of t.ids){if(!S(this,A).has(s))return(0,b.warn)(`Optional content group not found: ${s}`),!0;if(!S(this,A).get(s).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const s of t.ids){if(!S(this,A).has(s))return(0,b.warn)(`Optional content group not found: ${s}`),!0;if(!S(this,A).get(s).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const s of t.ids){if(!S(this,A).has(s))return(0,b.warn)(`Optional content group not found: ${s}`),!0;if(S(this,A).get(s).visible)return!1}return!0}return(0,b.warn)(`Unknown optional content policy ${t.policy}.`),!0}return(0,b.warn)(`Unknown group type ${t.type}.`),!0}setVisibility(t,s=!0){if(!S(this,A).has(t)){(0,b.warn)(`Optional content group not found: ${t}`);return}S(this,A).get(t)._setVisible(L,!!s),ut(this,j,null)}get hasInitialVisibility(){if(S(this,j)!==null)return S(this,j);for(const[t,s]of S(this,A)){const i=S(this,w).get(t);if(s.visible!==i)return ut(this,j,!1)}return ut(this,j,!0)}getOrder(){return S(this,A).size?S(this,F)?S(this,F).slice():[...S(this,A).keys()]:null}getGroups(){return S(this,A).size>0?(0,b.objectFromMap)(S(this,A)):null}getGroup(t){return S(this,A).get(t)||null}}j=new WeakMap,A=new WeakMap,w=new WeakMap,F=new WeakMap,v=new WeakSet,ue=function(t){const s=t.length;if(s<2)return!0;const i=t[0];for(let E=1;E<s;E++){const p=t[E];let h;if(Array.isArray(p))h=lt(this,v,ue).call(this,p);else if(S(this,A).has(p))h=S(this,A).get(p).visible;else return(0,b.warn)(`Optional content group not found: ${p}`),!0;switch(i){case"And":if(!h)return!1;break;case"Or":if(h)return!0;break;case"Not":return!h;default:return!0}}return i==="And"},_.OptionalContentConfig=H},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.PDFDataTransportStream=void 0;var b=Q(1),L=Q(4);class Y{constructor(A,w){(0,b.assert)(w,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=A.progressiveDone||!1,this._contentDispositionFilename=A.contentDispositionFilename||null;const F=A.initialData;if((F==null?void 0:F.length)>0){const v=new Uint8Array(F).buffer;this._queuedChunks.push(v)}this._pdfDataRangeTransport=w,this._isStreamingSupported=!A.disableStream,this._isRangeSupported=!A.disableRange,this._contentLength=A.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((v,C)=>{this._onReceiveData({begin:v,chunk:C})}),this._pdfDataRangeTransport.addProgressListener((v,C)=>{this._onProgress({loaded:v,total:C})}),this._pdfDataRangeTransport.addProgressiveReadListener(v=>{this._onReceiveData({chunk:v})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(A){const w=new Uint8Array(A.chunk).buffer;if(A.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(w):this._queuedChunks.push(w);else{const F=this._rangeReaders.some(function(v){return v._begin!==A.begin?!1:(v._enqueue(w),!0)});(0,b.assert)(F,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var A,w;return(w=(A=this._fullRequestReader)==null?void 0:A._loaded)!=null?w:0}_onProgress(A){if(A.total===void 0){const w=this._rangeReaders[0];w!=null&&w.onProgress&&w.onProgress({loaded:A.loaded})}else{const w=this._fullRequestReader;w!=null&&w.onProgress&&w.onProgress({loaded:A.loaded,total:A.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(A){const w=this._rangeReaders.indexOf(A);w>=0&&this._rangeReaders.splice(w,1)}getFullReader(){(0,b.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const A=this._queuedChunks;return this._queuedChunks=null,new H(this,A,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(A,w){if(w<=this._progressiveDataLength)return null;const F=new st(this,A,w);return this._pdfDataRangeTransport.requestDataRange(A,w),this._rangeReaders.push(F),F}cancelAllRequests(A){this._fullRequestReader&&this._fullRequestReader.cancel(A);for(const w of this._rangeReaders.slice(0))w.cancel(A);this._pdfDataRangeTransport.abort()}}_.PDFDataTransportStream=Y;class H{constructor(A,w,F=!1,v=null){this._stream=A,this._done=F||!1,this._filename=(0,L.isPdfFile)(v)?v:null,this._queuedChunks=w||[],this._loaded=0;for(const C of this._queuedChunks)this._loaded+=C.byteLength;this._requests=[],this._headersReady=Promise.resolve(),A._fullRequestReader=this,this.onProgress=null}_enqueue(A){this._done||(this._requests.length>0?this._requests.shift().resolve({value:A,done:!1}):this._queuedChunks.push(A),this._loaded+=A.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=(0,b.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const w of this._requests)w.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class st{constructor(A,w,F){this._stream=A,this._begin=w,this._end=F,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(A){if(!this._done){if(this._requests.length===0)this._queuedChunk=A;else{this._requests.shift().resolve({value:A,done:!1});for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const w=this._queuedChunk;return this._queuedChunk=null,{value:w,done:!1}}if(this._done)return{value:void 0,done:!0};const A=(0,b.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const w of this._requests)w.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(at,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.XfaText=void 0;class Q{static textContent(L){const Y=[],H={items:Y,styles:Object.create(null)};function st(j){var F;if(!j)return;let A=null;const w=j.name;if(w==="#text")A=j.value;else if(Q.shouldBuildText(w))(F=j==null?void 0:j.attributes)!=null&&F.textContent?A=j.attributes.textContent:j.value&&(A=j.value);else return;if(A!==null&&Y.push({str:A}),!!j.children)for(const v of j.children)st(v)}return st(L),H}static shouldBuildText(L){return!(L==="textarea"||L==="input"||L==="option"||L==="select")}}_.XfaText=Q},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.NodeStandardFontDataFactory=_.NodeCanvasFactory=_.NodeCMapReaderFactory=void 0;var b=Q(5);const L=function(j){return new Promise((A,w)=>{require$$5.readFile(j,(v,C)=>{if(v||!C){w(new Error(v));return}A(new Uint8Array(C))})})};class Y extends b.BaseCanvasFactory{_createCanvas(A,w){return require$$1.createCanvas(A,w)}}_.NodeCanvasFactory=Y;class H extends b.BaseCMapReaderFactory{_fetchData(A,w){return L(A).then(F=>({cMapData:F,compressionType:w}))}}_.NodeCMapReaderFactory=H;class st extends b.BaseStandardFontDataFactory{_fetchData(A){return L(A)}}_.NodeStandardFontDataFactory=st},(at,_,Q)=>{var A,w,F,v,C,c,t,s,i,E,fe,h,pe,a,ee,x,Fe,P,ge,J,Re;Object.defineProperty(_,"__esModule",{value:!0}),_.AnnotationEditorLayer=void 0;var b=Q(1),L=Q(9),Y=Q(4),H=Q(23),st=Q(24);const k=class{constructor(y){rt(this,E);rt(this,h);rt(this,x);rt(this,P);rt(this,J);rt(this,A,!1);rt(this,w,this.pointerup.bind(this));rt(this,F,this.pointerdown.bind(this));rt(this,v,new Map);rt(this,C,!1);rt(this,c,new WeakMap);rt(this,t,new Map);rt(this,s,void 0);rt(this,i,new Set);k._initialized||(k._initialized=!0,H.FreeTextEditor.initialize(y.l10n),st.InkEditor.initialize(y.l10n),y.uiManager.registerEditorTypes([H.FreeTextEditor,st.InkEditor])),ut(this,s,y.uiManager),this.annotationStorage=y.annotationStorage,this.pageIndex=y.pageIndex,this.div=y.div,S(this,s).addLayer(this)}get textLayerElements(){const y=this.div.parentNode.getElementsByClassName("textLayer").item(0);if(!y)return(0,b.shadow)(this,"textLayerElements",null);let N=S(this,c).get(y);return N||(N=y.querySelectorAll('span[role="presentation"]'),N.length===0?(0,b.shadow)(this,"textLayerElements",null):(N=Array.from(N),N.sort(lt(k,a,ee)),S(this,c).set(y,N),N))}updateToolbar(y){S(this,s).updateToolbar(y)}updateMode(y=S(this,s).getMode()){lt(this,J,Re).call(this),y===b.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),S(this,s).unselectAll()}addInkEditorIfNeeded(y){if(!y&&S(this,s).getMode()!==b.AnnotationEditorType.INK)return;if(!y){for(const O of S(this,v).values())if(O.isEmpty()){O.setInBackground();return}}lt(this,P,ge).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(y){S(this,s).setEditingState(y)}addCommands(y){S(this,s).addCommands(y)}enable(){this.div.style.pointerEvents="auto";for(const y of S(this,v).values())y.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const y of S(this,v).values())y.disableEditing()}setActiveEditor(y){S(this,s).getActive()!==y&&S(this,s).setActiveEditor(y)}enableClick(){this.div.addEventListener("pointerdown",S(this,F)),this.div.addEventListener("pointerup",S(this,w))}disableClick(){this.div.removeEventListener("pointerdown",S(this,F)),this.div.removeEventListener("pointerup",S(this,w))}attach(y){S(this,v).set(y.id,y)}detach(y){S(this,v).delete(y.id),this.removePointerInTextLayer(y)}remove(y){S(this,s).removeEditor(y),this.detach(y),this.annotationStorage.removeKey(y.id),y.div.style.display="none",setTimeout(()=>{y.div.style.display="",y.div.remove(),y.isAttachedToDOM=!1,document.activeElement===document.body&&S(this,s).focusMainContainer()},0),S(this,C)||this.addInkEditorIfNeeded(!1)}onTextLayerRendered(){S(this,t).clear();for(const y of S(this,i))y.isAttachedToDOM&&this.addPointerInTextLayer(y);S(this,i).clear()}removePointerInTextLayer(y){if(!S(this,E,fe)){S(this,i).delete(y);return}const{id:N}=y,O=S(this,t).get(N);if(!O)return;S(this,t).delete(N);let it=O.getAttribute("aria-owns");it!=null&&it.includes(N)&&(it=it.split(" ").filter(ot=>ot!==N).join(" "),it?O.setAttribute("aria-owns",it):(O.removeAttribute("aria-owns"),O.setAttribute("role","presentation")))}addPointerInTextLayer(y){if(!S(this,E,fe)){S(this,i).add(y);return}this.removePointerInTextLayer(y);const N=this.textLayerElements;if(!N)return;const{contentDiv:O}=y,it=y.getIdForTextLayer(),ot=(0,Y.binarySearchFirstItem)(N,_t=>{var R;return lt(R=k,a,ee).call(R,O,_t)<0}),ht=N[Math.max(0,ot-1)],mt=ht.getAttribute("aria-owns");mt!=null&&mt.includes(it)||ht.setAttribute("aria-owns",mt?`${mt} ${it}`:it),ht.removeAttribute("role"),S(this,t).set(it,ht)}moveDivInDOM(y){this.addPointerInTextLayer(y);const{div:N,contentDiv:O}=y;if(!this.div.hasChildNodes()){this.div.append(N);return}const it=Array.from(this.div.childNodes).filter(ht=>ht!==N);if(it.length===0)return;const ot=(0,Y.binarySearchFirstItem)(it,ht=>{var mt;return lt(mt=k,a,ee).call(mt,O,ht)<0});ot===0?it[0].before(N):it[ot-1].after(N)}add(y){if(lt(this,h,pe).call(this,y),this.addToAnnotationStorage(y),S(this,s).addEditor(y),this.attach(y),!y.isAttachedToDOM){const N=y.render();this.div.append(N),y.isAttachedToDOM=!0}this.moveDivInDOM(y),y.onceAdded()}addToAnnotationStorage(y){!y.isEmpty()&&!this.annotationStorage.has(y.id)&&this.annotationStorage.setValue(y.id,y)}addOrRebuild(y){y.needsToBeRebuilt()?y.rebuild():this.add(y)}addANewEditor(y){const N=()=>{this.addOrRebuild(y)},O=()=>{y.remove()};this.addCommands({cmd:N,undo:O,mustExec:!0})}addUndoableEditor(y){const N=()=>{this.addOrRebuild(y)},O=()=>{y.remove()};this.addCommands({cmd:N,undo:O,mustExec:!1})}getNextId(){return S(this,s).getId()}deserialize(y){switch(y.annotationType){case b.AnnotationEditorType.FREETEXT:return H.FreeTextEditor.deserialize(y,this);case b.AnnotationEditorType.INK:return st.InkEditor.deserialize(y,this)}return null}setSelected(y){S(this,s).setSelected(y)}toggleSelected(y){S(this,s).toggleSelected(y)}isSelected(y){return S(this,s).isSelected(y)}unselect(y){S(this,s).unselect(y)}pointerup(y){const N=L.KeyboardManager.platform.isMac;if(!(y.button!==0||y.ctrlKey&&N)&&y.target===this.div){if(!S(this,A)){ut(this,A,!0);return}lt(this,P,ge).call(this,y)}}pointerdown(y){const N=L.KeyboardManager.platform.isMac;if(y.button!==0||y.ctrlKey&&N||y.target!==this.div)return;const O=S(this,s).getActive();ut(this,A,!O||O.isEmpty())}drop(y){const N=y.dataTransfer.getData("text/plain"),O=S(this,s).getEditor(N);if(!O)return;y.preventDefault(),y.dataTransfer.dropEffect="move",lt(this,h,pe).call(this,O);const it=this.div.getBoundingClientRect(),ot=y.clientX-it.x,ht=y.clientY-it.y;O.translate(ot-O.startX,ht-O.startY),this.moveDivInDOM(O),O.div.focus()}dragover(y){y.preventDefault()}destroy(){var y;((y=S(this,s).getActive())==null?void 0:y.parent)===this&&S(this,s).setActiveEditor(null);for(const N of S(this,v).values())this.removePointerInTextLayer(N),N.isAttachedToDOM=!1,N.div.remove(),N.parent=null;S(this,t).clear(),this.div=null,S(this,v).clear(),S(this,i).clear(),S(this,s).removeLayer(this)}render(y){this.viewport=y.viewport,(0,L.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const N of S(this,s).getEditors(this.pageIndex))this.add(N);this.updateMode()}update(y){this.viewport=y.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[y,N,O,it]=this.viewport.viewBox,ot=O-y,ht=it-N;return[ot,ht]}get viewportBaseDimensions(){const{width:y,height:N,rotation:O}=this.viewport;return O%180===0?[y,N]:[N,y]}setDimensions(){const{width:y,height:N,rotation:O}=this.viewport,it=O%180!==0,ot=Math.floor(y)+"px",ht=Math.floor(N)+"px";this.div.style.width=it?ht:ot,this.div.style.height=it?ot:ht,this.div.setAttribute("data-main-rotation",O)}};let j=k;A=new WeakMap,w=new WeakMap,F=new WeakMap,v=new WeakMap,C=new WeakMap,c=new WeakMap,t=new WeakMap,s=new WeakMap,i=new WeakMap,E=new WeakSet,fe=function(){return!!this.div.parentNode.querySelector(".textLayer .endOfContent")},h=new WeakSet,pe=function(y){var N;y.parent!==this&&(this.attach(y),y.pageIndex=this.pageIndex,(N=y.parent)==null||N.detach(y),y.parent=this,y.div&&y.isAttachedToDOM&&(y.div.remove(),this.div.append(y.div)))},a=new WeakSet,ee=function(y,N){const O=y.getBoundingClientRect(),it=N.getBoundingClientRect();if(O.y+O.height<=it.y)return-1;if(it.y+it.height<=O.y)return 1;const ot=O.x+O.width/2,ht=it.x+it.width/2;return ot-ht},x=new WeakSet,Fe=function(y){switch(S(this,s).getMode()){case b.AnnotationEditorType.FREETEXT:return new H.FreeTextEditor(y);case b.AnnotationEditorType.INK:return new st.InkEditor(y)}return null},P=new WeakSet,ge=function(y){const N=this.getNextId(),O=lt(this,x,Fe).call(this,{parent:this,id:N,x:y.offsetX,y:y.offsetY});return O&&this.add(O),O},J=new WeakSet,Re=function(){ut(this,C,!0);for(const y of S(this,v).values())y.isEmpty()&&y.remove();ut(this,C,!1)},rt(j,a),Nt(j,"_initialized",!1),_.AnnotationEditorLayer=j},(at,_,Q)=>{var st,j,A,w,F,v,C,c,t,Me,i,De,p,Oe,n,me;Object.defineProperty(_,"__esModule",{value:!0}),_.FreeTextEditor=void 0;var b=Q(1),L=Q(9),Y=Q(8);const f=class extends Y.AnnotationEditor{constructor(P){super({...P,name:"freeTextEditor"});rt(this,t);rt(this,i);rt(this,p);rt(this,n);rt(this,st,this.editorDivBlur.bind(this));rt(this,j,this.editorDivFocus.bind(this));rt(this,A,this.editorDivKeydown.bind(this));rt(this,w,void 0);rt(this,F,"");rt(this,v,"");rt(this,C,!1);rt(this,c,void 0);ut(this,w,P.color||f._defaultColor||Y.AnnotationEditor._defaultLineColor),ut(this,c,P.fontSize||f._defaultFontSize)}static initialize(P){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(J=>[J,P.get(J)]));const D=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(D.getPropertyValue("--freetext-padding"))}static updateDefaultParams(P,D){switch(P){case b.AnnotationEditorParamsType.FREETEXT_SIZE:f._defaultFontSize=D;break;case b.AnnotationEditorParamsType.FREETEXT_COLOR:f._defaultColor=D;break}}updateParams(P,D){switch(P){case b.AnnotationEditorParamsType.FREETEXT_SIZE:lt(this,t,Me).call(this,D);break;case b.AnnotationEditorParamsType.FREETEXT_COLOR:lt(this,i,De).call(this,D);break}}static get defaultPropertiesToUpdate(){return[[b.AnnotationEditorParamsType.FREETEXT_SIZE,f._defaultFontSize],[b.AnnotationEditorParamsType.FREETEXT_COLOR,f._defaultColor||Y.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[b.AnnotationEditorParamsType.FREETEXT_SIZE,S(this,c)],[b.AnnotationEditorParamsType.FREETEXT_COLOR,S(this,w)]]}getInitialTranslation(){return[-f._internalPadding*this.parent.scaleFactor,-(f._internalPadding+S(this,c))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(b.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",S(this,A)),this.editorDiv.addEventListener("focus",S(this,j)),this.editorDiv.addEventListener("blur",S(this,st)))}disableEditMode(){!this.isInEditMode()||(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",S(this,A)),this.editorDiv.removeEventListener("focus",S(this,j)),this.editorDiv.removeEventListener("blur",S(this,st)),this.div.focus(),this.isEditing=!1)}focusin(P){super.focusin(P),P.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),S(this,C)||(ut(this,C,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),ut(this,v,this.editorDiv.innerHTML),ut(this,F,lt(this,p,Oe).call(this).trimEnd()),lt(this,n,me).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(P){this.enableEditMode(),this.editorDiv.focus()}keydown(P){P.target===this.div&&P.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(P){f._keyboardManager.exec(this,P)}editorDivFocus(P){this.isEditing=!0}editorDivBlur(P){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}getIdForTextLayer(){return this.editorDiv.id}render(){if(this.div)return this.div;let P,D;this.width&&(P=this.x,D=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),f._l10nPromise.get("editor_free_text_aria_label").then(V=>{var k;return(k=this.editorDiv)==null?void 0:k.setAttribute("aria-label",V)}),f._l10nPromise.get("free_text_default_content").then(V=>{var k;return(k=this.editorDiv)==null?void 0:k.setAttribute("default-content",V)}),this.editorDiv.contentEditable=!0;const{style:J}=this.editorDiv;if(J.fontSize=`calc(${S(this,c)}px * var(--scale-factor))`,J.color=S(this,w),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,L.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[V,k]=this.parent.viewportBaseDimensions;this.setAt(P*V,D*k,this.width*V,this.height*k),this.editorDiv.innerHTML=S(this,v),this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(P,D){const J=super.deserialize(P,D);return ut(J,c,P.fontSize),ut(J,w,b.Util.makeHexColor(...P.color)),ut(J,F,P.value),ut(J,v,P.value.split(`
`).map(V=>`<div>${V}</div>`).join("")),J}serialize(){if(this.isEmpty())return null;const P=f._internalPadding*this.parent.scaleFactor,D=this.getRect(P,P),J=Y.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:b.AnnotationEditorType.FREETEXT,color:J,fontSize:S(this,c),value:S(this,F),pageIndex:this.parent.pageIndex,rect:D,rotation:this.rotation}}};let H=f;st=new WeakMap,j=new WeakMap,A=new WeakMap,w=new WeakMap,F=new WeakMap,v=new WeakMap,C=new WeakMap,c=new WeakMap,t=new WeakSet,Me=function(P){const D=V=>{this.editorDiv.style.fontSize=`calc(${V}px * var(--scale-factor))`,this.translate(0,-(V-S(this,c))*this.parent.scaleFactor),ut(this,c,V),lt(this,n,me).call(this)},J=S(this,c);this.parent.addCommands({cmd:()=>{D(P)},undo:()=>{D(J)},mustExec:!0,type:b.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},i=new WeakSet,De=function(P){const D=S(this,w);this.parent.addCommands({cmd:()=>{ut(this,w,P),this.editorDiv.style.color=P},undo:()=>{ut(this,w,D),this.editorDiv.style.color=D},mustExec:!0,type:b.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},p=new WeakSet,Oe=function(){const P=this.editorDiv.getElementsByTagName("div");if(P.length===0)return this.editorDiv.innerText;const D=[];for(let J=0,V=P.length;J<V;J++){const q=P[J].firstChild;(q==null?void 0:q.nodeName)==="#text"?D.push(q.data):D.push("")}return D.join(`
`)},n=new WeakSet,me=function(){const[P,D]=this.parent.viewportBaseDimensions,J=this.div.getBoundingClientRect();this.width=J.width/P,this.height=J.height/D},Nt(H,"_freeTextDefaultContent",""),Nt(H,"_l10nPromise"),Nt(H,"_internalPadding",0),Nt(H,"_defaultColor",null),Nt(H,"_defaultFontSize",10),Nt(H,"_keyboardManager",new L.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],f.prototype.commitOrRemove]])),_.FreeTextEditor=H},(at,_,Q)=>{var A,w,F,v,C,c,t,s,i,E,p,h,n,a,f,Ie,T,Le,D,Ne,V,je,q,_e,N,Ue,it,Be,ht,We,_t,Gt,d,be,m,se,r,ne,u,Kt,M,Ae,z,ie,K,ye,Z,qe,pt,He,nt,ze,X,ve,vt,re,St,Jt,Rt,Se;Object.defineProperty(_,"__esModule",{value:!0}),_.InkEditor=void 0,Object.defineProperty(_,"fitCurve",{enumerable:!0,get:function(){return Y.fitCurve}});var b=Q(1),L=Q(8),Y=Q(25),H=Q(9);const st=16,wt=class extends L.AnnotationEditor{constructor(tt){super({...tt,name:"inkEditor"});rt(this,f);rt(this,T);rt(this,D);rt(this,V);rt(this,q);rt(this,N);rt(this,it);rt(this,ht);rt(this,_t);rt(this,d);rt(this,m);rt(this,r);rt(this,u);rt(this,M);rt(this,z);rt(this,Z);rt(this,pt);rt(this,nt);rt(this,X);rt(this,vt);rt(this,St);rt(this,Rt);rt(this,A,0);rt(this,w,0);rt(this,F,0);rt(this,v,this.canvasPointermove.bind(this));rt(this,C,this.canvasPointerleave.bind(this));rt(this,c,this.canvasPointerup.bind(this));rt(this,t,this.canvasPointerdown.bind(this));rt(this,s,!1);rt(this,i,!1);rt(this,E,null);rt(this,p,null);rt(this,h,0);rt(this,n,0);rt(this,a,null);this.color=tt.color||null,this.thickness=tt.thickness||null,this.opacity=tt.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(tt){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(ct=>[ct,tt.get(ct)]))}static updateDefaultParams(tt,ct){switch(tt){case b.AnnotationEditorParamsType.INK_THICKNESS:wt._defaultThickness=ct;break;case b.AnnotationEditorParamsType.INK_COLOR:wt._defaultColor=ct;break;case b.AnnotationEditorParamsType.INK_OPACITY:wt._defaultOpacity=ct/100;break}}updateParams(tt,ct){switch(tt){case b.AnnotationEditorParamsType.INK_THICKNESS:lt(this,f,Ie).call(this,ct);break;case b.AnnotationEditorParamsType.INK_COLOR:lt(this,T,Le).call(this,ct);break;case b.AnnotationEditorParamsType.INK_OPACITY:lt(this,D,Ne).call(this,ct);break}}static get defaultPropertiesToUpdate(){return[[b.AnnotationEditorParamsType.INK_THICKNESS,wt._defaultThickness],[b.AnnotationEditorParamsType.INK_COLOR,wt._defaultColor||L.AnnotationEditor._defaultLineColor],[b.AnnotationEditorParamsType.INK_OPACITY,Math.round(wt._defaultOpacity*100)]]}get propertiesToUpdate(){var tt;return[[b.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||wt._defaultThickness],[b.AnnotationEditorParamsType.INK_COLOR,this.color||wt._defaultColor||L.AnnotationEditor._defaultLineColor],[b.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((tt=this.opacity)!=null?tt:wt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(lt(this,m,se).call(this),lt(this,r,ne).call(this)),this.isAttachedToDOM||(this.parent.add(this),lt(this,u,Kt).call(this)),lt(this,St,Jt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,S(this,p).disconnect(),ut(this,p,null),super.remove())}enableEditMode(){S(this,s)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",S(this,t)),this.canvas.addEventListener("pointerup",S(this,c)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",S(this,t)),this.canvas.removeEventListener("pointerup",S(this,c)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){S(this,s)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ut(this,s,!0),this.div.classList.add("disabled"),lt(this,St,Jt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveDivInDOM(this),this.div.focus())}focusin(tt){super.focusin(tt),this.enableEditMode()}canvasPointerdown(tt){tt.button!==0||!this.isInEditMode()||S(this,s)||(this.setInForeground(),tt.type!=="mouse"&&this.div.focus(),tt.stopPropagation(),this.canvas.addEventListener("pointerleave",S(this,C)),this.canvas.addEventListener("pointermove",S(this,v)),lt(this,N,Ue).call(this,tt.offsetX,tt.offsetY))}canvasPointermove(tt){tt.stopPropagation(),lt(this,it,Be).call(this,tt.offsetX,tt.offsetY)}canvasPointerup(tt){tt.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(tt.stopPropagation(),lt(this,d,be).call(this,tt),this.setInBackground())}canvasPointerleave(tt){lt(this,d,be).call(this,tt),this.setInBackground()}render(){if(this.div)return this.div;let tt,ct;this.width&&(tt=this.x,ct=this.y),super.render(),wt._l10nPromise.get("editor_ink_aria_label").then(gt=>{var bt;return(bt=this.div)==null?void 0:bt.setAttribute("aria-label",gt)});const[$,U,W,dt]=lt(this,V,je).call(this);if(this.setAt($,U,0,0),this.setDims(W,dt),lt(this,m,se).call(this),this.width){const[gt,bt]=this.parent.viewportBaseDimensions;this.setAt(tt*gt,ct*bt,this.width*gt,this.height*bt),ut(this,i,!0),lt(this,u,Kt).call(this),this.setDims(this.width*gt,this.height*bt),lt(this,_t,Gt).call(this),lt(this,Rt,Se).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return lt(this,r,ne).call(this),this.div}setDimensions(tt,ct){const $=Math.round(tt),U=Math.round(ct);if(S(this,h)===$&&S(this,n)===U)return;ut(this,h,$),ut(this,n,U),this.canvas.style.visibility="hidden",S(this,A)&&Math.abs(S(this,A)-tt/ct)>.01&&(ct=Math.ceil(tt/S(this,A)),this.setDims(tt,ct));const[W,dt]=this.parent.viewportBaseDimensions;this.width=tt/W,this.height=ct/dt,S(this,s)&&lt(this,M,Ae).call(this,tt,ct),lt(this,u,Kt).call(this),lt(this,_t,Gt).call(this),this.canvas.style.visibility="visible"}static deserialize(tt,ct){var Mt,Ft;const $=super.deserialize(tt,ct);$.thickness=tt.thickness,$.color=b.Util.makeHexColor(...tt.color),$.opacity=tt.opacity;const[U,W]=ct.pageDimensions,dt=$.width*U,gt=$.height*W,bt=ct.scaleFactor,Et=tt.thickness/2;ut($,A,dt/gt),ut($,s,!0),ut($,h,Math.round(dt)),ut($,n,Math.round(gt));for(const{bezier:Ct}of tt.paths){const It=[];$.paths.push(It);let Dt=bt*(Ct[0]-Et),Bt=bt*(gt-Ct[1]-Et);for(let Lt=2,qt=Ct.length;Lt<qt;Lt+=6){const Xt=bt*(Ct[Lt]-Et),Vt=bt*(gt-Ct[Lt+1]-Et),zt=bt*(Ct[Lt+2]-Et),Ut=bt*(gt-Ct[Lt+3]-Et),Ht=bt*(Ct[Lt+4]-Et),Yt=bt*(gt-Ct[Lt+5]-Et);It.push([[Dt,Bt],[Xt,Vt],[zt,Ut],[Ht,Yt]]),Dt=Ht,Bt=Yt}const Pt=lt(this,K,ye).call(this,It);$.bezierPath2D.push(Pt)}const Tt=lt(Mt=$,X,ve).call(Mt);return ut($,F,Tt[2]-Tt[0]),ut($,w,Tt[3]-Tt[1]),lt(Ft=$,M,Ae).call(Ft,dt,gt),$}serialize(){if(this.isEmpty())return null;const tt=this.getRect(0,0),ct=this.rotation%180===0?tt[3]-tt[1]:tt[2]-tt[0],$=L.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:b.AnnotationEditorType.INK,color:$,thickness:this.thickness,opacity:this.opacity,paths:lt(this,Z,qe).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,ct),pageIndex:this.parent.pageIndex,rect:tt,rotation:this.rotation}}};let j=wt;A=new WeakMap,w=new WeakMap,F=new WeakMap,v=new WeakMap,C=new WeakMap,c=new WeakMap,t=new WeakMap,s=new WeakMap,i=new WeakMap,E=new WeakMap,p=new WeakMap,h=new WeakMap,n=new WeakMap,a=new WeakMap,f=new WeakSet,Ie=function(tt){const ct=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=tt,lt(this,St,Jt).call(this)},undo:()=>{this.thickness=ct,lt(this,St,Jt).call(this)},mustExec:!0,type:b.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},T=new WeakSet,Le=function(tt){const ct=this.color;this.parent.addCommands({cmd:()=>{this.color=tt,lt(this,_t,Gt).call(this)},undo:()=>{this.color=ct,lt(this,_t,Gt).call(this)},mustExec:!0,type:b.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},D=new WeakSet,Ne=function(tt){tt/=100;const ct=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=tt,lt(this,_t,Gt).call(this)},undo:()=>{this.opacity=ct,lt(this,_t,Gt).call(this)},mustExec:!0,type:b.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},V=new WeakSet,je=function(){const{width:tt,height:ct,rotation:$}=this.parent.viewport;switch($){case 90:return[0,tt,tt,ct];case 180:return[tt,ct,tt,ct];case 270:return[ct,0,tt,ct];default:return[0,0,tt,ct]}},q=new WeakSet,_e=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,H.opacityToHex)(this.opacity)}`},N=new WeakSet,Ue=function(tt,ct){var $;this.isEditing=!0,S(this,i)||(ut(this,i,!0),lt(this,u,Kt).call(this),this.thickness||(this.thickness=wt._defaultThickness),this.color||(this.color=wt._defaultColor||L.AnnotationEditor._defaultLineColor),($=this.opacity)!=null||(this.opacity=wt._defaultOpacity)),this.currentPath.push([tt,ct]),ut(this,E,null),lt(this,q,_e).call(this),this.ctx.beginPath(),this.ctx.moveTo(tt,ct),ut(this,a,()=>{!S(this,a)||(S(this,E)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):lt(this,_t,Gt).call(this),this.ctx.lineTo(...S(this,E)),ut(this,E,null),this.ctx.stroke()),window.requestAnimationFrame(S(this,a)))}),window.requestAnimationFrame(S(this,a))},it=new WeakSet,Be=function(tt,ct){const[$,U]=this.currentPath.at(-1);tt===$&&ct===U||(this.currentPath.push([tt,ct]),ut(this,E,[tt,ct]))},ht=new WeakSet,We=function(tt,ct){var Et;this.ctx.closePath(),ut(this,a,null),tt=Math.min(Math.max(tt,0),this.canvas.width),ct=Math.min(Math.max(ct,0),this.canvas.height);const[$,U]=this.currentPath.at(-1);(tt!==$||ct!==U)&&this.currentPath.push([tt,ct]);let W;if(this.currentPath.length!==1)W=(0,Y.fitCurve)(this.currentPath,30,null);else{const Tt=[tt,ct];W=[[Tt,Tt.slice(),Tt.slice(),Tt]]}const dt=lt(Et=wt,K,ye).call(Et,W);this.currentPath.length=0;const gt=()=>{this.paths.push(W),this.bezierPath2D.push(dt),this.rebuild()},bt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(lt(this,m,se).call(this),lt(this,r,ne).call(this)),lt(this,St,Jt).call(this))};this.parent.addCommands({cmd:gt,undo:bt,mustExec:!0})},_t=new WeakSet,Gt=function(){if(this.isEmpty()){lt(this,z,ie).call(this);return}lt(this,q,_e).call(this);const{canvas:tt,ctx:ct}=this;ct.setTransform(1,0,0,1,0,0),ct.clearRect(0,0,tt.width,tt.height),lt(this,z,ie).call(this);for(const $ of this.bezierPath2D)ct.stroke($)},d=new WeakSet,be=function(tt){lt(this,ht,We).call(this,tt.offsetX,tt.offsetY),this.canvas.removeEventListener("pointerleave",S(this,C)),this.canvas.removeEventListener("pointermove",S(this,v)),this.parent.addToAnnotationStorage(this)},m=new WeakSet,se=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",wt._l10nPromise.get("editor_ink_canvas_aria_label").then(tt=>{var ct;return(ct=this.canvas)==null?void 0:ct.setAttribute("aria-label",tt)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},r=new WeakSet,ne=function(){ut(this,p,new ResizeObserver(tt=>{const ct=tt[0].contentRect;ct.width&&ct.height&&this.setDimensions(ct.width,ct.height)})),S(this,p).observe(this.div)},u=new WeakSet,Kt=function(){if(!S(this,i))return;const[tt,ct]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*tt),this.canvas.height=Math.ceil(this.height*ct),lt(this,z,ie).call(this)},M=new WeakSet,Ae=function(tt,ct){const $=lt(this,vt,re).call(this),U=(tt-$)/S(this,F),W=(ct-$)/S(this,w);this.scaleFactor=Math.min(U,W)},z=new WeakSet,ie=function(){const tt=lt(this,vt,re).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+tt,this.translationY*this.scaleFactor+tt)},K=new WeakSet,ye=function(tt){const ct=new Path2D;for(let $=0,U=tt.length;$<U;$++){const[W,dt,gt,bt]=tt[$];$===0&&ct.moveTo(...W),ct.bezierCurveTo(dt[0],dt[1],gt[0],gt[1],bt[0],bt[1])}return ct},Z=new WeakSet,qe=function(tt,ct,$,U){const dt=[],gt=this.thickness/2;let bt,Et;for(const Tt of this.paths){bt=[],Et=[];for(let Mt=0,Ft=Tt.length;Mt<Ft;Mt++){const[Ct,It,Dt,Bt]=Tt[Mt],Pt=tt*(Ct[0]+ct)+gt,Lt=U-tt*(Ct[1]+$)-gt,qt=tt*(It[0]+ct)+gt,Xt=U-tt*(It[1]+$)-gt,Vt=tt*(Dt[0]+ct)+gt,zt=U-tt*(Dt[1]+$)-gt,Ut=tt*(Bt[0]+ct)+gt,Ht=U-tt*(Bt[1]+$)-gt;Mt===0&&(bt.push(Pt,Lt),Et.push(Pt,Lt)),bt.push(qt,Xt,Vt,zt,Ut,Ht),lt(this,pt,He).call(this,Pt,Lt,qt,Xt,Vt,zt,Ut,Ht,4,Et)}dt.push({bezier:bt,points:Et})}return dt},pt=new WeakSet,He=function(tt,ct,$,U,W,dt,gt,bt,Et,Tt){if(lt(this,nt,ze).call(this,tt,ct,$,U,W,dt,gt,bt)){Tt.push(gt,bt);return}for(let Mt=1;Mt<Et-1;Mt++){const Ft=Mt/Et,Ct=1-Ft;let It=Ft*tt+Ct*$,Dt=Ft*ct+Ct*U,Bt=Ft*$+Ct*W,Pt=Ft*U+Ct*dt;const Lt=Ft*W+Ct*gt,qt=Ft*dt+Ct*bt;It=Ft*It+Ct*Bt,Dt=Ft*Dt+Ct*Pt,Bt=Ft*Bt+Ct*Lt,Pt=Ft*Pt+Ct*qt,It=Ft*It+Ct*Bt,Dt=Ft*Dt+Ct*Pt,Tt.push(It,Dt)}Tt.push(gt,bt)},nt=new WeakSet,ze=function(tt,ct,$,U,W,dt,gt,bt){const Tt=(3*$-2*tt-gt)**2,Mt=(3*U-2*ct-bt)**2,Ft=(3*W-tt-2*gt)**2,Ct=(3*dt-ct-2*bt)**2;return Math.max(Tt,Ft)+Math.max(Mt,Ct)<=10},X=new WeakSet,ve=function(){let tt=1/0,ct=-1/0,$=1/0,U=-1/0;for(const W of this.paths)for(const[dt,gt,bt,Et]of W){const Tt=b.Util.bezierBoundingBox(...dt,...gt,...bt,...Et);tt=Math.min(tt,Tt[0]),$=Math.min($,Tt[1]),ct=Math.max(ct,Tt[2]),U=Math.max(U,Tt[3])}return[tt,$,ct,U]},vt=new WeakSet,re=function(){return S(this,s)?Math.ceil(this.thickness*this.parent.scaleFactor):0},St=new WeakSet,Jt=function(tt=!1){if(this.isEmpty())return;if(!S(this,s)){lt(this,_t,Gt).call(this);return}const ct=lt(this,X,ve).call(this),$=lt(this,vt,re).call(this);ut(this,F,Math.max(st,ct[2]-ct[0])),ut(this,w,Math.max(st,ct[3]-ct[1]));const U=Math.ceil($+S(this,F)*this.scaleFactor),W=Math.ceil($+S(this,w)*this.scaleFactor),[dt,gt]=this.parent.viewportBaseDimensions;this.width=U/dt,this.height=W/gt,ut(this,A,U/W),lt(this,Rt,Se).call(this);const bt=this.translationX,Et=this.translationY;this.translationX=-ct[0],this.translationY=-ct[1],lt(this,u,Kt).call(this),lt(this,_t,Gt).call(this),ut(this,h,U),ut(this,n,W),this.setDims(U,W);const Tt=tt?$/this.scaleFactor/2:0;this.translate(bt-this.translationX-Tt,Et-this.translationY-Tt)},Rt=new WeakSet,Se=function(){const{style:tt}=this.div;S(this,A)>=1?(tt.minHeight=`${st}px`,tt.minWidth=`${Math.round(S(this,A)*st)}px`):(tt.minWidth=`${st}px`,tt.minHeight=`${Math.round(st/S(this,A))}px`)},rt(j,K),Nt(j,"_defaultColor",null),Nt(j,"_defaultOpacity",1),Nt(j,"_defaultThickness",1),Nt(j,"_l10nPromise"),_.InkEditor=j},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.fitCurve=void 0;const b=Q(26);_.fitCurve=b},at=>{function _(c,t,s){if(!Array.isArray(c))throw new TypeError("First argument should be an array");if(c.forEach(h=>{if(!Array.isArray(h)||h.some(n=>typeof n!="number")||h.length!==c[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),c=c.filter((h,n)=>n===0||!h.every((a,f)=>a===c[n-1][f])),c.length<2)return[];const i=c.length,E=F(c[1],c[0]),p=F(c[i-2],c[i-1]);return Q(c,E,p,t,s)}function Q(c,t,s,i,E){var h,n,a,f,x,T,P,D,J,V,k,q,y;if(c.length===2)return q=v.vectorLen(v.subtract(c[0],c[1]))/3,h=[c[0],v.addArrays(c[0],v.mulItems(t,q)),v.addArrays(c[1],v.mulItems(s,q)),c[1]],[h];if(n=st(c),[h,f,T]=b(c,n,n,t,s,E),f===0||f<i)return[h];if(f<i*i)for(a=n,x=f,P=T,y=0;y<20;y++){if(a=Y(h,c,a),[h,f,T]=b(c,n,a,t,s,E),f<i)return[h];if(T===P){let N=f/x;if(N>.9999&&N<1.0001)break}x=f,P=T}return k=[],D=v.subtract(c[T-1],c[T+1]),D.every(N=>N===0)&&(D=v.subtract(c[T-1],c[T]),[D[0],D[1]]=[-D[1],D[0]]),J=v.normalize(D),V=v.mulItems(J,-1),k=k.concat(Q(c.slice(0,T+1),t,J,i,E)),k=k.concat(Q(c.slice(T),V,s,i,E)),k}function b(c,t,s,i,E,p){var h,n,a;return h=L(c,s,i,E),[n,a]=j(c,h,t),p&&p({bez:h,points:c,params:t,maxErr:n,maxPoint:a}),[h,n,a]}function L(c,t,s,i){var E,p,h,n,a,f,x,T,P,D,J,V,k,q,y,N,O,it=c[0],ot=c[c.length-1];for(E=[it,null,null,ot],p=v.zeros_Xx2x2(t.length),k=0,q=t.length;k<q;k++)N=t[k],O=1-N,h=p[k],h[0]=v.mulItems(s,3*N*(O*O)),h[1]=v.mulItems(i,3*O*(N*N));for(n=[[0,0],[0,0]],a=[0,0],k=0,q=c.length;k<q;k++)N=t[k],h=p[k],n[0][0]+=v.dot(h[0],h[0]),n[0][1]+=v.dot(h[0],h[1]),n[1][0]+=v.dot(h[0],h[1]),n[1][1]+=v.dot(h[1],h[1]),y=v.subtract(c[k],C.q([it,it,ot,ot],N)),a[0]+=v.dot(h[0],y),a[1]+=v.dot(h[1],y);return f=n[0][0]*n[1][1]-n[1][0]*n[0][1],x=n[0][0]*a[1]-n[1][0]*a[0],T=a[0]*n[1][1]-a[1]*n[0][1],P=f===0?0:T/f,D=f===0?0:x/f,V=v.vectorLen(v.subtract(it,ot)),J=1e-6*V,P<J||D<J?(E[1]=v.addArrays(it,v.mulItems(s,V/3)),E[2]=v.addArrays(ot,v.mulItems(i,V/3))):(E[1]=v.addArrays(it,v.mulItems(s,P)),E[2]=v.addArrays(ot,v.mulItems(i,D))),E}function Y(c,t,s){return s.map((i,E)=>H(c,t[E],i))}function H(c,t,s){var i=v.subtract(C.q(c,s),t),E=C.qprime(c,s),p=v.mulMatrix(i,E),h=v.sum(v.squareItems(E))+2*v.mulMatrix(i,C.qprimeprime(c,s));return h===0?s:s-p/h}function st(c){var t=[],s,i,E;return c.forEach((p,h)=>{s=h?i+v.vectorLen(v.subtract(p,E)):0,t.push(s),i=s,E=p}),t=t.map(p=>p/i),t}function j(c,t,s){var i,E,p,h,n,a,f,x;E=0,p=Math.floor(c.length/2);const T=A(t,10);for(n=0,a=c.length;n<a;n++)f=c[n],x=w(t,s[n],T,10),h=v.subtract(C.q(t,x),f),i=h[0]*h[0]+h[1]*h[1],i>E&&(E=i,p=n);return[E,p]}var A=function(c,t){for(var s,i=[0],E=c[0],p=0,h=1;h<=t;h++)s=C.q(c,h/t),p+=v.vectorLen(v.subtract(s,E)),i.push(p),E=s;return i=i.map(n=>n/p),i};function w(c,t,s,i){if(t<0)return 0;if(t>1)return 1;for(var E,p,h,n,a,f=1;f<=i;f++)if(t<=s[f]){n=(f-1)/i,h=f/i,p=s[f-1],E=s[f],a=(t-p)/(E-p)*(h-n)+n;break}return a}function F(c,t){return v.normalize(v.subtract(c,t))}class v{static zeros_Xx2x2(t){for(var s=[];t--;)s.push([0,0]);return s}static mulItems(t,s){return t.map(i=>i*s)}static mulMatrix(t,s){return t.reduce((i,E,p)=>i+E*s[p],0)}static subtract(t,s){return t.map((i,E)=>i-s[E])}static addArrays(t,s){return t.map((i,E)=>i+s[E])}static addItems(t,s){return t.map(i=>i+s)}static sum(t){return t.reduce((s,i)=>s+i)}static dot(t,s){return v.mulMatrix(t,s)}static vectorLen(t){return Math.hypot(...t)}static divItems(t,s){return t.map(i=>i/s)}static squareItems(t){return t.map(s=>s*s)}static normalize(t){return this.divItems(t,this.vectorLen(t))}}class C{static q(t,s){var i=1-s,E=v.mulItems(t[0],i*i*i),p=v.mulItems(t[1],3*i*i*s),h=v.mulItems(t[2],3*i*s*s),n=v.mulItems(t[3],s*s*s);return v.addArrays(v.addArrays(E,p),v.addArrays(h,n))}static qprime(t,s){var i=1-s,E=v.mulItems(v.subtract(t[1],t[0]),3*i*i),p=v.mulItems(v.subtract(t[2],t[1]),6*i*s),h=v.mulItems(v.subtract(t[3],t[2]),3*s*s);return v.addArrays(v.addArrays(E,p),h)}static qprimeprime(t,s){return v.addArrays(v.mulItems(v.addArrays(v.subtract(t[2],v.mulItems(t[1],2)),t[0]),6*(1-s)),v.mulItems(v.addArrays(v.subtract(t[3],v.mulItems(t[2],2)),t[1]),6*s))}}at.exports=_,at.exports.fitCubic=Q,at.exports.createTangent=F},(at,_,Q)=>{var _t,Ee,d,Ce;Object.defineProperty(_,"__esModule",{value:!0}),_.AnnotationLayer=void 0;var b=Q(1),L=Q(4),Y=Q(7),H=Q(28),st=Q(29);const j=1e3,A=9,w=new WeakSet;function F(m){return{width:m[2]-m[0],height:m[3]-m[1]}}class v{static create(e){switch(e.data.annotationType){case b.AnnotationType.LINK:return new c(e);case b.AnnotationType.TEXT:return new t(e);case b.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new i(e);case"Btn":return e.data.radioButton?new p(e):e.data.checkBox?new E(e):new h(e);case"Ch":return new n(e)}return new s(e);case b.AnnotationType.POPUP:return new a(e);case b.AnnotationType.FREETEXT:return new x(e);case b.AnnotationType.LINE:return new T(e);case b.AnnotationType.SQUARE:return new P(e);case b.AnnotationType.CIRCLE:return new D(e);case b.AnnotationType.POLYLINE:return new J(e);case b.AnnotationType.CARET:return new k(e);case b.AnnotationType.INK:return new q(e);case b.AnnotationType.POLYGON:return new V(e);case b.AnnotationType.HIGHLIGHT:return new y(e);case b.AnnotationType.UNDERLINE:return new N(e);case b.AnnotationType.SQUIGGLY:return new O(e);case b.AnnotationType.STRIKEOUT:return new it(e);case b.AnnotationType.STAMP:return new ot(e);case b.AnnotationType.FILEATTACHMENT:return new ht(e);default:return new C(e)}}}class C{constructor(e,{isRenderable:r=!1,ignoreBorder:l=!1,createQuadrilaterals:u=!1}={}){this.isRenderable=r,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this._mouseState=e.mouseState,r&&(this.container=this._createContainer(l)),u&&(this.quadrilaterals=this._createQuadrilaterals(l))}_createContainer(e=!1){const r=this.data,l=this.page,u=this.viewport,g=document.createElement("section"),{width:M,height:I}=F(r.rect),[z,B,K,G]=u.viewBox,Z=K-z,ft=G-B;g.setAttribute("data-annotation-id",r.id);const pt=b.Util.normalizeRect([r.rect[0],l.view[3]-r.rect[1]+l.view[1],r.rect[2],l.view[3]-r.rect[3]+l.view[1]]);if(!e&&r.borderStyle.width>0){g.style.borderWidth=`${r.borderStyle.width}px`;const nt=r.borderStyle.horizontalCornerRadius,yt=r.borderStyle.verticalCornerRadius;if(nt>0||yt>0){const et=`calc(${nt}px * var(--scale-factor)) / calc(${yt}px * var(--scale-factor))`;g.style.borderRadius=et}switch(r.borderStyle.style){case b.AnnotationBorderStyleType.SOLID:g.style.borderStyle="solid";break;case b.AnnotationBorderStyleType.DASHED:g.style.borderStyle="dashed";break;case b.AnnotationBorderStyleType.BEVELED:(0,b.warn)("Unimplemented border style: beveled");break;case b.AnnotationBorderStyleType.INSET:(0,b.warn)("Unimplemented border style: inset");break;case b.AnnotationBorderStyleType.UNDERLINE:g.style.borderBottomStyle="solid";break}const X=r.borderColor||null;X?g.style.borderColor=b.Util.makeHexColor(X[0]|0,X[1]|0,X[2]|0):g.style.borderWidth=0}g.style.left=`${100*(pt[0]-z)/Z}%`,g.style.top=`${100*(pt[1]-B)/ft}%`;const{rotation:At}=r;return r.hasOwnCanvas||At===0?(g.style.width=`${100*M/Z}%`,g.style.height=`${100*I/ft}%`):this.setRotation(At,g),g}setRotation(e,r=this.container){const[l,u,g,M]=this.viewport.viewBox,I=g-l,z=M-u,{width:B,height:K}=F(this.data.rect);let G,Z;e%180===0?(G=100*B/I,Z=100*K/z):(G=100*K/I,Z=100*B/z),r.style.width=`${G}%`,r.style.height=`${Z}%`,r.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(r,l,u)=>{const g=u.detail[r];u.target.style[l]=H.ColorConverters[`${g[0]}_HTML`](g.slice(1))};return(0,b.shadow)(this,"_commonActions",{display:r=>{const l=r.detail.display%2===1;this.container.style.visibility=l?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:l,print:r.detail.display===0||r.detail.display===3})},print:r=>{this.annotationStorage.setValue(this.data.id,{print:r.detail.print})},hidden:r=>{this.container.style.visibility=r.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:r.detail.hidden})},focus:r=>{setTimeout(()=>r.target.focus({preventScroll:!1}),0)},userName:r=>{r.target.title=r.detail.userName},readonly:r=>{r.detail.readonly?r.target.setAttribute("readonly",""):r.target.removeAttribute("readonly")},required:r=>{this._setRequired(r.target,r.detail.required)},bgColor:r=>{e("bgColor","backgroundColor",r)},fillColor:r=>{e("fillColor","backgroundColor",r)},fgColor:r=>{e("fgColor","color",r)},textColor:r=>{e("textColor","color",r)},borderColor:r=>{e("borderColor","borderColor",r)},strokeColor:r=>{e("strokeColor","borderColor",r)},rotation:r=>{const l=r.detail.rotation;this.setRotation(l),this.annotationStorage.setValue(this.data.id,{rotation:l})}})}_dispatchEventFromSandbox(e,r){const l=this._commonActions;for(const u of Object.keys(r.detail)){const g=e[u]||l[u];g&&g(r)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const r=this.annotationStorage.getRawValue(this.data.id);if(!r)return;const l=this._commonActions;for(const[u,g]of Object.entries(r)){const M=l[u];M&&(M({detail:g,target:e}),delete r[u])}}_createQuadrilaterals(e=!1){if(!this.data.quadPoints)return null;const r=[],l=this.data.rect;for(const u of this.data.quadPoints)this.data.rect=[u[2].x,u[2].y,u[1].x,u[1].y],r.push(this._createContainer(e));return this.data.rect=l,r}_createPopup(e,r){let l=this.container;this.quadrilaterals&&(e=e||this.quadrilaterals,l=this.quadrilaterals[0]),e||(e=document.createElement("div"),e.className="popupTriggerArea",l.append(e));const g=new f({container:l,trigger:e,color:r.color,titleObj:r.titleObj,modificationDate:r.modificationDate,contentsObj:r.contentsObj,richText:r.richText,hideWrapper:!0}).render();g.style.left="100%",l.append(g)}_renderQuadrilaterals(e){for(const r of this.quadrilaterals)r.className=e;return this.quadrilaterals}render(){(0,b.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,r=null){const l=[];if(this._fieldObjects){const u=this._fieldObjects[e];if(u)for(const{page:g,id:M,exportValues:I}of u){if(g===-1||M===r)continue;const z=typeof I=="string"?I:null,B=document.querySelector(`[data-element-id="${M}"]`);if(B&&!w.has(B)){(0,b.warn)(`_getElementsByName - element not allowed: ${M}`);continue}l.push({id:M,exportValue:z,domElement:B})}return l}for(const u of document.getElementsByName(e)){const{id:g,exportValue:M}=u;g!==r&&(!w.has(u)||l.push({id:g,exportValue:M,domElement:u}))}return l}static get platform(){const e=typeof navigator<"u"?navigator.platform:"";return(0,b.shadow)(this,"platform",{isWin:e.includes("Win"),isMac:e.includes("Mac")})}}class c extends C{constructor(e,r=null){super(e,{isRenderable:!0,ignoreBorder:!!(r!=null&&r.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:r}=this,l=document.createElement("a");l.setAttribute("data-element-id",e.id);let u=!1;return e.url?(r.addLinkAttributes(l,e.url,e.newWindow),u=!0):e.action?(this._bindNamedAction(l,e.action),u=!0):e.dest?(this._bindLink(l,e.dest),u=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(l,e),u=!0),e.resetForm?(this._bindResetFormAction(l,e.resetForm),u=!0):this.isTooltipOnly&&!u&&(this._bindLink(l,""),u=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((g,M)=>{const I=M===0?l:l.cloneNode();return g.append(I),g}):(this.container.className="linkAnnotation",u&&this.container.append(l),this.container)}_bindLink(e,r){e.href=this.linkService.getDestinationHash(r),e.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&(e.className="internalLink")}_bindNamedAction(e,r){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(r),!1),e.className="internalLink"}_bindJSAction(e,r){e.href=this.linkService.getAnchorUrl("");const l=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const u of Object.keys(r.actions)){const g=l.get(u);!g||(e[g]=()=>{var M;return(M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:u}}),!1})}e.onclick||(e.onclick=()=>!1),e.className="internalLink"}_bindResetFormAction(e,r){const l=e.onclick;if(l||(e.href=this.linkService.getAnchorUrl("")),e.className="internalLink",!this._fieldObjects){(0,b.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),l||(e.onclick=()=>!1);return}e.onclick=()=>{var K;l&&l();const{fields:u,refs:g,include:M}=r,I=[];if(u.length!==0||g.length!==0){const G=new Set(g);for(const Z of u){const ft=this._fieldObjects[Z]||[];for(const{id:pt}of ft)G.add(pt)}for(const Z of Object.values(this._fieldObjects))for(const ft of Z)G.has(ft.id)===M&&I.push(ft)}else for(const G of Object.values(this._fieldObjects))I.push(...G);const z=this.annotationStorage,B=[];for(const G of I){const{id:Z}=G;switch(B.push(Z),G.type){case"text":{const pt=G.defaultValue||"";z.setValue(Z,{value:pt});break}case"checkbox":case"radiobutton":{const pt=G.defaultValue===G.exportValues;z.setValue(Z,{value:pt});break}case"combobox":case"listbox":{const pt=G.defaultValue||"";z.setValue(Z,{value:pt});break}default:continue}const ft=document.querySelector(`[data-element-id="${Z}"]`);if(ft){if(!w.has(ft)){(0,b.warn)(`_bindResetFormAction - element not allowed: ${Z}`);continue}}else continue;ft.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((K=this.linkService.eventBus)==null||K.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:B,name:"ResetForm"}})),!1}}}class t extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r})}render(){this.container.className="textAnnotation";const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(e,this.data),this.container.append(e),this.container}}class s extends C{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(e){const{isWin:r,isMac:l}=C.platform;return r&&e.ctrlKey||l&&e.metaKey}_setEventListener(e,r,l,u){r.includes("mouse")?e.addEventListener(r,g=>{var M;(M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:l,value:u(g),shift:g.shiftKey,modifier:this._getKeyModifier(g)}})}):e.addEventListener(r,g=>{var M;(M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:l,value:u(g)}})})}_setEventListeners(e,r,l){var u;for(const[g,M]of r)(M==="Action"||((u=this.data.actions)==null?void 0:u[M]))&&this._setEventListener(e,g,M,l)}_setBackgroundColor(e){const r=this.data.backgroundColor||null;e.style.backgroundColor=r===null?"transparent":b.Util.makeHexColor(r[0],r[1],r[2])}_setTextStyle(e){const r=["left","center","right"],{fontColor:l}=this.data.defaultAppearanceData,u=this.data.defaultAppearanceData.fontSize||A,g=e.style;let M;if(this.data.multiLine){const I=Math.abs(this.data.rect[3]-this.data.rect[1]),z=Math.round(I/(b.LINE_FACTOR*u))||1,B=I/z;M=Math.min(u,Math.round(B/b.LINE_FACTOR))}else{const I=Math.abs(this.data.rect[3]-this.data.rect[1]);M=Math.min(u,Math.round(I/b.LINE_FACTOR))}g.fontSize=`calc(${M}px * var(--scale-factor))`,g.color=b.Util.makeHexColor(l[0],l[1],l[2]),this.data.textAlignment!==null&&(g.textAlign=r[this.data.textAlignment])}_setRequired(e,r){r?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",r)}}class i extends s{constructor(e){const r=e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:r})}setPropertyOnSiblings(e,r,l,u){const g=this.annotationStorage;for(const M of this._getElementsByName(e.name,e.id))M.domElement&&(M.domElement[r]=l),g.setValue(M.id,{[u]:l})}render(){var u;const e=this.annotationStorage,r=this.data.id;this.container.className="textWidgetAnnotation";let l=null;if(this.renderForms){const g=e.getValue(r,{value:this.data.fieldValue}),M=g.formattedValue||g.value||"",I={userValue:M,formattedValue:null,valueOnFocus:""};this.data.multiLine?(l=document.createElement("textarea"),l.textContent=M,this.data.doNotScroll&&(l.style.overflowY="hidden")):(l=document.createElement("input"),l.type="text",l.setAttribute("value",M),this.data.doNotScroll&&(l.style.overflowX="hidden")),w.add(l),l.setAttribute("data-element-id",r),l.disabled=this.data.readOnly,l.name=this.data.fieldName,l.tabIndex=j,this._setRequired(l,this.data.required),l.addEventListener("input",B=>{e.setValue(r,{value:B.target.value}),this.setPropertyOnSiblings(l,"value",B.target.value,"value")}),l.addEventListener("resetform",B=>{var G;const K=(G=this.data.defaultFieldValue)!=null?G:"";l.value=I.userValue=K,I.formattedValue=null});let z=B=>{const{formattedValue:K}=I;K!=null&&(B.target.value=K),B.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){l.addEventListener("focus",K=>{I.userValue&&(K.target.value=I.userValue),I.valueOnFocus=K.target.value}),l.addEventListener("updatefromsandbox",K=>{const G={value(Z){var ft;I.userValue=(ft=Z.detail.value)!=null?ft:"",e.setValue(r,{value:I.userValue.toString()}),Z.target.value=I.userValue},formattedValue(Z){const{formattedValue:ft}=Z.detail;I.formattedValue=ft,ft!=null&&Z.target!==document.activeElement&&(Z.target.value=ft),e.setValue(r,{formattedValue:ft})},selRange(Z){Z.target.setSelectionRange(...Z.detail.selRange)}};this._dispatchEventFromSandbox(G,K)}),l.addEventListener("keydown",K=>{var ft;let G=-1;if(K.key==="Escape"?G=0:K.key==="Enter"?G=2:K.key==="Tab"&&(G=3),G===-1)return;const{value:Z}=K.target;I.valueOnFocus!==Z&&(I.userValue=Z,(ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:Z,willCommit:!0,commitKey:G,selStart:K.target.selectionStart,selEnd:K.target.selectionEnd}}))});const B=z;z=null,l.addEventListener("blur",K=>{var Z;const{value:G}=K.target;I.userValue=G,this._mouseState.isDown&&I.valueOnFocus!==G&&((Z=this.linkService.eventBus)==null||Z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:G,willCommit:!0,commitKey:1,selStart:K.target.selectionStart,selEnd:K.target.selectionEnd}})),B(K)}),(u=this.data.actions)!=null&&u.Keystroke&&l.addEventListener("beforeinput",K=>{var X;const{data:G,target:Z}=K,{value:ft,selectionStart:pt,selectionEnd:At}=Z;let nt=pt,yt=At;switch(K.inputType){case"deleteWordBackward":{const et=ft.substring(0,pt).match(/\w*[^\w]*$/);et&&(nt-=et[0].length);break}case"deleteWordForward":{const et=ft.substring(pt).match(/^[^\w]*\w*/);et&&(yt+=et[0].length);break}case"deleteContentBackward":pt===At&&(nt-=1);break;case"deleteContentForward":pt===At&&(yt+=1);break}K.preventDefault(),(X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:ft,change:G||"",willCommit:!1,selStart:nt,selEnd:yt}})}),this._setEventListeners(l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],K=>K.target.value)}if(z&&l.addEventListener("blur",z),this.data.maxLen!==null&&(l.maxLength=this.data.maxLen),this.data.comb){const K=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;l.classList.add("comb"),l.style.letterSpacing=`calc(${K}px * var(--scale-factor) - 1ch)`}}else l=document.createElement("div"),l.textContent=this.data.fieldValue,l.style.verticalAlign="middle",l.style.display="table-cell";return this._setTextStyle(l),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class E extends s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,r=this.data,l=r.id;let u=e.getValue(l,{value:r.exportValue===r.fieldValue}).value;typeof u=="string"&&(u=u!=="Off",e.setValue(l,{value:u})),this.container.className="buttonWidgetAnnotation checkBox";const g=document.createElement("input");return w.add(g),g.setAttribute("data-element-id",l),g.disabled=r.readOnly,this._setRequired(g,this.data.required),g.type="checkbox",g.name=r.fieldName,u&&g.setAttribute("checked",!0),g.setAttribute("exportValue",r.exportValue),g.tabIndex=j,g.addEventListener("change",M=>{const{name:I,checked:z}=M.target;for(const B of this._getElementsByName(I,l)){const K=z&&B.exportValue===r.exportValue;B.domElement&&(B.domElement.checked=K),e.setValue(B.id,{value:K})}e.setValue(l,{value:z})}),g.addEventListener("resetform",M=>{const I=r.defaultFieldValue||"Off";M.target.checked=I===r.exportValue}),this.enableScripting&&this.hasJSActions&&(g.addEventListener("updatefromsandbox",M=>{const I={value(z){z.target.checked=z.detail.value!=="Off",e.setValue(l,{value:z.target.checked})}};this._dispatchEventFromSandbox(I,M)}),this._setEventListeners(g,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],M=>M.target.checked)),this._setBackgroundColor(g),this._setDefaultPropertiesFromJS(g),this.container.append(g),this.container}}class p extends s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const e=this.annotationStorage,r=this.data,l=r.id;let u=e.getValue(l,{value:r.fieldValue===r.buttonValue}).value;typeof u=="string"&&(u=u!==r.buttonValue,e.setValue(l,{value:u}));const g=document.createElement("input");if(w.add(g),g.setAttribute("data-element-id",l),g.disabled=r.readOnly,this._setRequired(g,this.data.required),g.type="radio",g.name=r.fieldName,u&&g.setAttribute("checked",!0),g.tabIndex=j,g.addEventListener("change",M=>{const{name:I,checked:z}=M.target;for(const B of this._getElementsByName(I,l))e.setValue(B.id,{value:!1});e.setValue(l,{value:z})}),g.addEventListener("resetform",M=>{const I=r.defaultFieldValue;M.target.checked=I!=null&&I===r.buttonValue}),this.enableScripting&&this.hasJSActions){const M=r.buttonValue;g.addEventListener("updatefromsandbox",I=>{const z={value:B=>{const K=M===B.detail.value;for(const G of this._getElementsByName(B.target.name)){const Z=K&&G.id===l;G.domElement&&(G.domElement.checked=Z),e.setValue(G.id,{value:Z})}}};this._dispatchEventFromSandbox(z,I)}),this._setEventListeners(g,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],I=>I.target.checked)}return this._setBackgroundColor(g),this._setDefaultPropertiesFromJS(g),this.container.append(g),this.container}}class h extends c{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(e.title=this.data.alternativeText);const r=e.lastChild;return this.enableScripting&&this.hasJSActions&&r&&(this._setDefaultPropertiesFromJS(r),r.addEventListener("updatefromsandbox",l=>{this._dispatchEventFromSandbox({},l)})),e}}class n extends s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const e=this.annotationStorage,r=this.data.id,l=e.getValue(r,{value:this.data.fieldValue}),u=document.createElement("select");w.add(u),u.setAttribute("data-element-id",r),u.disabled=this.data.readOnly,this._setRequired(u,this.data.required),u.name=this.data.fieldName,u.tabIndex=j;let g=this.data.combo&&this.data.options.length>0;this.data.combo||(u.size=this.data.options.length,this.data.multiSelect&&(u.multiple=!0)),u.addEventListener("resetform",B=>{const K=this.data.defaultFieldValue;for(const G of u.options)G.selected=G.value===K});for(const B of this.data.options){const K=document.createElement("option");K.textContent=B.displayValue,K.value=B.exportValue,l.value.includes(B.exportValue)&&(K.setAttribute("selected",!0),g=!1),u.append(K)}let M=null;if(g){const B=document.createElement("option");B.value=" ",B.setAttribute("hidden",!0),B.setAttribute("selected",!0),u.prepend(B),M=()=>{B.remove(),u.removeEventListener("input",M),M=null},u.addEventListener("input",M)}const I=(B,K)=>{const G=K?"value":"textContent",Z=B.target.options;return B.target.multiple?Array.prototype.filter.call(Z,ft=>ft.selected).map(ft=>ft[G]):Z.selectedIndex===-1?null:Z[Z.selectedIndex][G]},z=B=>{const K=B.target.options;return Array.prototype.map.call(K,G=>({displayValue:G.textContent,exportValue:G.value}))};return this.enableScripting&&this.hasJSActions?(u.addEventListener("updatefromsandbox",B=>{const K={value(G){M==null||M();const Z=G.detail.value,ft=new Set(Array.isArray(Z)?Z:[Z]);for(const pt of u.options)pt.selected=ft.has(pt.value);e.setValue(r,{value:I(G,!0)})},multipleSelection(G){u.multiple=!0},remove(G){const Z=u.options,ft=G.detail.remove;Z[ft].selected=!1,u.remove(ft),Z.length>0&&Array.prototype.findIndex.call(Z,At=>At.selected)===-1&&(Z[0].selected=!0),e.setValue(r,{value:I(G,!0),items:z(G)})},clear(G){for(;u.length!==0;)u.remove(0);e.setValue(r,{value:null,items:[]})},insert(G){const{index:Z,displayValue:ft,exportValue:pt}=G.detail.insert,At=u.children[Z],nt=document.createElement("option");nt.textContent=ft,nt.value=pt,At?At.before(nt):u.append(nt),e.setValue(r,{value:I(G,!0),items:z(G)})},items(G){const{items:Z}=G.detail;for(;u.length!==0;)u.remove(0);for(const ft of Z){const{displayValue:pt,exportValue:At}=ft,nt=document.createElement("option");nt.textContent=pt,nt.value=At,u.append(nt)}u.options.length>0&&(u.options[0].selected=!0),e.setValue(r,{value:I(G,!0),items:z(G)})},indices(G){const Z=new Set(G.detail.indices);for(const ft of G.target.options)ft.selected=Z.has(ft.index);e.setValue(r,{value:I(G,!0)})},editable(G){G.target.disabled=!G.detail.editable}};this._dispatchEventFromSandbox(K,B)}),u.addEventListener("input",B=>{var Z;const K=I(B,!0),G=I(B,!1);e.setValue(r,{value:K}),(Z=this.linkService.eventBus)==null||Z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:G,changeEx:K,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],B=>B.target.checked)):u.addEventListener("input",function(B){e.setValue(r,{value:I(B,!0)})}),this.data.combo&&this._setTextStyle(u),this._setBackgroundColor(u),this._setDefaultPropertiesFromJS(u),this.container.append(u),this.container}}class a extends C{constructor(e){var l,u,g;const r=!!(((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r})}render(){const e=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",e.includes(this.data.parentType))return this.container;const r=`[data-annotation-id="${this.data.parentId}"]`,l=this.layer.querySelectorAll(r);if(l.length===0)return this.container;const u=new f({container:this.container,trigger:Array.from(l),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),g=this.page,M=b.Util.normalizeRect([this.data.parentRect[0],g.view[3]-this.data.parentRect[1]+g.view[1],this.data.parentRect[2],g.view[3]-this.data.parentRect[3]+g.view[1]]),I=M[0]+this.data.parentRect[2]-this.data.parentRect[0],z=M[1],[B,K,G,Z]=this.viewport.viewBox,ft=G-B,pt=Z-K;return this.container.style.left=`${100*(I-B)/ft}%`,this.container.style.top=`${100*(z-K)/pt}%`,this.container.append(u.render()),this.container}}class f{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.titleObj=e.titleObj,this.modificationDate=e.modificationDate,this.contentsObj=e.contentsObj,this.richText=e.richText,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){var I,z;const r=document.createElement("div");r.className="popupWrapper",this.hideElement=this.hideWrapper?r:this.container,this.hideElement.hidden=!0;const l=document.createElement("div");l.className="popup";const u=this.color;if(u){const B=.7*(255-u[0])+u[0],K=.7*(255-u[1])+u[1],G=.7*(255-u[2])+u[2];l.style.backgroundColor=b.Util.makeHexColor(B|0,K|0,G|0)}const g=document.createElement("h1");g.dir=this.titleObj.dir,g.textContent=this.titleObj.str,l.append(g);const M=L.PDFDateString.toDateObject(this.modificationDate);if(M){const B=document.createElement("span");B.className="popupDate",B.textContent="{{date}}, {{time}}",B.dataset.l10nId="annotation_date_string",B.dataset.l10nArgs=JSON.stringify({date:M.toLocaleDateString(),time:M.toLocaleTimeString()}),l.append(B)}if(((I=this.richText)==null?void 0:I.str)&&(!((z=this.contentsObj)!=null&&z.str)||this.contentsObj.str===this.richText.str))st.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:l}),l.lastChild.className="richText popupContent";else{const B=this._formatContents(this.contentsObj);l.append(B)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const B of this.trigger)B.addEventListener("click",this._toggle.bind(this)),B.addEventListener("mouseover",this._show.bind(this,!1)),B.addEventListener("mouseout",this._hide.bind(this,!1));return l.addEventListener("click",this._hide.bind(this,!0)),r.append(l),r}_formatContents({str:e,dir:r}){const l=document.createElement("p");l.className="popupContent",l.dir=r;const u=e.split(/(?:\r\n?|\n)/);for(let g=0,M=u.length;g<M;++g){const I=u[g];l.append(document.createTextNode(I)),g<M-1&&l.append(document.createElement("br"))}return l}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(e=!0){e&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class x extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class T extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const e=this.data,{width:r,height:l}=F(e.rect),u=this.svgFactory.create(r,l,!0),g=this.svgFactory.createElement("svg:line");return g.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),g.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),g.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),g.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),g.setAttribute("stroke-width",e.borderStyle.width||1),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),u.append(g),this.container.append(u),this._createPopup(g,e),this.container}}class P extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const e=this.data,{width:r,height:l}=F(e.rect),u=this.svgFactory.create(r,l,!0),g=e.borderStyle.width,M=this.svgFactory.createElement("svg:rect");return M.setAttribute("x",g/2),M.setAttribute("y",g/2),M.setAttribute("width",r-g),M.setAttribute("height",l-g),M.setAttribute("stroke-width",g||1),M.setAttribute("stroke","transparent"),M.setAttribute("fill","transparent"),u.append(M),this.container.append(u),this._createPopup(M,e),this.container}}class D extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const e=this.data,{width:r,height:l}=F(e.rect),u=this.svgFactory.create(r,l,!0),g=e.borderStyle.width,M=this.svgFactory.createElement("svg:ellipse");return M.setAttribute("cx",r/2),M.setAttribute("cy",l/2),M.setAttribute("rx",r/2-g/2),M.setAttribute("ry",l/2-g/2),M.setAttribute("stroke-width",g||1),M.setAttribute("stroke","transparent"),M.setAttribute("fill","transparent"),u.append(M),this.container.append(u),this._createPopup(M,e),this.container}}class J extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,{width:r,height:l}=F(e.rect),u=this.svgFactory.create(r,l,!0);let g=[];for(const I of e.vertices){const z=I.x-e.rect[0],B=e.rect[3]-I.y;g.push(z+","+B)}g=g.join(" ");const M=this.svgFactory.createElement(this.svgElementName);return M.setAttribute("points",g),M.setAttribute("stroke-width",e.borderStyle.width||1),M.setAttribute("stroke","transparent"),M.setAttribute("fill","transparent"),u.append(M),this.container.append(u),this._createPopup(M,e),this.container}}class V extends J{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class k extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class q extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,{width:r,height:l}=F(e.rect),u=this.svgFactory.create(r,l,!0);for(const g of e.inkLists){let M=[];for(const z of g){const B=z.x-e.rect[0],K=e.rect[3]-z.y;M.push(`${B},${K}`)}M=M.join(" ");const I=this.svgFactory.createElement(this.svgElementName);I.setAttribute("points",M),I.setAttribute("stroke-width",e.borderStyle.width||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),this._createPopup(I,e),u.append(I)}return this.container.append(u),this.container}}class y extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class N extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class O extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class it extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class ot extends C{constructor(e){var l,u,g;const r=!!(e.data.hasPopup||((l=e.data.titleObj)==null?void 0:l.str)||((u=e.data.contentsObj)==null?void 0:u.str)||((g=e.data.richText)==null?void 0:g.str));super(e,{isRenderable:r,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class ht extends C{constructor(e){var u;super(e,{isRenderable:!0});const{filename:r,content:l}=this.data.file;this.filename=(0,L.getFilenameFromUrl)(r),this.content=l,(u=this.linkService.eventBus)==null||u.dispatch("fileattachmentannotation",{source:this,filename:r,content:l})}render(){var r,l;this.container.className="fileAttachmentAnnotation";const e=document.createElement("div");return e.className="popupTriggerArea",e.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(((r=this.data.titleObj)==null?void 0:r.str)||((l=this.data.contentsObj)==null?void 0:l.str)||this.data.richText)&&this._createPopup(e,this.data),this.container.append(e),this.container}_download(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)}}class mt{static render(e){const{annotations:r,div:l,viewport:u}=e;lt(this,_t,Ee).call(this,l,u);const g=[],M=[];for(const I of r){if(!I)continue;if(I.annotationType===b.AnnotationType.POPUP){M.push(I);continue}const{width:z,height:B}=F(I.rect);z<=0||B<=0||g.push(I)}M.length&&g.push(...M);for(const I of g){const z=v.create({data:I,layer:l,page:e.page,viewport:u,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new L.DOMSVGFactory,annotationStorage:e.annotationStorage||new Y.AnnotationStorage,enableScripting:e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,mouseState:e.mouseState||{isDown:!1}});if(z.isRenderable){const B=z.render();if(I.hidden&&(B.style.visibility="hidden"),Array.isArray(B))for(const K of B)l.append(K);else z instanceof a?l.prepend(B):l.append(B)}}lt(this,d,Ce).call(this,l,e.annotationCanvasMap)}static update(e){const{annotationCanvasMap:r,div:l,viewport:u}=e;lt(this,_t,Ee).call(this,l,u),lt(this,d,Ce).call(this,l,r),l.hidden=!1}}_t=new WeakSet,Ee=function(e,{width:r,height:l,rotation:u}){const{style:g}=e,M=u%180!==0,I=Math.floor(r)+"px",z=Math.floor(l)+"px";g.width=M?z:I,g.height=M?I:z,e.setAttribute("data-main-rotation",u)},d=new WeakSet,Ce=function(e,r){if(!!r){for(const[l,u]of r){const g=e.querySelector(`[data-annotation-id="${l}"]`);if(!g)continue;const{firstChild:M}=g;M?M.nodeName==="CANVAS"?M.replaceWith(u):M.before(u):g.append(u)}r.clear()}},rt(mt,_t),rt(mt,d),_.AnnotationLayer=mt},(at,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.ColorConverters=void 0;function Q(L){return Math.floor(Math.max(0,Math.min(1,L))*255).toString(16).padStart(2,"0")}class b{static CMYK_G([Y,H,st,j]){return["G",1-Math.min(1,.3*Y+.59*st+.11*H+j)]}static G_CMYK([Y]){return["CMYK",0,0,0,1-Y]}static G_RGB([Y]){return["RGB",Y,Y,Y]}static G_HTML([Y]){const H=Q(Y);return`#${H}${H}${H}`}static RGB_G([Y,H,st]){return["G",.3*Y+.59*H+.11*st]}static RGB_HTML([Y,H,st]){const j=Q(Y),A=Q(H),w=Q(st);return`#${j}${A}${w}`}static T_HTML(){return"#00000000"}static CMYK_RGB([Y,H,st,j]){return["RGB",1-Math.min(1,Y+j),1-Math.min(1,st+j),1-Math.min(1,H+j)]}static CMYK_HTML(Y){const H=this.CMYK_RGB(Y).slice(1);return this.RGB_HTML(H)}static RGB_CMYK([Y,H,st]){const j=1-Y,A=1-H,w=1-st,F=Math.min(j,A,w);return["CMYK",j,A,w,F]}}_.ColorConverters=b},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.XfaLayer=void 0;var b=Q(20);class L{static setupStorage(H,st,j,A,w){const F=A.getValue(st,{value:null});switch(j.name){case"textarea":if(F.value!==null&&(H.textContent=F.value),w==="print")break;H.addEventListener("input",v=>{A.setValue(st,{value:v.target.value})});break;case"input":if(j.attributes.type==="radio"||j.attributes.type==="checkbox"){if(F.value===j.attributes.xfaOn?H.setAttribute("checked",!0):F.value===j.attributes.xfaOff&&H.removeAttribute("checked"),w==="print")break;H.addEventListener("change",v=>{A.setValue(st,{value:v.target.checked?v.target.getAttribute("xfaOn"):v.target.getAttribute("xfaOff")})})}else{if(F.value!==null&&H.setAttribute("value",F.value),w==="print")break;H.addEventListener("input",v=>{A.setValue(st,{value:v.target.value})})}break;case"select":if(F.value!==null)for(const v of j.children)v.attributes.value===F.value&&(v.attributes.selected=!0);H.addEventListener("input",v=>{const C=v.target.options,c=C.selectedIndex===-1?"":C[C.selectedIndex].value;A.setValue(st,{value:c})});break}}static setAttributes({html:H,element:st,storage:j=null,intent:A,linkService:w}){const{attributes:F}=st,v=H instanceof HTMLAnchorElement;F.type==="radio"&&(F.name=`${F.name}-${A}`);for(const[C,c]of Object.entries(F))if(c!=null)switch(C){case"class":c.length&&H.setAttribute(C,c.join(" "));break;case"dataId":break;case"id":H.setAttribute("data-element-id",c);break;case"style":Object.assign(H.style,c);break;case"textContent":H.textContent=c;break;default:(!v||C!=="href"&&C!=="newWindow")&&H.setAttribute(C,c)}v&&w.addLinkAttributes(H,F.href,F.newWindow),j&&F.dataId&&this.setupStorage(H,F.dataId,st,j)}static render(H){var t;const st=H.annotationStorage,j=H.linkService,A=H.xfaHtml,w=H.intent||"display",F=document.createElement(A.name);A.attributes&&this.setAttributes({html:F,element:A,intent:w,linkService:j});const v=[[A,-1,F]],C=H.div;if(C.append(F),H.viewport){const s=`matrix(${H.viewport.transform.join(",")})`;C.style.transform=s}w!=="richText"&&C.setAttribute("class","xfaLayer xfaFont");const c=[];for(;v.length>0;){const[s,i,E]=v.at(-1);if(i+1===s.children.length){v.pop();continue}const p=s.children[++v.at(-1)[1]];if(p===null)continue;const{name:h}=p;if(h==="#text"){const a=document.createTextNode(p.value);c.push(a),E.append(a);continue}let n;if((t=p==null?void 0:p.attributes)!=null&&t.xmlns?n=document.createElementNS(p.attributes.xmlns,h):n=document.createElement(h),E.append(n),p.attributes&&this.setAttributes({html:n,element:p,storage:st,intent:w,linkService:j}),p.children&&p.children.length>0)v.push([p,-1,n]);else if(p.value){const a=document.createTextNode(p.value);b.XfaText.shouldBuildText(h)&&c.push(a),n.append(a)}}for(const s of C.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))s.setAttribute("readOnly",!0);return{textDivs:c}}static update(H){const st=`matrix(${H.viewport.transform.join(",")})`;H.div.style.transform=st,H.div.hidden=!1}}_.XfaLayer=L},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.TextLayerRenderTask=void 0,_.renderTextLayer=E;var b=Q(1),L=Q(4);const Y=1e5,H=30,st=.8,j=new Map,A=/^\s+$/g;function w(p,h){const n=j.get(p);if(n)return n;h.save(),h.font=`${H}px ${p}`;const a=h.measureText("");let f=a.fontBoundingBoxAscent,x=Math.abs(a.fontBoundingBoxDescent);if(f){h.restore();const P=f/(f+x);return j.set(p,P),P}h.strokeStyle="red",h.clearRect(0,0,H,H),h.strokeText("g",0,0);let T=h.getImageData(0,0,H,H).data;x=0;for(let P=T.length-1-3;P>=0;P-=4)if(T[P]>0){x=Math.ceil(P/4/H);break}h.clearRect(0,0,H,H),h.strokeText("A",0,H),T=h.getImageData(0,0,H,H).data,f=0;for(let P=0,D=T.length;P<D;P+=4)if(T[P]>0){f=H-Math.floor(P/4/H);break}if(h.restore(),f){const P=f/(f+x);return j.set(p,P),P}return j.set(p,st),st}function F(p,h,n,a){const f=document.createElement("span"),x=p._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:h.str!=="",hasEOL:h.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:h.str!=="",hasEOL:h.hasEOL,fontSize:0};p._textDivs.push(f);const T=b.Util.transform(p._viewport.transform,h.transform);let P=Math.atan2(T[1],T[0]);const D=n[h.fontName];D.vertical&&(P+=Math.PI/2);const J=Math.hypot(T[2],T[3]),V=J*w(D.fontFamily,a);let k,q;P===0?(k=T[4],q=T[5]-V):(k=T[4]+V*Math.sin(P),q=T[5]-V*Math.cos(P)),f.style.left=`${k}px`,f.style.top=`${q}px`,f.style.fontSize=`${J}px`,f.style.fontFamily=D.fontFamily,x.fontSize=J,f.setAttribute("role","presentation"),f.textContent=h.str,f.dir=h.dir,p._fontInspectorEnabled&&(f.dataset.fontName=h.fontName),P!==0&&(x.angle=P*(180/Math.PI));let y=!1;if(h.str.length>1||p._enhanceTextSelection&&A.test(h.str))y=!0;else if(h.str!==" "&&h.transform[0]!==h.transform[3]){const N=Math.abs(h.transform[0]),O=Math.abs(h.transform[3]);N!==O&&Math.max(N,O)/Math.min(N,O)>1.5&&(y=!0)}if(y&&(D.vertical?x.canvasWidth=h.height*p._viewport.scale:x.canvasWidth=h.width*p._viewport.scale),p._textDivProperties.set(f,x),p._textContentStream&&p._layoutText(f),p._enhanceTextSelection&&x.hasText){let N=1,O=0;P!==0&&(N=Math.cos(P),O=Math.sin(P));const it=(D.vertical?h.height:h.width)*p._viewport.scale,ot=J;let ht,mt;P!==0?(ht=[N,O,-O,N,k,q],mt=b.Util.getAxialAlignedBoundingBox([0,0,it,ot],ht)):mt=[k,q,k+it,q+ot],p._bounds.push({left:mt[0],top:mt[1],right:mt[2],bottom:mt[3],div:f,size:[it,ot],m:ht})}}function v(p){if(p._canceled)return;const h=p._textDivs,n=p._capability,a=h.length;if(a>Y){p._renderingDone=!0,n.resolve();return}if(!p._textContentStream)for(let f=0;f<a;f++)p._layoutText(h[f]);p._renderingDone=!0,n.resolve()}function C(p,h,n){let a=0;for(let f=0;f<n;f++){const x=p[h++];x>0&&(a=a?Math.min(x,a):x)}return a}function c(p){const h=p._bounds,n=p._viewport,a=t(n.width,n.height,h);for(let f=0;f<a.length;f++){const x=h[f].div,T=p._textDivProperties.get(x);if(T.angle===0){T.paddingLeft=h[f].left-a[f].left,T.paddingTop=h[f].top-a[f].top,T.paddingRight=a[f].right-h[f].right,T.paddingBottom=a[f].bottom-h[f].bottom,p._textDivProperties.set(x,T);continue}const P=a[f],D=h[f],J=D.m,V=J[0],k=J[1],q=[[0,0],[0,D.size[1]],[D.size[0],0],D.size],y=new Float64Array(64);for(let O=0,it=q.length;O<it;O++){const ot=b.Util.applyTransform(q[O],J);y[O+0]=V&&(P.left-ot[0])/V,y[O+4]=k&&(P.top-ot[1])/k,y[O+8]=V&&(P.right-ot[0])/V,y[O+12]=k&&(P.bottom-ot[1])/k,y[O+16]=k&&(P.left-ot[0])/-k,y[O+20]=V&&(P.top-ot[1])/V,y[O+24]=k&&(P.right-ot[0])/-k,y[O+28]=V&&(P.bottom-ot[1])/V,y[O+32]=V&&(P.left-ot[0])/-V,y[O+36]=k&&(P.top-ot[1])/-k,y[O+40]=V&&(P.right-ot[0])/-V,y[O+44]=k&&(P.bottom-ot[1])/-k,y[O+48]=k&&(P.left-ot[0])/k,y[O+52]=V&&(P.top-ot[1])/-V,y[O+56]=k&&(P.right-ot[0])/k,y[O+60]=V&&(P.bottom-ot[1])/-V}const N=1+Math.min(Math.abs(V),Math.abs(k));T.paddingLeft=C(y,32,16)/N,T.paddingTop=C(y,48,16)/N,T.paddingRight=C(y,0,16)/N,T.paddingBottom=C(y,16,16)/N,p._textDivProperties.set(x,T)}}function t(p,h,n){const a=n.map(function(x,T){return{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom,index:T,x1New:void 0,x2New:void 0}});s(p,a);const f=new Array(n.length);for(const x of a){const T=x.index;f[T]={left:x.x1New,top:0,right:x.x2New,bottom:0}}n.map(function(x,T){const P=f[T],D=a[T];D.x1=x.top,D.y1=p-P.right,D.x2=x.bottom,D.y2=p-P.left,D.index=T,D.x1New=void 0,D.x2New=void 0}),s(h,a);for(const x of a){const T=x.index;f[T].top=x.x1New,f[T].bottom=x.x2New}return f}function s(p,h){h.sort(function(f,x){return f.x1-x.x1||f.index-x.index});const a=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const f of h){let x=0;for(;x<a.length&&a[x].end<=f.y1;)x++;let T=a.length-1;for(;T>=0&&a[T].start>=f.y2;)T--;let P,D,J,V,k=-1/0;for(J=x;J<=T;J++){P=a[J],D=P.boundary;let N;D.x2>f.x1?N=D.index>f.index?D.x1New:f.x1:D.x2New===void 0?N=(D.x2+f.x1)/2:N=D.x2New,N>k&&(k=N)}for(f.x1New=k,J=x;J<=T;J++)P=a[J],D=P.boundary,D.x2New===void 0?D.x2>f.x1?D.index>f.index&&(D.x2New=D.x2):D.x2New=k:D.x2New>k&&(D.x2New=Math.max(k,D.x2));const q=[];let y=null;for(J=x;J<=T;J++){P=a[J],D=P.boundary;const N=D.x2>f.x2?D:f;y===N?q.at(-1).end=P.end:(q.push({start:P.start,end:P.end,boundary:N}),y=N)}for(a[x].start<f.y1&&(q[0].start=f.y1,q.unshift({start:a[x].start,end:f.y1,boundary:a[x].boundary})),f.y2<a[T].end&&(q.at(-1).end=f.y2,q.push({start:f.y2,end:a[T].end,boundary:a[T].boundary})),J=x;J<=T;J++){if(P=a[J],D=P.boundary,D.x2New!==void 0)continue;let N=!1;for(V=x-1;!N&&V>=0&&a[V].start>=D.y1;V--)N=a[V].boundary===D;for(V=T+1;!N&&V<a.length&&a[V].end<=D.y2;V++)N=a[V].boundary===D;for(V=0;!N&&V<q.length;V++)N=q[V].boundary===D;N||(D.x2New=k)}Array.prototype.splice.apply(a,[x,T-x+1,...q])}for(const f of a){const x=f.boundary;x.x2New===void 0&&(x.x2New=Math.max(p,x.x2))}}class i{constructor({textContent:h,textContentStream:n,container:a,viewport:f,textDivs:x,textContentItemsStr:T,enhanceTextSelection:P}){var D;P&&(0,L.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=h,this._textContentStream=n,this._container=a,this._document=a.ownerDocument,this._viewport=f,this._textDivs=x||[],this._textContentItemsStr=T||[],this._enhanceTextSelection=!!P,this._fontInspectorEnabled=!!((D=globalThis.FontInspector)!=null&&D.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,b.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new b.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(h,n){for(let a=0,f=h.length;a<f;a++){if(h[a].str===void 0){if(h[a].type==="beginMarkedContentProps"||h[a].type==="beginMarkedContent"){const x=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),h[a].id!==null&&this._container.setAttribute("id",`${h[a].id}`),x.append(this._container)}else h[a].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(h[a].str),F(this,h[a],n,this._layoutTextCtx)}}_layoutText(h){const n=this._textDivProperties.get(h);let a="";if(n.canvasWidth!==0&&n.hasText){const{fontFamily:f}=h.style,{fontSize:x}=n;(x!==this._layoutTextLastFontSize||f!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${x*this._devicePixelRatio}px ${f}`,this._layoutTextLastFontSize=x,this._layoutTextLastFontFamily=f);const{width:T}=this._layoutTextCtx.measureText(h.textContent);if(T>0){const P=this._devicePixelRatio*n.canvasWidth/T;this._enhanceTextSelection&&(n.scale=P),a=`scaleX(${P})`}}if(n.angle!==0&&(a=`rotate(${n.angle}deg) ${a}`),a.length>0&&(this._enhanceTextSelection&&(n.originalTransform=a),h.style.transform=a),n.hasText&&this._container.append(h),n.hasEOL){const f=document.createElement("br");f.setAttribute("role","presentation"),this._container.append(f)}}_render(h=0){const n=(0,b.createPromiseCapability)();let a=Object.create(null);const f=this._document.createElement("canvas");if(f.height=f.width=H,this._layoutTextCtx=f.getContext("2d",{alpha:!1}),this._textContent){const x=this._textContent.items,T=this._textContent.styles;this._processItems(x,T),n.resolve()}else if(this._textContentStream){const x=()=>{this._reader.read().then(({value:T,done:P})=>{if(P){n.resolve();return}Object.assign(a,T.styles),this._processItems(T.items,a),x()},n.reject)};this._reader=this._textContentStream.getReader(),x()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');n.promise.then(()=>{a=null,h?this._renderTimer=setTimeout(()=>{v(this),this._renderTimer=null},h):v(this)},this._capability.reject)}expandTextDivs(h=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(c(this),this._bounds=null);const n=[],a=[];for(let f=0,x=this._textDivs.length;f<x;f++){const T=this._textDivs[f],P=this._textDivProperties.get(T);!P.hasText||(h?(n.length=0,a.length=0,P.originalTransform&&n.push(P.originalTransform),P.paddingTop>0?(a.push(`${P.paddingTop}px`),n.push(`translateY(${-P.paddingTop}px)`)):a.push(0),P.paddingRight>0?a.push(`${P.paddingRight/P.scale}px`):a.push(0),P.paddingBottom>0?a.push(`${P.paddingBottom}px`):a.push(0),P.paddingLeft>0?(a.push(`${P.paddingLeft/P.scale}px`),n.push(`translateX(${-P.paddingLeft/P.scale}px)`)):a.push(0),T.style.padding=a.join(" "),n.length&&(T.style.transform=n.join(" "))):(T.style.padding=null,T.style.transform=P.originalTransform))}}}_.TextLayerRenderTask=i;function E(p){const h=new i({textContent:p.textContent,textContentStream:p.textContentStream,container:p.container,viewport:p.viewport,textDivs:p.textDivs,textContentItemsStr:p.textContentItemsStr,enhanceTextSelection:p.enhanceTextSelection});return h._render(p.timeout),h}},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.SVGGraphics=void 0;var b=Q(4),L=Q(1),Y=Q(3);let H=class{constructor(){(0,L.unreachable)("Not implemented: SVGGraphics")}};_.SVGGraphics=H;{let t=function(n){let a=[];const f=[];for(const x of n){if(x.fn==="save"){a.push({fnId:92,fn:"group",items:[]}),f.push(a),a=a.at(-1).items;continue}x.fn==="restore"?a=f.pop():a.push(x)}return a},s=function(n){if(Number.isInteger(n))return n.toString();const a=n.toFixed(10);let f=a.length-1;if(a[f]!=="0")return a;do f--;while(a[f]==="0");return a.substring(0,a[f]==="."?f:f+1)},i=function(n){if(n[4]===0&&n[5]===0){if(n[1]===0&&n[2]===0)return n[0]===1&&n[3]===1?"":`scale(${s(n[0])} ${s(n[3])})`;if(n[0]===n[3]&&n[1]===-n[2]){const a=Math.acos(n[0])*180/Math.PI;return`rotate(${s(a)})`}}else if(n[0]===1&&n[1]===0&&n[2]===0&&n[3]===1)return`translate(${s(n[4])} ${s(n[5])})`;return`matrix(${s(n[0])} ${s(n[1])} ${s(n[2])} ${s(n[3])} ${s(n[4])} ${s(n[5])})`};const st={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},j="http://www.w3.org/XML/1998/namespace",A="http://www.w3.org/1999/xlink",w=["butt","round","square"],F=["miter","round","bevel"],v=function(n,a="",f=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!f)return URL.createObjectURL(new Blob([n],{type:a}));const x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let T=`data:${a};base64,`;for(let P=0,D=n.length;P<D;P+=3){const J=n[P]&255,V=n[P+1]&255,k=n[P+2]&255,q=J>>2,y=(J&3)<<4|V>>4,N=P+1<D?(V&15)<<2|k>>6:64,O=P+2<D?k&63:64;T+=x[q]+x[y]+x[N]+x[O]}return T},C=function(){const n=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,f=new Int32Array(256);for(let k=0;k<256;k++){let q=k;for(let y=0;y<8;y++)q&1?q=3988292384^q>>1&2147483647:q=q>>1&2147483647;f[k]=q}function x(k,q,y){let N=-1;for(let O=q;O<y;O++){const it=(N^k[O])&255,ot=f[it];N=N>>>8^ot}return N^-1}function T(k,q,y,N){let O=N;const it=q.length;y[O]=it>>24&255,y[O+1]=it>>16&255,y[O+2]=it>>8&255,y[O+3]=it&255,O+=4,y[O]=k.charCodeAt(0)&255,y[O+1]=k.charCodeAt(1)&255,y[O+2]=k.charCodeAt(2)&255,y[O+3]=k.charCodeAt(3)&255,O+=4,y.set(q,O),O+=q.length;const ot=x(y,N+4,O);y[O]=ot>>24&255,y[O+1]=ot>>16&255,y[O+2]=ot>>8&255,y[O+3]=ot&255}function P(k,q,y){let N=1,O=0;for(let it=q;it<y;++it)N=(N+(k[it]&255))%65521,O=(O+N)%65521;return O<<16|N}function D(k){if(!Y.isNodeJS)return J(k);try{let q;parseInt(process.versions.node)>=8?q=k:q=Buffer.from(k);const y=require$$5.deflateSync(q,{level:9});return y instanceof Uint8Array?y:new Uint8Array(y)}catch(q){(0,L.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+q)}return J(k)}function J(k){let q=k.length;const y=65535,N=Math.ceil(q/y),O=new Uint8Array(2+q+N*5+4);let it=0;O[it++]=120,O[it++]=156;let ot=0;for(;q>y;)O[it++]=0,O[it++]=255,O[it++]=255,O[it++]=0,O[it++]=0,O.set(k.subarray(ot,ot+y),it),it+=y,ot+=y,q-=y;O[it++]=1,O[it++]=q&255,O[it++]=q>>8&255,O[it++]=~q&65535&255,O[it++]=(~q&65535)>>8&255,O.set(k.subarray(ot),it),it+=k.length-ot;const ht=P(k,0,k.length);return O[it++]=ht>>24&255,O[it++]=ht>>16&255,O[it++]=ht>>8&255,O[it++]=ht&255,O}function V(k,q,y,N){const O=k.width,it=k.height;let ot,ht,mt;const _t=k.data;switch(q){case L.ImageKind.GRAYSCALE_1BPP:ht=0,ot=1,mt=O+7>>3;break;case L.ImageKind.RGB_24BPP:ht=2,ot=8,mt=O*3;break;case L.ImageKind.RGBA_32BPP:ht=6,ot=8,mt=O*4;break;default:throw new Error("invalid format")}const R=new Uint8Array((1+mt)*it);let d=0,o=0;for(let g=0;g<it;++g)R[d++]=0,R.set(_t.subarray(o,o+mt),d),o+=mt,d+=mt;if(q===L.ImageKind.GRAYSCALE_1BPP&&N){d=0;for(let g=0;g<it;g++){d++;for(let M=0;M<mt;M++)R[d++]^=255}}const m=new Uint8Array([O>>24&255,O>>16&255,O>>8&255,O&255,it>>24&255,it>>16&255,it>>8&255,it&255,ot,ht,0,0,0]),e=D(R),r=n.length+a*3+m.length+e.length,l=new Uint8Array(r);let u=0;return l.set(n,u),u+=n.length,T("IHDR",m,l,u),u+=a+m.length,T("IDATA",e,l,u),u+=a+e.length,T("IEND",new Uint8Array(0),l,u),v(l,"image/png",y)}return function(q,y,N){const O=q.kind===void 0?L.ImageKind.GRAYSCALE_1BPP:q.kind;return V(q,O,y,N)}}();class c{constructor(){this.fontSizeScale=1,this.fontWeight=st.fontWeight,this.fontSize=0,this.textMatrix=L.IDENTITY_MATRIX,this.fontMatrix=L.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=L.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=st.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(a,f){this.x=a,this.y=f}}let E=0,p=0,h=0;_.SVGGraphics=H=class{constructor(n,a,f=!1){(0,b.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new b.DOMSVGFactory,this.current=new c,this.transformMatrix=L.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=n,this.objs=a,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!f,this._operatorIdMapping=[];for(const x in L.OPS)this._operatorIdMapping[L.OPS[x]]=x}save(){this.transformStack.push(this.transformMatrix);const n=this.current;this.extraStack.push(n),this.current=n.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(n){this.save(),this.executeOpTree(n),this.restore()}loadDependencies(n){const a=n.fnArray,f=n.argsArray;for(let x=0,T=a.length;x<T;x++)if(a[x]===L.OPS.dependency)for(const P of f[x]){const D=P.startsWith("g_")?this.commonObjs:this.objs,J=new Promise(V=>{D.get(P,V)});this.current.dependencies.push(J)}return Promise.all(this.current.dependencies)}transform(n,a,f,x,T,P){const D=[n,a,f,x,T,P];this.transformMatrix=L.Util.transform(this.transformMatrix,D),this.tgrp=null}getSVG(n,a){this.viewport=a;const f=this._initialize(a);return this.loadDependencies(n).then(()=>(this.transformMatrix=L.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(n)),f))}convertOpList(n){const a=this._operatorIdMapping,f=n.argsArray,x=n.fnArray,T=[];for(let P=0,D=x.length;P<D;P++){const J=x[P];T.push({fnId:J,fn:a[J],args:f[P]})}return t(T)}executeOpTree(n){for(const a of n){const f=a.fn,x=a.fnId,T=a.args;switch(x|0){case L.OPS.beginText:this.beginText();break;case L.OPS.dependency:break;case L.OPS.setLeading:this.setLeading(T);break;case L.OPS.setLeadingMoveText:this.setLeadingMoveText(T[0],T[1]);break;case L.OPS.setFont:this.setFont(T);break;case L.OPS.showText:this.showText(T[0]);break;case L.OPS.showSpacedText:this.showText(T[0]);break;case L.OPS.endText:this.endText();break;case L.OPS.moveText:this.moveText(T[0],T[1]);break;case L.OPS.setCharSpacing:this.setCharSpacing(T[0]);break;case L.OPS.setWordSpacing:this.setWordSpacing(T[0]);break;case L.OPS.setHScale:this.setHScale(T[0]);break;case L.OPS.setTextMatrix:this.setTextMatrix(T[0],T[1],T[2],T[3],T[4],T[5]);break;case L.OPS.setTextRise:this.setTextRise(T[0]);break;case L.OPS.setTextRenderingMode:this.setTextRenderingMode(T[0]);break;case L.OPS.setLineWidth:this.setLineWidth(T[0]);break;case L.OPS.setLineJoin:this.setLineJoin(T[0]);break;case L.OPS.setLineCap:this.setLineCap(T[0]);break;case L.OPS.setMiterLimit:this.setMiterLimit(T[0]);break;case L.OPS.setFillRGBColor:this.setFillRGBColor(T[0],T[1],T[2]);break;case L.OPS.setStrokeRGBColor:this.setStrokeRGBColor(T[0],T[1],T[2]);break;case L.OPS.setStrokeColorN:this.setStrokeColorN(T);break;case L.OPS.setFillColorN:this.setFillColorN(T);break;case L.OPS.shadingFill:this.shadingFill(T[0]);break;case L.OPS.setDash:this.setDash(T[0],T[1]);break;case L.OPS.setRenderingIntent:this.setRenderingIntent(T[0]);break;case L.OPS.setFlatness:this.setFlatness(T[0]);break;case L.OPS.setGState:this.setGState(T[0]);break;case L.OPS.fill:this.fill();break;case L.OPS.eoFill:this.eoFill();break;case L.OPS.stroke:this.stroke();break;case L.OPS.fillStroke:this.fillStroke();break;case L.OPS.eoFillStroke:this.eoFillStroke();break;case L.OPS.clip:this.clip("nonzero");break;case L.OPS.eoClip:this.clip("evenodd");break;case L.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case L.OPS.paintImageXObject:this.paintImageXObject(T[0]);break;case L.OPS.paintInlineImageXObject:this.paintInlineImageXObject(T[0]);break;case L.OPS.paintImageMaskXObject:this.paintImageMaskXObject(T[0]);break;case L.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(T[0],T[1]);break;case L.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case L.OPS.closePath:this.closePath();break;case L.OPS.closeStroke:this.closeStroke();break;case L.OPS.closeFillStroke:this.closeFillStroke();break;case L.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case L.OPS.nextLine:this.nextLine();break;case L.OPS.transform:this.transform(T[0],T[1],T[2],T[3],T[4],T[5]);break;case L.OPS.constructPath:this.constructPath(T[0],T[1]);break;case L.OPS.endPath:this.endPath();break;case 92:this.group(a.items);break;default:(0,L.warn)(`Unimplemented operator ${f}`);break}}}setWordSpacing(n){this.current.wordSpacing=n}setCharSpacing(n){this.current.charSpacing=n}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(n,a,f,x,T,P){const D=this.current;D.textMatrix=D.lineMatrix=[n,a,f,x,T,P],D.textMatrixScale=Math.hypot(n,a),D.x=D.lineX=0,D.y=D.lineY=0,D.xcoords=[],D.ycoords=[],D.tspan=this.svgFactory.createElement("svg:tspan"),D.tspan.setAttributeNS(null,"font-family",D.fontFamily),D.tspan.setAttributeNS(null,"font-size",`${s(D.fontSize)}px`),D.tspan.setAttributeNS(null,"y",s(-D.y)),D.txtElement=this.svgFactory.createElement("svg:text"),D.txtElement.append(D.tspan)}beginText(){const n=this.current;n.x=n.lineX=0,n.y=n.lineY=0,n.textMatrix=L.IDENTITY_MATRIX,n.lineMatrix=L.IDENTITY_MATRIX,n.textMatrixScale=1,n.tspan=this.svgFactory.createElement("svg:tspan"),n.txtElement=this.svgFactory.createElement("svg:text"),n.txtgrp=this.svgFactory.createElement("svg:g"),n.xcoords=[],n.ycoords=[]}moveText(n,a){const f=this.current;f.x=f.lineX+=n,f.y=f.lineY+=a,f.xcoords=[],f.ycoords=[],f.tspan=this.svgFactory.createElement("svg:tspan"),f.tspan.setAttributeNS(null,"font-family",f.fontFamily),f.tspan.setAttributeNS(null,"font-size",`${s(f.fontSize)}px`),f.tspan.setAttributeNS(null,"y",s(-f.y))}showText(n){const a=this.current,f=a.font,x=a.fontSize;if(x===0)return;const T=a.fontSizeScale,P=a.charSpacing,D=a.wordSpacing,J=a.fontDirection,V=a.textHScale*J,k=f.vertical,q=k?1:-1,y=f.defaultVMetrics,N=x*a.fontMatrix[0];let O=0;for(const ht of n){if(ht===null){O+=J*D;continue}else if(typeof ht=="number"){O+=q*ht*x/1e3;continue}const mt=(ht.isSpace?D:0)+P,_t=ht.fontChar;let R,d,o=ht.width;if(k){let e;const r=ht.vmetric||y;e=ht.vmetric?r[1]:o*.5,e=-e*N;const l=r[2]*N;o=r?-r[0]:o,R=e/T,d=(O+l)/T}else R=O/T,d=0;(ht.isInFont||f.missingFile)&&(a.xcoords.push(a.x+R),k&&a.ycoords.push(-a.y+d),a.tspan.textContent+=_t);let m;k?m=o*N-mt*J:m=o*N+mt*J,O+=m}a.tspan.setAttributeNS(null,"x",a.xcoords.map(s).join(" ")),k?a.tspan.setAttributeNS(null,"y",a.ycoords.map(s).join(" ")):a.tspan.setAttributeNS(null,"y",s(-a.y)),k?a.y-=O:a.x+=O*V,a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${s(a.fontSize)}px`),a.fontStyle!==st.fontStyle&&a.tspan.setAttributeNS(null,"font-style",a.fontStyle),a.fontWeight!==st.fontWeight&&a.tspan.setAttributeNS(null,"font-weight",a.fontWeight);const it=a.textRenderingMode&L.TextRenderingMode.FILL_STROKE_MASK;if(it===L.TextRenderingMode.FILL||it===L.TextRenderingMode.FILL_STROKE?(a.fillColor!==st.fillColor&&a.tspan.setAttributeNS(null,"fill",a.fillColor),a.fillAlpha<1&&a.tspan.setAttributeNS(null,"fill-opacity",a.fillAlpha)):a.textRenderingMode===L.TextRenderingMode.ADD_TO_PATH?a.tspan.setAttributeNS(null,"fill","transparent"):a.tspan.setAttributeNS(null,"fill","none"),it===L.TextRenderingMode.STROKE||it===L.TextRenderingMode.FILL_STROKE){const ht=1/(a.textMatrixScale||1);this._setStrokeAttributes(a.tspan,ht)}let ot=a.textMatrix;a.textRise!==0&&(ot=ot.slice(),ot[5]+=a.textRise),a.txtElement.setAttributeNS(null,"transform",`${i(ot)} scale(${s(V)}, -1)`),a.txtElement.setAttributeNS(j,"xml:space","preserve"),a.txtElement.append(a.tspan),a.txtgrp.append(a.txtElement),this._ensureTransformGroup().append(a.txtElement)}setLeadingMoveText(n,a){this.setLeading(-a),this.moveText(n,a)}addFontStyle(n){if(!n.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const a=v(n.data,n.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${n.loadedName}"; src: url(${a}); }
`}setFont(n){const a=this.current,f=this.commonObjs.get(n[0]);let x=n[1];a.font=f,this.embedFonts&&!f.missingFile&&!this.embeddedFonts[f.loadedName]&&(this.addFontStyle(f),this.embeddedFonts[f.loadedName]=f),a.fontMatrix=f.fontMatrix||L.FONT_IDENTITY_MATRIX;let T="normal";f.black?T="900":f.bold&&(T="bold");const P=f.italic?"italic":"normal";x<0?(x=-x,a.fontDirection=-1):a.fontDirection=1,a.fontSize=x,a.fontFamily=f.loadedName,a.fontWeight=T,a.fontStyle=P,a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"y",s(-a.y)),a.xcoords=[],a.ycoords=[]}endText(){var a;const n=this.current;n.textRenderingMode&L.TextRenderingMode.ADD_TO_PATH_FLAG&&((a=n.txtElement)==null?void 0:a.hasChildNodes())&&(n.element=n.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(n){n>0&&(this.current.lineWidth=n)}setLineCap(n){this.current.lineCap=w[n]}setLineJoin(n){this.current.lineJoin=F[n]}setMiterLimit(n){this.current.miterLimit=n}setStrokeAlpha(n){this.current.strokeAlpha=n}setStrokeRGBColor(n,a,f){this.current.strokeColor=L.Util.makeHexColor(n,a,f)}setFillAlpha(n){this.current.fillAlpha=n}setFillRGBColor(n,a,f){this.current.fillColor=L.Util.makeHexColor(n,a,f),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(n){this.current.strokeColor=this._makeColorN_Pattern(n)}setFillColorN(n){this.current.fillColor=this._makeColorN_Pattern(n)}shadingFill(n){const a=this.viewport.width,f=this.viewport.height,x=L.Util.inverseTransform(this.transformMatrix),T=L.Util.applyTransform([0,0],x),P=L.Util.applyTransform([0,f],x),D=L.Util.applyTransform([a,0],x),J=L.Util.applyTransform([a,f],x),V=Math.min(T[0],P[0],D[0],J[0]),k=Math.min(T[1],P[1],D[1],J[1]),q=Math.max(T[0],P[0],D[0],J[0]),y=Math.max(T[1],P[1],D[1],J[1]),N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x",V),N.setAttributeNS(null,"y",k),N.setAttributeNS(null,"width",q-V),N.setAttributeNS(null,"height",y-k),N.setAttributeNS(null,"fill",this._makeShadingPattern(n)),this.current.fillAlpha<1&&N.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(N)}_makeColorN_Pattern(n){return n[0]==="TilingPattern"?this._makeTilingPattern(n):this._makeShadingPattern(n)}_makeTilingPattern(n){const a=n[1],f=n[2],x=n[3]||L.IDENTITY_MATRIX,[T,P,D,J]=n[4],V=n[5],k=n[6],q=n[7],y=`shading${h++}`,[N,O,it,ot]=L.Util.normalizeRect([...L.Util.applyTransform([T,P],x),...L.Util.applyTransform([D,J],x)]),[ht,mt]=L.Util.singularValueDecompose2dScale(x),_t=V*ht,R=k*mt,d=this.svgFactory.createElement("svg:pattern");d.setAttributeNS(null,"id",y),d.setAttributeNS(null,"patternUnits","userSpaceOnUse"),d.setAttributeNS(null,"width",_t),d.setAttributeNS(null,"height",R),d.setAttributeNS(null,"x",`${N}`),d.setAttributeNS(null,"y",`${O}`);const o=this.svg,m=this.transformMatrix,e=this.current.fillColor,r=this.current.strokeColor,l=this.svgFactory.create(it-N,ot-O);if(this.svg=l,this.transformMatrix=x,q===2){const u=L.Util.makeHexColor(...a);this.current.fillColor=u,this.current.strokeColor=u}return this.executeOpTree(this.convertOpList(f)),this.svg=o,this.transformMatrix=m,this.current.fillColor=e,this.current.strokeColor=r,d.append(l.childNodes[0]),this.defs.append(d),`url(#${y})`}_makeShadingPattern(n){switch(typeof n=="string"&&(n=this.objs.get(n)),n[0]){case"RadialAxial":const a=`shading${h++}`,f=n[3];let x;switch(n[1]){case"axial":const T=n[4],P=n[5];x=this.svgFactory.createElement("svg:linearGradient"),x.setAttributeNS(null,"id",a),x.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),x.setAttributeNS(null,"x1",T[0]),x.setAttributeNS(null,"y1",T[1]),x.setAttributeNS(null,"x2",P[0]),x.setAttributeNS(null,"y2",P[1]);break;case"radial":const D=n[4],J=n[5],V=n[6],k=n[7];x=this.svgFactory.createElement("svg:radialGradient"),x.setAttributeNS(null,"id",a),x.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),x.setAttributeNS(null,"cx",J[0]),x.setAttributeNS(null,"cy",J[1]),x.setAttributeNS(null,"r",k),x.setAttributeNS(null,"fx",D[0]),x.setAttributeNS(null,"fy",D[1]),x.setAttributeNS(null,"fr",V);break;default:throw new Error(`Unknown RadialAxial type: ${n[1]}`)}for(const T of f){const P=this.svgFactory.createElement("svg:stop");P.setAttributeNS(null,"offset",T[0]),P.setAttributeNS(null,"stop-color",T[1]),x.append(P)}return this.defs.append(x),`url(#${a})`;case"Mesh":return(0,L.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${n[0]}`)}}setDash(n,a){this.current.dashArray=n,this.current.dashPhase=a}constructPath(n,a){const f=this.current;let x=f.x,T=f.y,P=[],D=0;for(const J of n)switch(J|0){case L.OPS.rectangle:x=a[D++],T=a[D++];const V=a[D++],k=a[D++],q=x+V,y=T+k;P.push("M",s(x),s(T),"L",s(q),s(T),"L",s(q),s(y),"L",s(x),s(y),"Z");break;case L.OPS.moveTo:x=a[D++],T=a[D++],P.push("M",s(x),s(T));break;case L.OPS.lineTo:x=a[D++],T=a[D++],P.push("L",s(x),s(T));break;case L.OPS.curveTo:x=a[D+4],T=a[D+5],P.push("C",s(a[D]),s(a[D+1]),s(a[D+2]),s(a[D+3]),s(x),s(T)),D+=6;break;case L.OPS.curveTo2:P.push("C",s(x),s(T),s(a[D]),s(a[D+1]),s(a[D+2]),s(a[D+3])),x=a[D+2],T=a[D+3],D+=4;break;case L.OPS.curveTo3:x=a[D+2],T=a[D+3],P.push("C",s(a[D]),s(a[D+1]),s(x),s(T),s(x),s(T)),D+=4;break;case L.OPS.closePath:P.push("Z");break}P=P.join(" "),f.path&&n.length>0&&n[0]!==L.OPS.rectangle&&n[0]!==L.OPS.moveTo?P=f.path.getAttributeNS(null,"d")+P:(f.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(f.path)),f.path.setAttributeNS(null,"d",P),f.path.setAttributeNS(null,"fill","none"),f.element=f.path,f.setCurrentPoint(x,T)}endPath(){const n=this.current;if(n.path=null,!this.pendingClip)return;if(!n.element){this.pendingClip=null;return}const a=`clippath${E++}`,f=this.svgFactory.createElement("svg:clipPath");f.setAttributeNS(null,"id",a),f.setAttributeNS(null,"transform",i(this.transformMatrix));const x=n.element.cloneNode(!0);if(this.pendingClip==="evenodd"?x.setAttributeNS(null,"clip-rule","evenodd"):x.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,f.append(x),this.defs.append(f),n.activeClipUrl){n.clipGroup=null;for(const T of this.extraStack)T.clipGroup=null;f.setAttributeNS(null,"clip-path",n.activeClipUrl)}n.activeClipUrl=`url(#${a})`,this.tgrp=null}clip(n){this.pendingClip=n}closePath(){const n=this.current;if(n.path){const a=`${n.path.getAttributeNS(null,"d")}Z`;n.path.setAttributeNS(null,"d",a)}}setLeading(n){this.current.leading=-n}setTextRise(n){this.current.textRise=n}setTextRenderingMode(n){this.current.textRenderingMode=n}setHScale(n){this.current.textHScale=n/100}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(const[a,f]of n)switch(a){case"LW":this.setLineWidth(f);break;case"LC":this.setLineCap(f);break;case"LJ":this.setLineJoin(f);break;case"ML":this.setMiterLimit(f);break;case"D":this.setDash(f[0],f[1]);break;case"RI":this.setRenderingIntent(f);break;case"FL":this.setFlatness(f);break;case"Font":this.setFont(f);break;case"CA":this.setStrokeAlpha(f);break;case"ca":this.setFillAlpha(f);break;default:(0,L.warn)(`Unimplemented graphic state operator ${a}`);break}}fill(){const n=this.current;n.element&&(n.element.setAttributeNS(null,"fill",n.fillColor),n.element.setAttributeNS(null,"fill-opacity",n.fillAlpha),this.endPath())}stroke(){const n=this.current;n.element&&(this._setStrokeAttributes(n.element),n.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(n,a=1){const f=this.current;let x=f.dashArray;a!==1&&x.length>0&&(x=x.map(function(T){return a*T})),n.setAttributeNS(null,"stroke",f.strokeColor),n.setAttributeNS(null,"stroke-opacity",f.strokeAlpha),n.setAttributeNS(null,"stroke-miterlimit",s(f.miterLimit)),n.setAttributeNS(null,"stroke-linecap",f.lineCap),n.setAttributeNS(null,"stroke-linejoin",f.lineJoin),n.setAttributeNS(null,"stroke-width",s(a*f.lineWidth)+"px"),n.setAttributeNS(null,"stroke-dasharray",x.map(s).join(" ")),n.setAttributeNS(null,"stroke-dashoffset",s(a*f.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const n=this.svgFactory.createElement("svg:rect");n.setAttributeNS(null,"x","0"),n.setAttributeNS(null,"y","0"),n.setAttributeNS(null,"width","1px"),n.setAttributeNS(null,"height","1px"),n.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(n)}paintImageXObject(n){const a=n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n);if(!a){(0,L.warn)(`Dependent image with object ID ${n} is not ready yet`);return}this.paintInlineImageXObject(a)}paintInlineImageXObject(n,a){const f=n.width,x=n.height,T=C(n,this.forceDataSchema,!!a),P=this.svgFactory.createElement("svg:rect");P.setAttributeNS(null,"x","0"),P.setAttributeNS(null,"y","0"),P.setAttributeNS(null,"width",s(f)),P.setAttributeNS(null,"height",s(x)),this.current.element=P,this.clip("nonzero");const D=this.svgFactory.createElement("svg:image");D.setAttributeNS(A,"xlink:href",T),D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y",s(-x)),D.setAttributeNS(null,"width",s(f)+"px"),D.setAttributeNS(null,"height",s(x)+"px"),D.setAttributeNS(null,"transform",`scale(${s(1/f)} ${s(-1/x)})`),a?a.append(D):this._ensureTransformGroup().append(D)}paintImageMaskXObject(n){const a=this.current,f=n.width,x=n.height,T=a.fillColor;a.maskId=`mask${p++}`;const P=this.svgFactory.createElement("svg:mask");P.setAttributeNS(null,"id",a.maskId);const D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y","0"),D.setAttributeNS(null,"width",s(f)),D.setAttributeNS(null,"height",s(x)),D.setAttributeNS(null,"fill",T),D.setAttributeNS(null,"mask",`url(#${a.maskId})`),this.defs.append(P),this._ensureTransformGroup().append(D),this.paintInlineImageXObject(n,P)}paintFormXObjectBegin(n,a){if(Array.isArray(n)&&n.length===6&&this.transform(n[0],n[1],n[2],n[3],n[4],n[5]),a){const f=a[2]-a[0],x=a[3]-a[1],T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x",a[0]),T.setAttributeNS(null,"y",a[1]),T.setAttributeNS(null,"width",s(f)),T.setAttributeNS(null,"height",s(x)),this.current.element=T,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(n){const a=this.svgFactory.create(n.width,n.height),f=this.svgFactory.createElement("svg:defs");a.append(f),this.defs=f;const x=this.svgFactory.createElement("svg:g");return x.setAttributeNS(null,"transform",i(n.transform)),a.append(x),this.svg=x,a}_ensureClipGroup(){if(!this.current.clipGroup){const n=this.svgFactory.createElement("svg:g");n.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(n),this.current.clipGroup=n}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",i(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.PDFNodeStream=void 0;var b=Q(1),L=Q(33);const Y=require$$5,H=require$$5,st=require$$5,j=require$$5,A=/^file:\/\/\/[a-zA-Z]:\//;function w(p){const h=j.parse(p);return h.protocol==="file:"||h.host?h:/^[a-z]:[/\\]/i.test(p)?j.parse(`file:///${p}`):(h.host||(h.protocol="file:"),h)}class F{constructor(h){this.source=h,this.url=w(h.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&h.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var h,n;return(n=(h=this._fullRequestReader)==null?void 0:h._loaded)!=null?n:0}getFullReader(){return(0,b.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new i(this):new t(this),this._fullRequestReader}getRangeReader(h,n){if(n<=this._progressiveDataLength)return null;const a=this.isFsUrl?new E(this,h,n):new s(this,h,n);return this._rangeRequestReaders.push(a),a}cancelAllRequests(h){this._fullRequestReader&&this._fullRequestReader.cancel(h);for(const n of this._rangeRequestReaders.slice(0))n.cancel(h)}}_.PDFNodeStream=F;class v{constructor(h){this._url=h.url,this._done=!1,this._storedError=null,this.onProgress=null;const n=h.source;this._contentLength=n.length,this._loaded=0,this._filename=null,this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange,this._readableStream=null,this._readCapability=(0,b.createPromiseCapability)(),this._headersCapability=(0,b.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const h=this._readableStream.read();return h===null?(this._readCapability=(0,b.createPromiseCapability)(),this.read()):(this._loaded+=h.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){if(!this._readableStream){this._error(h);return}this._readableStream.destroy(h)}_error(h){this._storedError=h,this._readCapability.resolve()}_setReadableStream(h){this._readableStream=h,h.on("readable",()=>{this._readCapability.resolve()}),h.on("end",()=>{h.destroy(),this._done=!0,this._readCapability.resolve()}),h.on("error",n=>{this._error(n)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new b.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class C{constructor(h){this._url=h.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,b.createPromiseCapability)();const n=h.source;this._isStreamingSupported=!n.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const h=this._readableStream.read();return h===null?(this._readCapability=(0,b.createPromiseCapability)(),this.read()):(this._loaded+=h.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){if(!this._readableStream){this._error(h);return}this._readableStream.destroy(h)}_error(h){this._storedError=h,this._readCapability.resolve()}_setReadableStream(h){this._readableStream=h,h.on("readable",()=>{this._readCapability.resolve()}),h.on("end",()=>{h.destroy(),this._done=!0,this._readCapability.resolve()}),h.on("error",n=>{this._error(n)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function c(p,h){return{protocol:p.protocol,auth:p.auth,host:p.hostname,port:p.port,path:p.path,method:"GET",headers:h}}class t extends v{constructor(h){super(h);const n=a=>{if(a.statusCode===404){const P=new b.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=P,this._headersCapability.reject(P);return}this._headersCapability.resolve(),this._setReadableStream(a);const f=P=>this._readableStream.headers[P.toLowerCase()],{allowRangeRequests:x,suggestedLength:T}=(0,L.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:h.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=x,this._contentLength=T||this._contentLength,this._filename=(0,L.extractFilenameFromHeader)(f)};this._request=null,this._url.protocol==="http:"?this._request=H.request(c(this._url,h.httpHeaders),n):this._request=st.request(c(this._url,h.httpHeaders),n),this._request.on("error",a=>{this._storedError=a,this._headersCapability.reject(a)}),this._request.end()}}class s extends C{constructor(h,n,a){super(h),this._httpHeaders={};for(const x in h.httpHeaders){const T=h.httpHeaders[x];typeof T>"u"||(this._httpHeaders[x]=T)}this._httpHeaders.Range=`bytes=${n}-${a-1}`;const f=x=>{if(x.statusCode===404){const T=new b.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=T;return}this._setReadableStream(x)};this._request=null,this._url.protocol==="http:"?this._request=H.request(c(this._url,this._httpHeaders),f):this._request=st.request(c(this._url,this._httpHeaders),f),this._request.on("error",x=>{this._storedError=x}),this._request.end()}}class i extends v{constructor(h){super(h);let n=decodeURIComponent(this._url.path);A.test(this._url.href)&&(n=n.replace(/^\//,"")),Y.lstat(n,(a,f)=>{if(a){a.code==="ENOENT"&&(a=new b.MissingPDFException(`Missing PDF "${n}".`)),this._storedError=a,this._headersCapability.reject(a);return}this._contentLength=f.size,this._setReadableStream(Y.createReadStream(n)),this._headersCapability.resolve()})}}class E extends C{constructor(h,n,a){super(h);let f=decodeURIComponent(this._url.path);A.test(this._url.href)&&(f=f.replace(/^\//,"")),this._setReadableStream(Y.createReadStream(f,{start:n,end:a-1}))}}},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.createResponseStatusError=j,_.extractFilenameFromHeader=st,_.validateRangeRequestCapabilities=H,_.validateResponseStatus=A;var b=Q(1),L=Q(34),Y=Q(4);function H({getResponseHeader:w,isHttp:F,rangeChunkSize:v,disableRange:C}){const c={allowRangeRequests:!1,suggestedLength:void 0},t=parseInt(w("Content-Length"),10);return!Number.isInteger(t)||(c.suggestedLength=t,t<=2*v)||C||!F||w("Accept-Ranges")!=="bytes"||(w("Content-Encoding")||"identity")!=="identity"||(c.allowRangeRequests=!0),c}function st(w){const F=w("Content-Disposition");if(F){let v=(0,L.getFilenameFromContentDispositionHeader)(F);if(v.includes("%"))try{v=decodeURIComponent(v)}catch{}if((0,Y.isPdfFile)(v))return v}return null}function j(w,F){return w===404||w===0&&F.startsWith("file:")?new b.MissingPDFException('Missing PDF "'+F+'".'):new b.UnexpectedResponseException(`Unexpected server response (${w}) while retrieving PDF "${F}".`,w)}function A(w){return w===200||w===206}},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.getFilenameFromContentDispositionHeader=L;var b=Q(1);function L(Y){let H=!0,st=j("filename\\*","i").exec(Y);if(st){st=st[1];let t=v(st);return t=unescape(t),t=C(t),t=c(t),w(t)}if(st=F(Y),st){const t=c(st);return w(t)}if(st=j("filename","i").exec(Y),st){st=st[1];let t=v(st);return t=c(t),w(t)}function j(t,s){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',s)}function A(t,s){if(t){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const i=new TextDecoder(t,{fatal:!0}),E=(0,b.stringToBytes)(s);s=i.decode(E),H=!1}catch{}}return s}function w(t){return H&&/[\x80-\xff]/.test(t)&&(t=A("utf-8",t),H&&(t=A("iso-8859-1",t))),t}function F(t){const s=[];let i;const E=j("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(i=E.exec(t))!==null;){let[,h,n,a]=i;if(h=parseInt(h,10),h in s){if(h===0)break;continue}s[h]=[n,a]}const p=[];for(let h=0;h<s.length&&h in s;++h){let[n,a]=s[h];a=v(a),n&&(a=unescape(a),h===0&&(a=C(a))),p.push(a)}return p.join("")}function v(t){if(t.startsWith('"')){const s=t.slice(1).split('\\"');for(let i=0;i<s.length;++i){const E=s[i].indexOf('"');E!==-1&&(s[i]=s[i].slice(0,E),s.length=i+1),s[i]=s[i].replace(/\\(.)/g,"$1")}t=s.join('"')}return t}function C(t){const s=t.indexOf("'");if(s===-1)return t;const i=t.slice(0,s),p=t.slice(s+1).replace(/^[^']*'/,"");return A(i,p)}function c(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(s,i,E,p){if(E==="q"||E==="Q")return p=p.replace(/_/g," "),p=p.replace(/=([0-9a-fA-F]{2})/g,function(h,n){return String.fromCharCode(parseInt(n,16))}),A(i,p);try{p=atob(p)}catch{}return A(i,p)})}return""}},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.PDFNetworkStream=void 0;var b=Q(1),L=Q(33);const Y=200,H=206;function st(v){const C=v.response;return typeof C!="string"?C:(0,b.stringToBytes)(C).buffer}class j{constructor(C,c={}){this.url=C,this.isHttp=/^https?:/i.test(C),this.httpHeaders=this.isHttp&&c.httpHeaders||Object.create(null),this.withCredentials=c.withCredentials||!1,this.getXhr=c.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(C,c,t){const s={begin:C,end:c};for(const i in t)s[i]=t[i];return this.request(s)}requestFull(C){return this.request(C)}request(C){const c=this.getXhr(),t=this.currXhrId++,s=this.pendingRequests[t]={xhr:c};c.open("GET",this.url),c.withCredentials=this.withCredentials;for(const i in this.httpHeaders){const E=this.httpHeaders[i];typeof E>"u"||c.setRequestHeader(i,E)}return this.isHttp&&"begin"in C&&"end"in C?(c.setRequestHeader("Range",`bytes=${C.begin}-${C.end-1}`),s.expectedStatus=H):s.expectedStatus=Y,c.responseType="arraybuffer",C.onError&&(c.onerror=function(i){C.onError(c.status)}),c.onreadystatechange=this.onStateChange.bind(this,t),c.onprogress=this.onProgress.bind(this,t),s.onHeadersReceived=C.onHeadersReceived,s.onDone=C.onDone,s.onError=C.onError,s.onProgress=C.onProgress,c.send(null),t}onProgress(C,c){var s;const t=this.pendingRequests[C];!t||(s=t.onProgress)==null||s.call(t,c)}onStateChange(C,c){var h,n,a;const t=this.pendingRequests[C];if(!t)return;const s=t.xhr;if(s.readyState>=2&&t.onHeadersReceived&&(t.onHeadersReceived(),delete t.onHeadersReceived),s.readyState!==4||!(C in this.pendingRequests))return;if(delete this.pendingRequests[C],s.status===0&&this.isHttp){(h=t.onError)==null||h.call(t,s.status);return}const i=s.status||Y;if(!(i===Y&&t.expectedStatus===H)&&i!==t.expectedStatus){(n=t.onError)==null||n.call(t,s.status);return}const p=st(s);if(i===H){const f=s.getResponseHeader("Content-Range"),x=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);t.onDone({begin:parseInt(x[1],10),chunk:p})}else p?t.onDone({begin:0,chunk:p}):(a=t.onError)==null||a.call(t,s.status)}getRequestXhr(C){return this.pendingRequests[C].xhr}isPendingRequest(C){return C in this.pendingRequests}abortRequest(C){const c=this.pendingRequests[C].xhr;delete this.pendingRequests[C],c.abort()}}class A{constructor(C){this._source=C,this._manager=new j(C.url,{httpHeaders:C.httpHeaders,withCredentials:C.withCredentials}),this._rangeChunkSize=C.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(C){const c=this._rangeRequestReaders.indexOf(C);c>=0&&this._rangeRequestReaders.splice(c,1)}getFullReader(){return(0,b.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new w(this._manager,this._source),this._fullRequestReader}getRangeReader(C,c){const t=new F(this._manager,C,c);return t.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(t),t}cancelAllRequests(C){var c;(c=this._fullRequestReader)==null||c.cancel(C);for(const t of this._rangeRequestReaders.slice(0))t.cancel(C)}}_.PDFNetworkStream=A;class w{constructor(C,c){this._manager=C;const t={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=c.url,this._fullRequestId=C.requestFull(t),this._headersReceivedCapability=(0,b.createPromiseCapability)(),this._disableRange=c.disableRange||!1,this._contentLength=c.length,this._rangeChunkSize=c.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const C=this._fullRequestId,c=this._manager.getRequestXhr(C),t=E=>c.getResponseHeader(E),{allowRangeRequests:s,suggestedLength:i}=(0,L.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=i||this._contentLength,this._filename=(0,L.extractFilenameFromHeader)(t),this._isRangeSupported&&this._manager.abortRequest(C),this._headersReceivedCapability.resolve()}_onDone(C){if(C&&(this._requests.length>0?this._requests.shift().resolve({value:C.chunk,done:!1}):this._cachedChunks.push(C.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(C){this._storedError=(0,L.createResponseStatusError)(C,this._url),this._headersReceivedCapability.reject(this._storedError);for(const c of this._requests)c.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(C){var c;(c=this.onProgress)==null||c.call(this,{loaded:C.loaded,total:C.lengthComputable?C.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const C=(0,b.createPromiseCapability)();return this._requests.push(C),C.promise}cancel(C){this._done=!0,this._headersReceivedCapability.reject(C);for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class F{constructor(C,c,t){this._manager=C;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=C.url,this._requestId=C.requestRange(c,t,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var C;(C=this.onClosed)==null||C.call(this,this)}_onDone(C){const c=C.chunk;this._requests.length>0?this._requests.shift().resolve({value:c,done:!1}):this._queuedChunk=c,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(C){this._storedError=(0,L.createResponseStatusError)(C,this._url);for(const c of this._requests)c.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(C){var c;this.isStreamingSupported||(c=this.onProgress)==null||c.call(this,{loaded:C.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const c=this._queuedChunk;return this._queuedChunk=null,{value:c,done:!1}}if(this._done)return{value:void 0,done:!0};const C=(0,b.createPromiseCapability)();return this._requests.push(C),C.promise}cancel(C){this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(at,_,Q)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.PDFFetchStream=void 0;var b=Q(1),L=Q(33);function Y(w,F,v){return{method:"GET",headers:w,signal:v==null?void 0:v.signal,mode:"cors",credentials:F?"include":"same-origin",redirect:"follow"}}function H(w){const F=new Headers;for(const v in w){const C=w[v];typeof C>"u"||F.append(v,C)}return F}class st{constructor(F){this.source=F,this.isHttp=/^https?:/i.test(F.url),this.httpHeaders=this.isHttp&&F.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var F,v;return(v=(F=this._fullRequestReader)==null?void 0:F._loaded)!=null?v:0}getFullReader(){return(0,b.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new j(this),this._fullRequestReader}getRangeReader(F,v){if(v<=this._progressiveDataLength)return null;const C=new A(this,F,v);return this._rangeRequestReaders.push(C),C}cancelAllRequests(F){this._fullRequestReader&&this._fullRequestReader.cancel(F);for(const v of this._rangeRequestReaders.slice(0))v.cancel(F)}}_.PDFFetchStream=st;class j{constructor(F){this._stream=F,this._reader=null,this._loaded=0,this._filename=null;const v=F.source;this._withCredentials=v.withCredentials||!1,this._contentLength=v.length,this._headersCapability=(0,b.createPromiseCapability)(),this._disableRange=v.disableRange||!1,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),typeof AbortController<"u"&&(this._abortController=new AbortController),this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._headers=H(this._stream.httpHeaders);const C=v.url;fetch(C,Y(this._headers,this._withCredentials,this._abortController)).then(c=>{if(!(0,L.validateResponseStatus)(c.status))throw(0,L.createResponseStatusError)(c.status,C);this._reader=c.body.getReader(),this._headersCapability.resolve();const t=E=>c.headers.get(E),{allowRangeRequests:s,suggestedLength:i}=(0,L.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=i||this._contentLength,this._filename=(0,L.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new b.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:F,done:v}=await this._reader.read();return v?{value:F,done:v}:(this._loaded+=F.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){this._reader&&this._reader.cancel(F),this._abortController&&this._abortController.abort()}}class A{constructor(F,v,C){this._stream=F,this._reader=null,this._loaded=0;const c=F.source;this._withCredentials=c.withCredentials||!1,this._readCapability=(0,b.createPromiseCapability)(),this._isStreamingSupported=!c.disableStream,typeof AbortController<"u"&&(this._abortController=new AbortController),this._headers=H(this._stream.httpHeaders),this._headers.append("Range",`bytes=${v}-${C-1}`);const t=c.url;fetch(t,Y(this._headers,this._withCredentials,this._abortController)).then(s=>{if(!(0,L.validateResponseStatus)(s.status))throw(0,L.createResponseStatusError)(s.status,t);this._readCapability.resolve(),this._reader=s.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:F,done:v}=await this._reader.read();return v?{value:F,done:v}:(this._loaded+=F.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){this._reader&&this._reader.cancel(F),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(at){var _=__webpack_module_cache__[at];if(_!==void 0)return _.exports;var Q=__webpack_module_cache__[at]={exports:{}};return __webpack_modules__[at](Q,Q.exports,__w_pdfjs_require__),Q.exports}var __webpack_exports__={};return(()=>{var at=__webpack_exports__;Object.defineProperty(at,"__esModule",{value:!0}),Object.defineProperty(at,"AnnotationEditorLayer",{enumerable:!0,get:function(){return L.AnnotationEditorLayer}}),Object.defineProperty(at,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return _.AnnotationEditorParamsType}}),Object.defineProperty(at,"AnnotationEditorType",{enumerable:!0,get:function(){return _.AnnotationEditorType}}),Object.defineProperty(at,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return Y.AnnotationEditorUIManager}}),Object.defineProperty(at,"AnnotationLayer",{enumerable:!0,get:function(){return H.AnnotationLayer}}),Object.defineProperty(at,"AnnotationMode",{enumerable:!0,get:function(){return _.AnnotationMode}}),Object.defineProperty(at,"CMapCompressionType",{enumerable:!0,get:function(){return _.CMapCompressionType}}),Object.defineProperty(at,"GlobalWorkerOptions",{enumerable:!0,get:function(){return st.GlobalWorkerOptions}}),Object.defineProperty(at,"InvalidPDFException",{enumerable:!0,get:function(){return _.InvalidPDFException}}),Object.defineProperty(at,"LoopbackPort",{enumerable:!0,get:function(){return b.LoopbackPort}}),Object.defineProperty(at,"MissingPDFException",{enumerable:!0,get:function(){return _.MissingPDFException}}),Object.defineProperty(at,"OPS",{enumerable:!0,get:function(){return _.OPS}}),Object.defineProperty(at,"PDFDataRangeTransport",{enumerable:!0,get:function(){return b.PDFDataRangeTransport}}),Object.defineProperty(at,"PDFDateString",{enumerable:!0,get:function(){return Q.PDFDateString}}),Object.defineProperty(at,"PDFWorker",{enumerable:!0,get:function(){return b.PDFWorker}}),Object.defineProperty(at,"PasswordResponses",{enumerable:!0,get:function(){return _.PasswordResponses}}),Object.defineProperty(at,"PermissionFlag",{enumerable:!0,get:function(){return _.PermissionFlag}}),Object.defineProperty(at,"PixelsPerInch",{enumerable:!0,get:function(){return Q.PixelsPerInch}}),Object.defineProperty(at,"RenderingCancelledException",{enumerable:!0,get:function(){return Q.RenderingCancelledException}}),Object.defineProperty(at,"SVGGraphics",{enumerable:!0,get:function(){return w.SVGGraphics}}),Object.defineProperty(at,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return _.UNSUPPORTED_FEATURES}}),Object.defineProperty(at,"UnexpectedResponseException",{enumerable:!0,get:function(){return _.UnexpectedResponseException}}),Object.defineProperty(at,"Util",{enumerable:!0,get:function(){return _.Util}}),Object.defineProperty(at,"VerbosityLevel",{enumerable:!0,get:function(){return _.VerbosityLevel}}),Object.defineProperty(at,"XfaLayer",{enumerable:!0,get:function(){return F.XfaLayer}}),Object.defineProperty(at,"binarySearchFirstItem",{enumerable:!0,get:function(){return Q.binarySearchFirstItem}}),Object.defineProperty(at,"build",{enumerable:!0,get:function(){return b.build}}),Object.defineProperty(at,"createPromiseCapability",{enumerable:!0,get:function(){return _.createPromiseCapability}}),Object.defineProperty(at,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return _.createValidAbsoluteUrl}}),Object.defineProperty(at,"getDocument",{enumerable:!0,get:function(){return b.getDocument}}),Object.defineProperty(at,"getFilenameFromUrl",{enumerable:!0,get:function(){return Q.getFilenameFromUrl}}),Object.defineProperty(at,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return Q.getPdfFilenameFromUrl}}),Object.defineProperty(at,"getXfaPageViewport",{enumerable:!0,get:function(){return Q.getXfaPageViewport}}),Object.defineProperty(at,"isPdfFile",{enumerable:!0,get:function(){return Q.isPdfFile}}),Object.defineProperty(at,"loadScript",{enumerable:!0,get:function(){return Q.loadScript}}),Object.defineProperty(at,"renderTextLayer",{enumerable:!0,get:function(){return A.renderTextLayer}}),Object.defineProperty(at,"shadow",{enumerable:!0,get:function(){return _.shadow}}),Object.defineProperty(at,"version",{enumerable:!0,get:function(){return b.version}});var _=__w_pdfjs_require__(1),Q=__w_pdfjs_require__(4),b=__w_pdfjs_require__(6),L=__w_pdfjs_require__(22),Y=__w_pdfjs_require__(9),H=__w_pdfjs_require__(27),st=__w_pdfjs_require__(15),j=__w_pdfjs_require__(3),A=__w_pdfjs_require__(30),w=__w_pdfjs_require__(31),F=__w_pdfjs_require__(29);if(j.isNodeJS){const{PDFNodeStream:v}=__w_pdfjs_require__(32);(0,b.setPDFNetworkStreamFactory)(C=>new v(C))}else{const{PDFNetworkStream:v}=__w_pdfjs_require__(35),{PDFFetchStream:C}=__w_pdfjs_require__(36);(0,b.setPDFNetworkStreamFactory)(c=>(0,Q.isValidFetchUrl)(c.url)?new C(c):new v(c))}})(),__webpack_exports__})())})(pdf);pdfjsLib.GlobalWorkerOptions.workerSrc="@pdfjs/pdf.worker.js";const getSubmission=()=>html`
    <div>
      <style>
        ${submissionStyle}
      </style>
      <div class="submission-btns">
        <button type="button" class="btn" id="btnOpen">
          ${constantsMap.open}
        </button>
        <button type="button" class="btn" id="btnDownload">
          ${constantsMap.download}
        </button>
      </div>
      <div class="mt-5">
        <div id="pdfViewerContainer">
          <div id="zoomControls" class="d-flex justify-content-center">
            <div class="icon icon-zoom-in"></div>
            <div class="icon icon-zoom-out"></div>
          </div>
          <div id="canvasContainer">
            <canvas class="pdf-viewer" id="pdfViewer"></canvas>
          </div>
        </div>
      </div>
    </div>
  `;function handleDownload(){let at=getState().identificationData.selectedRequirement.concat("-",getState().identificationData.idNumber,"-",new Date().getTime());pdfDownload(getState().submissionContent,at)}function handleOpen(){pdfOpen(getState().submissionContent)}const pdfData={pdf:void 0,scale:1},submission=()=>{getElement("#app").appendChild(createNode(getSubmission())),pdfUrlData(getState().submissionContent,async at=>{pdfData.pdf=await pdfjsLib.getDocument(at).promise,renderPDF()}),getElement("#btnOpen").onclick=handleOpen,getElement("#btnDownload").onclick=handleDownload};async function renderPDF(){const at=await pdfData.pdf.getPage(1),_=getElement("#pdfViewer"),Q=_.getContext("2d"),b=at.getViewport({scale:pdfData.scale});_.height=b.height,_.width=b.width;const L={canvasContext:Q,viewport:b};at.render(L)}export{submission as default};
